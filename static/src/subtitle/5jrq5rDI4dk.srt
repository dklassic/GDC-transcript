1
00:00:05,309 --> 00:00:10,194
Welcome to the talk, Plot and Parcel, Procedural Level Design in XCOM 2.

2
00:00:11,575 --> 00:00:13,377
Here's some stuff you haven't heard this week.

3
00:00:14,257 --> 00:00:15,759
Please silence your cell phones.

4
00:00:17,420 --> 00:00:21,885
Also, if you would be so kind as to fill out your review forms, I would appreciate it.

5
00:00:25,968 --> 00:00:27,149
My name is Brian Hess.

6
00:00:27,910 --> 00:00:29,812
I've been a level designer for over 20 years.

7
00:00:31,195 --> 00:00:34,237
I got a start making mods for first-person shooter games

8
00:00:34,297 --> 00:00:36,318
in the late 90s like Doom and Quake.

9
00:00:37,219 --> 00:00:40,301
I've worked on multiple genres, first-person shooters,

10
00:00:40,501 --> 00:00:44,063
adventure games, MMOs, and tactical strategy games.

11
00:00:45,504 --> 00:00:48,085
My most recent work is as the lead level designer

12
00:00:48,266 --> 00:00:50,967
on XCOM 2 and its expansion War of the Chosen.

13
00:00:51,908 --> 00:00:54,529
I design the procedural level system for these titles.

14
00:00:57,391 --> 00:00:59,672
Here's a brief outline for what we'll be discussing

15
00:00:59,712 --> 00:01:00,373
in today's talk.

16
00:01:01,503 --> 00:01:04,144
First, we will go through the history of XCOM

17
00:01:04,245 --> 00:01:05,405
and XCOM level design.

18
00:01:06,286 --> 00:01:08,027
Then we'll walk through the development

19
00:01:08,127 --> 00:01:10,688
of the procedural level design system in XCOM 2.

20
00:01:11,729 --> 00:01:13,790
I'd like to then briefly touch on some of the tools

21
00:01:13,850 --> 00:01:15,271
we used to help us in development,

22
00:01:15,972 --> 00:01:18,053
then speak about some of the challenges we faced

23
00:01:18,333 --> 00:01:19,614
with the system during production.

24
00:01:21,255 --> 00:01:24,417
After evaluating that, we will discuss extending the system

25
00:01:24,577 --> 00:01:25,918
in the War of the Chosen expansion,

26
00:01:26,578 --> 00:01:29,280
and finally, we will step back and draw some conclusions

27
00:01:29,440 --> 00:01:30,260
about what we've learned.

28
00:01:33,299 --> 00:01:35,220
XCOM is a tactical strategy game.

29
00:01:36,020 --> 00:01:38,682
That is, the game has a tactical combat component

30
00:01:38,962 --> 00:01:40,303
and a global strategy component.

31
00:01:41,103 --> 00:01:43,504
In playing the game, you alternate between these two modes.

32
00:01:45,045 --> 00:01:47,707
The XCOM franchise started in 1993

33
00:01:47,907 --> 00:01:51,169
with XCOM UFO Defense, which was released by Microprose,

34
00:01:51,829 --> 00:01:53,050
Paraxis's predecessor.

35
00:01:54,211 --> 00:01:56,232
This is one of my favorite games in high school,

36
00:01:56,532 --> 00:01:58,793
and I have to admit, I was pretty bad at it

37
00:01:58,993 --> 00:02:01,355
until I downloaded the unlimited money cheat

38
00:02:01,415 --> 00:02:02,215
from CompuServe.

39
00:02:04,437 --> 00:02:06,138
I would never have imagined being able to work

40
00:02:06,178 --> 00:02:09,138
in a game like this at that time while I was playing it.

41
00:02:09,518 --> 00:02:12,199
So when the opportunity to do so arose for me in 2012,

42
00:02:12,979 --> 00:02:13,499
I jumped on it.

43
00:02:15,200 --> 00:02:17,960
Firaxis's first XCOM game was Enemy Unknown,

44
00:02:18,201 --> 00:02:21,321
released in 2012, and its expansion Enemy Within in 2013.

45
00:02:21,961 --> 00:02:24,662
It was followed by XCOM 2 in 2016

46
00:02:24,782 --> 00:02:25,702
and War of the Chosen in 2017.

47
00:02:28,875 --> 00:02:31,357
This talk is about the Firaxis XCOM titles,

48
00:02:31,857 --> 00:02:34,518
more specifically the tactical combat part of the game.

49
00:02:35,579 --> 00:02:38,800
At its core, XCOM is a game about hiding behind stuff

50
00:02:39,020 --> 00:02:39,881
and shooting aliens.

51
00:02:42,762 --> 00:02:45,003
Here is a brief crash course on the components

52
00:02:45,144 --> 00:02:45,964
of an XCOM level.

53
00:02:46,824 --> 00:02:48,865
Three fundamental components are the grid,

54
00:02:49,426 --> 00:02:50,786
cover, and fog of war.

55
00:02:52,067 --> 00:02:54,308
Levels are created on a grid of square tiles.

56
00:02:55,260 --> 00:02:58,181
Objects in the world either occupy or straddle these tiles,

57
00:02:58,641 --> 00:03:01,242
provide things to hide behind, and affect line of sight.

58
00:03:02,503 --> 00:03:04,263
Standing next to these objects causes you

59
00:03:04,303 --> 00:03:06,744
to take cover behind them, providing a defensive bonus.

60
00:03:08,265 --> 00:03:09,585
There are two types of cover,

61
00:03:10,005 --> 00:03:11,246
based on the height of the object.

62
00:03:12,006 --> 00:03:14,947
Low cover, the half shield, which grants a small bonus,

63
00:03:15,167 --> 00:03:17,968
and high cover, the full shield, which grants a large bonus.

64
00:03:19,228 --> 00:03:21,049
Player-controlled units can only see

65
00:03:21,449 --> 00:03:23,270
a certain number of tiles in each direction.

66
00:03:24,070 --> 00:03:26,212
High cover objects also block line of sight.

67
00:03:27,392 --> 00:03:28,853
Players are only aware of enemies

68
00:03:28,913 --> 00:03:30,354
that their units have line of sight to,

69
00:03:30,854 --> 00:03:33,016
and the map is revealed as players navigate

70
00:03:33,076 --> 00:03:35,137
through the level, exposing groups of enemies.

71
00:03:37,819 --> 00:03:39,360
So what makes a good XCOM level?

72
00:03:40,820 --> 00:03:43,082
Map layouts have a considerable amount of control

73
00:03:43,202 --> 00:03:45,483
over the challenge level that a tactical mission provides.

74
00:03:46,344 --> 00:03:48,505
The same mission with the same number of enemies

75
00:03:48,685 --> 00:03:50,666
played on two differently arranged bases

76
00:03:50,806 --> 00:03:51,967
can range from a cakewalk

77
00:03:52,657 --> 00:03:54,398
to a rage-inducing fiasco.

78
00:03:56,179 --> 00:03:58,300
The three primary factors that we need to consider

79
00:03:58,500 --> 00:04:01,341
are object spacing, cover density, and line of sight.

80
00:04:02,302 --> 00:04:03,903
If cover objects are too sparse,

81
00:04:04,183 --> 00:04:06,044
then it is impossible to engage enemies

82
00:04:06,104 --> 00:04:07,765
with your entire squad while in cover,

83
00:04:08,245 --> 00:04:09,766
and this creates a difficulty spike.

84
00:04:10,767 --> 00:04:12,267
If cover objects are too dense,

85
00:04:12,588 --> 00:04:14,369
then map readability becomes an issue.

86
00:04:15,089 --> 00:04:17,350
This increases play time and is frustrating.

87
00:04:18,833 --> 00:04:21,134
In addition, we observe a one-wide rule

88
00:04:21,214 --> 00:04:22,715
when constructing XCOM levels.

89
00:04:23,696 --> 00:04:25,897
That is, there must be two empty tiles

90
00:04:26,057 --> 00:04:27,598
between each cluster of objects.

91
00:04:28,679 --> 00:04:31,841
This guarantees that cover, even at maximum density,

92
00:04:32,101 --> 00:04:33,802
still allows for freedom of movement

93
00:04:33,942 --> 00:04:35,683
and minimizes camera blocking issues.

94
00:04:37,104 --> 00:04:39,565
A good XCOM level has a sea of low cover

95
00:04:39,665 --> 00:04:41,026
and a smattering of high cover.

96
00:04:41,987 --> 00:04:44,728
A successful XCOM player will maintain high cover

97
00:04:44,808 --> 00:04:46,609
with all of their units towards the enemies

98
00:04:46,669 --> 00:04:47,330
they are engaging.

99
00:04:49,050 --> 00:04:50,970
High cover also blocks line of sight.

100
00:04:51,971 --> 00:04:54,311
Too much line of sight restriction has negative effects.

101
00:04:55,212 --> 00:04:57,252
Players will often travel past encounters

102
00:04:57,312 --> 00:04:58,553
they were intended to engage.

103
00:04:59,673 --> 00:05:02,914
This results in engaging multiple encounters at once,

104
00:05:03,574 --> 00:05:04,615
another difficulty spike.

105
00:05:05,895 --> 00:05:08,116
The occasional multi-encounter engagement

106
00:05:08,176 --> 00:05:10,697
can prove to be a challenging and memorable experience,

107
00:05:11,157 --> 00:05:13,097
but we'd rather have this happen intentionally

108
00:05:13,477 --> 00:05:15,138
than have them occur accidentally

109
00:05:15,238 --> 00:05:16,618
as a result of bad level design.

110
00:05:19,640 --> 00:05:23,582
Now that we know what makes a good map, let's take a look at the maps that shipped with

111
00:05:23,702 --> 00:05:24,803
XCOM Enemy Unknown.

112
00:05:26,063 --> 00:05:30,486
Enemy Unknown shipped with around 80 unique maps and the Enemy Within expansion added

113
00:05:30,506 --> 00:05:31,446
around 30 more.

114
00:05:32,887 --> 00:05:38,050
Most of these maps were divided into two categories, urban maps where abduction missions took place

115
00:05:38,330 --> 00:05:40,931
and wilderness maps where UFO missions took place.

116
00:05:42,320 --> 00:05:45,560
Vast amounts of custom art was created for each level.

117
00:05:46,480 --> 00:05:49,281
Custom sidewalks and roads were sized to fit.

118
00:05:50,281 --> 00:05:52,401
Maps had unique signage and cover props.

119
00:05:53,222 --> 00:05:54,942
One of the most expensive aspects

120
00:05:55,082 --> 00:05:56,782
was that each building was custom built.

121
00:05:57,642 --> 00:06:00,263
Buildings were easily the most resource-intensive part

122
00:06:00,343 --> 00:06:01,123
of tactical maps.

123
00:06:04,284 --> 00:06:06,104
Internally, we were pleased with the look

124
00:06:06,144 --> 00:06:07,044
and feel of these maps.

125
00:06:07,564 --> 00:06:10,405
However, they took quite a long time to put together.

126
00:06:11,572 --> 00:06:15,215
The average EU abduction map took a number of man months to complete.

127
00:06:16,356 --> 00:06:20,561
In a single campaign playthrough, you could play so many tactical missions that you would

128
00:06:20,601 --> 00:06:22,363
start seeing the same maps over again.

129
00:06:23,183 --> 00:06:26,747
On your second playthrough, everything started seeming very familiar.

130
00:06:27,768 --> 00:06:32,233
In a game with a lot of replayability, repeat maps were one of the top reasons people burned

131
00:06:32,313 --> 00:06:32,853
out on the game.

132
00:06:34,572 --> 00:06:36,774
The DLCs raised the art bar on the maps.

133
00:06:37,494 --> 00:06:43,078
If we sold 80 maps for 60 bucks and we're charging 7 bucks for 3 maps, these better

134
00:06:43,098 --> 00:06:44,179
be pretty fancy maps.

135
00:06:45,080 --> 00:06:47,921
And our expansion maps can't look worse than our DLC ones.

136
00:06:48,862 --> 00:06:49,623
It was an arms race.

137
00:06:50,303 --> 00:06:52,525
This just put us further in the hole time-wise.

138
00:06:53,525 --> 00:06:56,728
The image on this slide is one of our DLC maps called Deluge.

139
00:06:57,548 --> 00:06:58,749
It was beautiful and iconic.

140
00:06:59,241 --> 00:07:05,326
But aside the vehicles, it was almost entirely custom one-off art and it took a considerable amount of time to create.

141
00:07:08,769 --> 00:07:12,772
One of the positive advancements of the expansion came as a result of an experiment.

142
00:07:13,813 --> 00:07:19,278
In an attempt to extend content cheaply and enemy within, we took some of the base game maps,

143
00:07:19,818 --> 00:07:23,021
moved the player star to the other side, and altered the time of day.

144
00:07:24,579 --> 00:07:26,600
Enemy unknown levels were mostly large enough

145
00:07:26,680 --> 00:07:28,621
that the player never made it to the other corner

146
00:07:28,641 --> 00:07:30,042
of the map before the mission ended.

147
00:07:30,902 --> 00:07:33,284
You start in this space you've never been in before

148
00:07:33,404 --> 00:07:35,505
and eventually you get to places you recognize,

149
00:07:35,925 --> 00:07:37,146
but from the opposite direction.

150
00:07:38,026 --> 00:07:41,628
They played like totally new levels.

151
00:07:42,149 --> 00:07:44,850
Recognizing these spaces again in a different way

152
00:07:45,010 --> 00:07:46,471
often added to the experience,

153
00:07:46,771 --> 00:07:48,752
not taking away from it as we had feared.

154
00:07:49,905 --> 00:07:53,706
Both of these concepts, that is, randomized player starts

155
00:07:53,886 --> 00:07:55,887
and multiple times a day for each map,

156
00:07:56,327 --> 00:07:58,527
were added to the pool of ideas for the sequel

157
00:07:58,747 --> 00:08:00,167
as ways to increase variety.

158
00:08:03,568 --> 00:08:05,569
Now that we've gone over the history of XCOM

159
00:08:05,629 --> 00:08:08,089
previous to the introduction of procedural level design,

160
00:08:08,489 --> 00:08:10,650
I'd like to shift over to its incorporation

161
00:08:10,770 --> 00:08:12,550
into the XCOM tactical game,

162
00:08:13,150 --> 00:08:15,231
starting with pre-production on XCOM 2 in 2013.

163
00:08:17,574 --> 00:08:19,615
We established some goals for what we wanted out

164
00:08:19,635 --> 00:08:22,056
of the procedural system before we started developing it

165
00:08:22,197 --> 00:08:22,937
in pre-production.

166
00:08:23,998 --> 00:08:26,899
The first goal was to remove expensive environment art

167
00:08:27,039 --> 00:08:29,200
as a bottleneck from getting more maps in the game.

168
00:08:29,861 --> 00:08:31,662
We're not staffing up to make the sequel,

169
00:08:32,022 --> 00:08:34,423
but we need to ship more maps to the game this time around.

170
00:08:35,844 --> 00:08:37,825
Another goal was the pursuit of a concept

171
00:08:37,865 --> 00:08:38,946
we called Play Forever,

172
00:08:38,966 --> 00:08:41,907
which is that you'd never see the same map twice

173
00:08:41,947 --> 00:08:42,467
while playing.

174
00:08:43,308 --> 00:08:44,869
We'd like to remove map fatigue

175
00:08:45,029 --> 00:08:46,410
as a source of player burnout.

176
00:08:47,685 --> 00:08:50,888
Finally, we wanted to switch to using modular building kits,

177
00:08:51,148 --> 00:08:54,190
which allow the assembly of structures using a generic library.

178
00:08:55,031 --> 00:08:59,834
This is an old concept that has been discussed in detail in a number of excellent GDC talks.

179
00:09:01,155 --> 00:09:05,018
This wasn't directly related to the procedural system, but we knew that we were going

180
00:09:05,038 --> 00:09:08,020
to need a lot more buildings, and since they were so expensive,

181
00:09:08,220 --> 00:09:10,361
we had to find some way to speed up that process.

182
00:09:13,757 --> 00:09:15,478
This was the original idea of how

183
00:09:15,518 --> 00:09:18,400
to do procedural maps before we actually started working on it.

184
00:09:19,621 --> 00:09:21,983
We would start with a large map and cut holes

185
00:09:22,043 --> 00:09:22,844
where the buildings were.

186
00:09:23,524 --> 00:09:25,225
We would create the multiple buildings

187
00:09:25,385 --> 00:09:27,307
in separate map files and stream them

188
00:09:27,367 --> 00:09:28,968
in where the holes in the other map were.

189
00:09:29,869 --> 00:09:32,530
We called the master map with the holes in it a plot

190
00:09:33,051 --> 00:09:35,112
and the streamed in building maps as parcels.

191
00:09:36,733 --> 00:09:37,914
In the image on the screen,

192
00:09:38,134 --> 00:09:40,956
the blue and gray checkerboard boxes each represent

193
00:09:41,076 --> 00:09:42,057
individual parcels.

194
00:09:43,296 --> 00:09:45,497
You're going to see a few more checkered board boxes

195
00:09:45,537 --> 00:09:46,198
during this talk.

196
00:09:49,580 --> 00:09:52,162
As I mentioned earlier, Enemy Unknown shipped

197
00:09:52,222 --> 00:09:54,904
with two major plot types, urban and wilderness.

198
00:09:55,884 --> 00:09:57,846
We wanted to expand the number of plot types

199
00:09:57,926 --> 00:09:59,367
to five for XCOM 2.

200
00:10:00,448 --> 00:10:02,869
The plot types we wanted to make were city center,

201
00:10:03,510 --> 00:10:07,893
wilderness, small towns, shanty towns, and alien facilities.

202
00:10:08,888 --> 00:10:11,589
The images on the screen are what these plot types ended

203
00:10:11,629 --> 00:10:13,911
up looking like when they shipped with XCOM 2.

204
00:10:15,612 --> 00:10:17,793
The additional plot types were added to help flesh

205
00:10:17,853 --> 00:10:20,855
out the universe and tell the story of the alien occupation

206
00:10:20,875 --> 00:10:23,356
of Earth in the last 20 years since Enemy Unknown.

207
00:10:24,397 --> 00:10:25,918
We were betting that we could get all

208
00:10:25,938 --> 00:10:27,979
of this additional content done much faster

209
00:10:28,019 --> 00:10:31,461
than the previous game due to our shiny new procedural system,

210
00:10:32,142 --> 00:10:34,223
even though we had not yet proven it could work.

211
00:10:37,089 --> 00:10:41,071
Now that we had our expanded list of plot types, we came up with some initial rules

212
00:10:41,131 --> 00:10:42,712
on how these plots would be constructed.

213
00:10:43,853 --> 00:10:47,055
Because there was still a significant art cost in creating a plot,

214
00:10:47,495 --> 00:10:51,297
even with the buildings removed, the goal was to have as few plots as possible.

215
00:10:52,357 --> 00:10:55,539
To support that goal, plots needed to support all missions.

216
00:10:56,279 --> 00:11:00,142
They also needed to be large enough to support the mission that demanded the most amount

217
00:11:00,162 --> 00:11:02,183
of real estate, ballooning their size.

218
00:11:03,557 --> 00:11:05,598
The original plan for enemy reinforcements

219
00:11:05,678 --> 00:11:07,419
was that they would walk in from a road

220
00:11:07,519 --> 00:11:08,239
on the edge of the map.

221
00:11:09,260 --> 00:11:11,681
This required roads exiting the gameplay space

222
00:11:11,841 --> 00:11:12,722
at regular intervals.

223
00:11:13,702 --> 00:11:15,743
We also planned to add large units

224
00:11:16,003 --> 00:11:17,684
which occupied multiple tiles

225
00:11:17,844 --> 00:11:20,066
and needed paths free from cover objects

226
00:11:20,446 --> 00:11:21,847
in order to travel around the map,

227
00:11:22,527 --> 00:11:24,328
which meant no buildings in these spaces.

228
00:11:25,809 --> 00:11:27,570
This means roads around every structure

229
00:11:27,730 --> 00:11:28,910
as well as the edge of the map.

230
00:11:29,831 --> 00:11:31,512
Large unit and reinforcement support

231
00:11:31,552 --> 00:11:32,872
made the maps mostly roads.

232
00:11:33,735 --> 00:11:36,937
Roads were in the plot and required an art pass in every plot.

233
00:11:38,077 --> 00:11:41,138
More roads on a plot meant more art time per plot created.

234
00:11:42,599 --> 00:11:45,560
The image on the screen was one of our first prototype city plots.

235
00:11:46,361 --> 00:11:49,582
Note the preponderance of roads and the significant square footage.

236
00:11:52,763 --> 00:11:56,145
Here are some rules that we came up with for our first round of parcels.

237
00:11:57,165 --> 00:12:00,086
Parcels were divided into three buckets based on size.

238
00:12:00,867 --> 00:12:02,768
All parcels were 12 tiles squared.

239
00:12:03,658 --> 00:12:08,502
Medium parcels were 12 by 24 tiles and large parcels were 24 tiles squared.

240
00:12:09,542 --> 00:12:12,885
On the right are three shipping city center parcels, one of each size.

241
00:12:13,765 --> 00:12:17,648
The idea behind this was that since our plan involved punching holes in the plot

242
00:12:17,688 --> 00:12:23,032
for just buildings, we needed more granularity over the sizes the buildings could occupy

243
00:12:23,113 --> 00:12:24,714
so that we weren't wasting any space.

244
00:12:26,215 --> 00:12:30,978
The buildings that we evaluated from the enemy unknown levels were all slightly different sizes

245
00:12:31,419 --> 00:12:33,240
but could fit within one of the three buckets.

246
00:12:34,280 --> 00:12:37,721
We could ensure the buildings could both occupy almost all

247
00:12:37,761 --> 00:12:40,101
of a given parcel and be consistent sizes

248
00:12:40,181 --> 00:12:42,622
by using our modular building kit, which was base three.

249
00:12:44,063 --> 00:12:45,823
Now we had three separate buckets of buildings

250
00:12:45,863 --> 00:12:47,223
to make sure we had enough of.

251
00:12:48,704 --> 00:12:51,305
Because large parcels had four times the real estate

252
00:12:51,365 --> 00:12:53,285
of a small parcel, it stood to reason

253
00:12:53,325 --> 00:12:55,506
that they would take four times as long to create.

254
00:12:56,586 --> 00:12:58,147
In the interest of replayability,

255
00:12:58,427 --> 00:13:01,928
we wanted to make more smaller parcels and fewer larger ones.

256
00:13:03,338 --> 00:13:07,341
We also wanted a large parcel to have the potential to appear on every plot.

257
00:13:08,422 --> 00:13:12,065
To try and accommodate this, we added the concept of parcel subdivision.

258
00:13:13,005 --> 00:13:19,670
A large parcel slot on a plot could spawn instead as two mediums or as a medium and two smalls.

259
00:13:20,711 --> 00:13:24,273
This way, we could worry less about which building sizes we needed more

260
00:13:24,393 --> 00:13:26,895
of since the building slots were somewhat interchangeable.

261
00:13:28,027 --> 00:13:33,731
To maximize replayability, we also had parcels loading into spaces at a random cardinal orientation.

262
00:13:36,653 --> 00:13:41,196
So we've made our first set of plots and we have to evaluate our work before moving forward.

263
00:13:42,137 --> 00:13:45,199
Dressing up all of the rows on each plot was very time consuming.

264
00:13:46,099 --> 00:13:48,981
Most missions required less space than the plots were built to.

265
00:13:50,028 --> 00:13:52,811
This was bad because players used the edge of the map

266
00:13:52,851 --> 00:13:54,932
to help them figure out which direction to go.

267
00:13:55,693 --> 00:13:57,795
And in a large map, you never see the edge,

268
00:13:58,095 --> 00:13:59,937
putting the onus on the mission UI

269
00:13:59,997 --> 00:14:01,798
to keep players heading in the right direction.

270
00:14:03,179 --> 00:14:04,821
It also made load times longer,

271
00:14:05,381 --> 00:14:07,643
memory footprints higher, and performance worse.

272
00:14:09,224 --> 00:14:10,565
Even with the buildings cut out

273
00:14:10,665 --> 00:14:12,327
and able to be shared between plots,

274
00:14:12,967 --> 00:14:14,729
this still wasn't a huge time savings

275
00:14:14,789 --> 00:14:15,990
in tactical map creation.

276
00:14:16,927 --> 00:14:20,711
Because the parcels were all roughly the same size and shape as the other parcels in that

277
00:14:20,771 --> 00:14:25,496
bucket, combat wasn't much different when one building was substituted in place of another.

278
00:14:26,317 --> 00:14:27,158
We weren't there yet.

279
00:14:30,001 --> 00:14:33,325
We started looking for solutions to some of the plot problems that we were having.

280
00:14:34,105 --> 00:14:38,110
What if we took the parts of the plot that weren't parcels and proceduralized them in

281
00:14:38,130 --> 00:14:38,850
a similar fashion?

282
00:14:39,627 --> 00:14:42,290
We were already building road networks for modular road kits.

283
00:14:42,670 --> 00:14:46,653
What if we saved off a few variations of each piece from the kit as a separate map,

284
00:14:47,254 --> 00:14:50,337
rearranged the cover layout, and sent it through our art pipeline?

285
00:14:51,458 --> 00:14:55,701
Thus, the idea of plot cover parcels, or PCPs, was born.

286
00:14:56,742 --> 00:14:58,844
The rules were slightly different than parcels, though.

287
00:14:59,605 --> 00:15:04,289
Unlike parcels, it was okay to reuse a PCP multiple times in a tactical match.

288
00:15:05,446 --> 00:15:11,327
They were small and generic enough that, unless two identical ones were side by side and facing the same direction,

289
00:15:11,967 --> 00:15:14,188
you couldn't tell that we were recycling content.

290
00:15:15,308 --> 00:15:21,870
Furthermore, by divorcing the art from the map layout, we could create any number of plot layouts without additional art cost.

291
00:15:22,530 --> 00:15:25,670
This was the first major breakthrough of procedural development.

292
00:15:26,991 --> 00:15:30,792
The images on this slide were the results of the first PCP prototype plot.

293
00:15:32,750 --> 00:15:36,473
They were screenshots of the same section of a single plot loaded six times.

294
00:15:37,434 --> 00:15:41,016
We were pretty excited about the variety we could get out of a single plot with all

295
00:15:41,036 --> 00:15:42,398
of these new systems in place.

296
00:15:45,160 --> 00:15:50,784
PCPs resulted in massive time savings for the environment artist as they could make a set

297
00:15:50,885 --> 00:15:54,568
of one to three dozen PCPs to populate in any number of plots.

298
00:15:55,585 --> 00:15:59,507
It also allowed level design the freedom to experiment much more with level layouts

299
00:15:59,988 --> 00:16:03,830
as assembling a plot of parcels and PCPs could be done in about an hour.

300
00:16:05,551 --> 00:16:07,572
Each plot type had its own PCP sets.

301
00:16:08,353 --> 00:16:13,736
For example, the small town street set had 24 pieces, four courts, two corners,

302
00:16:14,156 --> 00:16:18,019
eight straightaways of two different lengths, and 10 intersections of various types

303
00:16:18,079 --> 00:16:20,060
with streets, boulevards, and train tracks.

304
00:16:21,535 --> 00:16:23,436
The picture shows one of our first stabs

305
00:16:23,576 --> 00:16:26,358
at a complete set of PCPs for the wilderness plot type.

306
00:16:27,178 --> 00:16:29,820
There is a set of dirt roads, divided highways,

307
00:16:30,040 --> 00:16:31,101
streams, and woods.

308
00:16:32,341 --> 00:16:35,863
PCP piece variations allowed for variety of gameplay

309
00:16:35,903 --> 00:16:37,424
as well as visual variation,

310
00:16:37,624 --> 00:16:40,646
as the cover layout was different in each variation.

311
00:16:43,488 --> 00:16:45,829
After the initial round of building construction,

312
00:16:45,969 --> 00:16:47,950
we took stock of the buildings we had made

313
00:16:48,050 --> 00:16:49,411
and how they were working in game.

314
00:16:50,547 --> 00:16:53,127
Level designers were struggling to build building interiors

315
00:16:53,167 --> 00:16:55,628
that had enough space to sell a particular theme

316
00:16:56,168 --> 00:16:58,248
while obeying all of our gameplay restrictions

317
00:16:58,428 --> 00:16:59,868
on layout and the space provided.

318
00:17:00,989 --> 00:17:03,149
It wasn't so hard to fill out a large parcel,

319
00:17:03,829 --> 00:17:05,830
but it was sure hard to make a coherent space

320
00:17:05,970 --> 00:17:07,310
out of a small or medium one.

321
00:17:08,510 --> 00:17:10,711
Because we had to leave unoccupied tiles

322
00:17:10,811 --> 00:17:12,551
on the edge of each map in order to observe

323
00:17:12,571 --> 00:17:15,151
the one wide rule, a 12 by 12 parcel

324
00:17:15,191 --> 00:17:17,212
could only support a nine by nine building.

325
00:17:18,292 --> 00:17:18,512
Okay.

326
00:17:19,119 --> 00:17:21,661
So let's retrofit all the parcels to be base 14.

327
00:17:22,342 --> 00:17:25,404
Well, we can fit a 12 by 12 building and a small parcel now,

328
00:17:25,924 --> 00:17:28,406
so the buildings are easier to make coherent spaces out of,

329
00:17:28,987 --> 00:17:30,568
but the gameplay still isn't there.

330
00:17:31,869 --> 00:17:34,631
The picture shows one of our early prototype buildings using

331
00:17:34,671 --> 00:17:37,153
some old XCOM 1 assets and test pieces.

332
00:17:37,994 --> 00:17:39,435
There's nothing to hide behind next

333
00:17:39,455 --> 00:17:41,036
to the building while moving down the street.

334
00:17:42,046 --> 00:17:44,387
Gameplay testing was showing that buildings played better

335
00:17:44,447 --> 00:17:46,247
with cover objects on the outside of them

336
00:17:46,688 --> 00:17:48,348
in order for you to be able to fight down

337
00:17:48,428 --> 00:17:50,269
the more open spaces adjacent to them.

338
00:17:51,289 --> 00:17:52,409
In order to accommodate that,

339
00:17:52,730 --> 00:17:55,791
we would have to shrink a building on a 14 by 14 parcel

340
00:17:55,851 --> 00:17:58,311
back from 12 by 12 to nine by nine

341
00:17:58,371 --> 00:18:00,032
with our base three modular building kit.

342
00:18:01,052 --> 00:18:03,593
Okay, so what if the parcels got bigger again?

343
00:18:04,774 --> 00:18:07,575
So we went up to base 16 and this proved to be big enough.

344
00:18:08,502 --> 00:18:12,604
Buildings could be large enough to convincingly sell a space and there was enough room in

345
00:18:12,624 --> 00:18:15,725
the parcel around the building to support cover arrangements as well.

346
00:18:17,186 --> 00:18:21,228
Another thing we noticed is that while our parcel subdivision tech was making deciding

347
00:18:21,248 --> 00:18:26,911
the right number of buildings to build of each size easier, it looked really weird to

348
00:18:26,971 --> 00:18:29,733
have all these unrelated buildings all adjacent in this way.

349
00:18:30,793 --> 00:18:35,575
Every time we loaded a map with a subdivided parcel in it, it felt more like a hodgepodge

350
00:18:35,616 --> 00:18:37,116
of assets than an arranged space.

351
00:18:38,003 --> 00:18:41,825
We never did find a way to do this in a way that didn't feel off and we turned it off.

352
00:18:43,266 --> 00:18:47,247
It did, however, get us thinking about the relationship of a building to its surrounding space.

353
00:18:48,248 --> 00:18:53,670
We had stores coming in with their storefronts facing away from the roads and this didn't make much sense either.

354
00:18:55,991 --> 00:18:58,992
In order to address these issues, we came up with some ideas.

355
00:18:59,672 --> 00:19:01,573
The first was that of a parcel facing.

356
00:19:02,393 --> 00:19:07,255
When a parcel was defined, the side that was meant to be adjacent to the road was identified as the face.

357
00:19:08,297 --> 00:19:11,999
Each parcel in a plot had all of the sides adjacent to the roads marked as facings.

358
00:19:13,340 --> 00:19:15,621
These were represented by yellow arrows in the image.

359
00:19:16,362 --> 00:19:20,484
When a parcel was chosen to load into a plot, it would only come in at the rotation where

360
00:19:20,544 --> 00:19:23,266
its defined facing would match those allowed on the plot.

361
00:19:24,667 --> 00:19:29,049
The original design was that a parcel could come in at any rotation to maximize variety.

362
00:19:30,090 --> 00:19:34,792
While the new design was certainly less random than the original design, the proper orientation

363
00:19:34,832 --> 00:19:37,714
of a building was pretty critical in creating a believable space.

364
00:19:38,973 --> 00:19:43,054
We had a number of parcels that included parking lots or other vehicle access.

365
00:19:44,074 --> 00:19:47,035
Having these areas ringed in by sidewalk was pretty weird.

366
00:19:48,076 --> 00:19:51,097
Were all of these cars hopping curbs every time they wanted to park?

367
00:19:52,677 --> 00:19:57,158
Driveways existed in the plot, not the parcel, however, so they would have to be spawned

368
00:19:57,238 --> 00:19:58,659
in only where they were appropriate.

369
00:19:59,599 --> 00:20:03,640
So driveways became part of the parcel definition as well, and parcels would only come

370
00:20:03,680 --> 00:20:07,142
into a plot in a space that had all the driveways available that it needed.

371
00:20:07,663 --> 00:20:10,005
as a driveway had to connect to a road in the plot.

372
00:20:11,306 --> 00:20:13,067
The picture is what a parcel looks like

373
00:20:13,167 --> 00:20:14,347
in a plot in our editor.

374
00:20:15,148 --> 00:20:16,288
Excuse the programmer art.

375
00:20:17,529 --> 00:20:19,630
The arrows represent acceptable facings

376
00:20:20,171 --> 00:20:22,432
and the smaller squares are where the driveway show up.

377
00:20:23,393 --> 00:20:24,833
After placing a parcel in a plot,

378
00:20:24,933 --> 00:20:27,015
you can then toggle these settings per parcel

379
00:20:27,055 --> 00:20:28,496
based on the surrounding road networks.

380
00:20:29,996 --> 00:20:32,018
This technology was delicate, however,

381
00:20:32,838 --> 00:20:34,999
as it was easy to define a parcel so strictly

382
00:20:35,059 --> 00:20:36,720
that it rarely, if ever, showed up.

383
00:20:38,075 --> 00:20:42,398
If a given parcel had a specific facing as well as multiple driveway requirements,

384
00:20:43,138 --> 00:20:45,600
there may be only one or two plots that would accommodate it.

385
00:20:46,180 --> 00:20:49,282
And in those plots, it had to win the role against the other parcels

386
00:20:49,342 --> 00:20:51,023
that would also fit into that slot.

387
00:20:52,364 --> 00:20:54,966
There wasn't much point in building a parcel that no one would see.

388
00:20:55,606 --> 00:20:59,168
So these concepts had to be used carefully in order to minimize this.

389
00:21:00,409 --> 00:21:03,571
Typically, a parcel either had a driveway if it had a parking lot

390
00:21:03,711 --> 00:21:05,912
or a facing if it didn't, but never both.

391
00:21:07,519 --> 00:21:10,460
We also added markup to each parcel and PCP in the game

392
00:21:10,500 --> 00:21:13,202
to provide eligible locations for the XCOM squad

393
00:21:13,242 --> 00:21:15,202
to fast rope down from the Sky Ranger

394
00:21:16,043 --> 00:21:16,963
at the beginning of the mission.

395
00:21:18,224 --> 00:21:19,925
The number of player starts in each map

396
00:21:19,945 --> 00:21:21,205
was determined by its size,

397
00:21:21,345 --> 00:21:23,606
providing a uniform density of start locations

398
00:21:23,666 --> 00:21:26,007
for the greatest amount of flexibility and variation.

399
00:21:29,028 --> 00:21:30,889
Another iteration on parcel development

400
00:21:31,009 --> 00:21:32,870
was to introduce the concept of zones.

401
00:21:33,847 --> 00:21:38,008
Now that we had a lot of buildings for each plot type, they were coming in in strange ways.

402
00:21:38,789 --> 00:21:42,870
Small towns had two components, neighborhoods and downtown retail stores.

403
00:21:45,510 --> 00:21:49,171
It was weird to see a single family home on the same block as a shopping center.

404
00:21:49,831 --> 00:21:52,572
These buildings made more sense when they were clustered up.

405
00:21:53,392 --> 00:21:55,933
Homes around other homes, shops all in a row.

406
00:21:56,673 --> 00:21:59,834
By zoning parcels inside of plots, we could guarantee this outcome.

407
00:22:01,326 --> 00:22:05,468
Zones, facing, and driveways helped immensely with the believability of a space.

408
00:22:06,809 --> 00:22:10,230
Buildings now appeared on screen as you would expect them to in real life.

409
00:22:11,131 --> 00:22:15,693
They were oriented towards the road, were grounded with driveways, and were surrounded

410
00:22:15,753 --> 00:22:16,713
with similar structures.

411
00:22:17,494 --> 00:22:19,755
However, this came at a cost.

412
00:22:20,695 --> 00:22:24,597
We had significantly reduced the number of parcels that could appear at any given spot

413
00:22:24,677 --> 00:22:25,077
in a plot.

414
00:22:26,039 --> 00:22:31,223
In order to achieve the same amount of variation in each plot, we would have to create more parcels of each type.

415
00:22:33,064 --> 00:22:37,167
Zones were paying dividends and directing future parcel authoring.

416
00:22:38,609 --> 00:22:45,474
Once we had added zones to all of our parcel definitions, they generally fell within one of two categories per plot type and we focused on that.

417
00:22:46,575 --> 00:22:49,057
Zone specific plots were created for each plot type.

418
00:22:49,597 --> 00:22:52,500
For example, the image on the left is a small town neighborhood.

419
00:22:53,247 --> 00:22:56,450
zone plot, and the right is a downtown retail zone plot.

420
00:22:57,591 --> 00:22:59,432
Both of these zones were considered small town.

421
00:22:59,772 --> 00:23:01,794
They shared PCPs and most of their art.

422
00:23:04,996 --> 00:23:08,359
Maps shrunk in size from initial estimates as missions

423
00:23:08,419 --> 00:23:12,022
came online and we experimented with how far we wanted the XCOM

424
00:23:12,042 --> 00:23:14,343
squad to travel in order to reach their objective.

425
00:23:15,364 --> 00:23:18,126
This kind of experimentation was much easier now that we no

426
00:23:18,166 --> 00:23:20,708
longer had to involve an artist in order to accomplish it.

427
00:23:21,801 --> 00:23:28,547
Through iteration, our parcel sizes were now 16 by 16, 16 by 32, and 32 by 32.

428
00:23:29,228 --> 00:23:30,489
Nice base eight numbers.

429
00:23:31,330 --> 00:23:34,873
Initial PCPs were sized to the dimensions of their contents, however.

430
00:23:35,413 --> 00:23:40,157
We had six tile wide roads, 10 tile wide roads, and 16 tile wide roads.

431
00:23:41,178 --> 00:23:44,561
None of these numbers were compatible and it was impossible to assemble an

432
00:23:44,682 --> 00:23:46,623
asymmetrical plot with all of these elements.

433
00:23:47,930 --> 00:23:52,233
We settled on base 8 and changed the sizes of all the PCPs to match our parcels.

434
00:23:52,993 --> 00:23:57,516
This greatly eased plot assembly and allowed for significantly increased layout variation.

435
00:23:59,297 --> 00:24:06,082
Reinforcements that walked in from the side often took a few turns to reach the combat, minimizing their impact.

436
00:24:06,962 --> 00:24:12,826
A troop transport system was developed so that reinforcements could now fly into any point on the map,

437
00:24:13,127 --> 00:24:14,768
which made pacing combat easier.

438
00:24:16,735 --> 00:24:19,297
Troops could land at any of the player starts

439
00:24:19,337 --> 00:24:20,618
we had placed in each map.

440
00:24:21,558 --> 00:24:22,939
Because we had placed so many,

441
00:24:23,219 --> 00:24:25,600
we knew there would always be a valid location nearby

442
00:24:25,661 --> 00:24:26,321
for this to happen.

443
00:24:27,602 --> 00:24:29,883
It had a great side benefit for us as well,

444
00:24:30,503 --> 00:24:32,525
as it eliminated the need for road networks

445
00:24:32,565 --> 00:24:33,425
around the edge of the map.

446
00:24:34,566 --> 00:24:36,527
Large unit support was also cut

447
00:24:36,687 --> 00:24:38,268
as we solved their pathing issues

448
00:24:38,328 --> 00:24:41,230
by having them travel through and destroy objects instead,

449
00:24:41,530 --> 00:24:43,391
which made them feel more powerful as well.

450
00:24:45,200 --> 00:24:47,241
Without the need for roads around the edge of the map

451
00:24:47,441 --> 00:24:48,401
and around every building,

452
00:24:48,601 --> 00:24:50,342
we could alter the layout of our plots

453
00:24:50,382 --> 00:24:52,082
to have more buildings and fewer roads.

454
00:24:53,262 --> 00:24:55,263
This was a big improvement to both the visuals

455
00:24:55,403 --> 00:24:56,683
and the gameplay for these maps,

456
00:24:56,983 --> 00:24:59,584
as visual interest and better gameplay was in parcels,

457
00:24:59,864 --> 00:25:00,784
not road networks.

458
00:25:02,284 --> 00:25:04,505
The picture on the left was one of our older plots.

459
00:25:05,065 --> 00:25:07,586
It had eight parcels and 40 PCPs.

460
00:25:08,306 --> 00:25:10,746
The plot on the right was shrunk after the rules change.

461
00:25:11,146 --> 00:25:13,047
It contained only four parcels and 20 PCPs.

462
00:25:15,072 --> 00:25:17,733
With fewer parcels and PCPs loading per plot,

463
00:25:18,334 --> 00:25:20,594
we were getting more variation out of the same number

464
00:25:20,614 --> 00:25:21,875
of maps that we had created,

465
00:25:22,355 --> 00:25:24,216
as players were only seeing half as many

466
00:25:24,316 --> 00:25:25,476
each time they loaded a map.

467
00:25:28,578 --> 00:25:30,638
I've spent a lot of time so far talking about

468
00:25:30,678 --> 00:25:33,019
the development of plot and parcel maps.

469
00:25:33,740 --> 00:25:36,341
I'd like to briefly shift to mention some of the tools

470
00:25:36,381 --> 00:25:38,582
that we developed in order to make development easier.

471
00:25:40,330 --> 00:25:44,692
Asset swapping was another procedural component that we developed during production that ended

472
00:25:44,752 --> 00:25:46,333
up saving a lot of our time as well.

473
00:25:47,433 --> 00:25:53,156
We ended up shipping around 40 parcels and around 130 PCPs for the wilderness plot type,

474
00:25:53,697 --> 00:25:54,977
which was a temperate forest.

475
00:25:56,098 --> 00:26:00,900
The original plan was to have a similar suite of maps for a pair of sister plot types, the

476
00:26:00,981 --> 00:26:02,841
arid wilderness and the tundra wilderness.

477
00:26:04,637 --> 00:26:07,039
We had the arid and tundra meshes and materials

478
00:26:07,159 --> 00:26:09,480
created already, so we started by creating

479
00:26:09,520 --> 00:26:12,662
a set of temperate PCPs, manually swapping

480
00:26:12,682 --> 00:26:14,843
the materials and meshes in each map

481
00:26:14,883 --> 00:26:16,384
to the arid and tundra versions,

482
00:26:16,924 --> 00:26:18,765
then saving them out as separate files.

483
00:26:20,066 --> 00:26:21,547
This was really time consuming,

484
00:26:21,747 --> 00:26:24,228
as was the maintenance of these additional hundreds of maps.

485
00:26:25,869 --> 00:26:28,571
I managed to convince a programmer to write a system

486
00:26:28,611 --> 00:26:30,552
that would automatically do these predefined

487
00:26:30,612 --> 00:26:33,173
material and mesh swaps during load in game.

488
00:26:34,422 --> 00:26:37,224
Temperate, Arid, and Tundra were defined as biomes.

489
00:26:38,145 --> 00:26:40,066
All maps were constructed as temperate

490
00:26:40,206 --> 00:26:42,588
and swapped on the fly as the game requested

491
00:26:42,628 --> 00:26:43,949
a level of a different biome.

492
00:26:45,030 --> 00:26:47,332
Now we only had to maintain a third of the maps

493
00:26:47,372 --> 00:26:48,873
we had originally scheduled for,

494
00:26:49,234 --> 00:26:50,635
which saved man months of work.

495
00:26:52,116 --> 00:26:54,338
While the environment artists got out of an art past

496
00:26:54,418 --> 00:26:55,759
on hundreds of additional maps,

497
00:26:56,119 --> 00:26:57,981
they had to make Arid and Tundra versions

498
00:26:58,021 --> 00:26:59,962
of all of the cover assets and deco

499
00:27:00,002 --> 00:27:02,004
that we had made for the temperate wilderness.

500
00:27:02,495 --> 00:27:05,016
that were the same size and shape, which was challenging.

501
00:27:05,837 --> 00:27:07,658
The picture is the original test map

502
00:27:07,698 --> 00:27:10,399
that we used to plan out which assets we planned to swap

503
00:27:10,639 --> 00:27:12,120
and their equivalent for each biome.

504
00:27:15,321 --> 00:27:17,902
The assets that we weren't able to find swaps for

505
00:27:18,163 --> 00:27:21,004
would live in a biome only deco layer in each map.

506
00:27:21,924 --> 00:27:23,605
While this required the aforementioned

507
00:27:23,665 --> 00:27:26,506
dreaded comprehensive pass through all maps to add,

508
00:27:27,507 --> 00:27:29,108
there's just no error replacement

509
00:27:29,148 --> 00:27:30,248
for something like icicles.

510
00:27:30,989 --> 00:27:32,129
You can't swap everything.

511
00:27:33,697 --> 00:27:37,001
We eventually expanded this system to include map swaps as well.

512
00:27:37,882 --> 00:27:40,564
We couldn't make our stream PCP set work in arid.

513
00:27:41,065 --> 00:27:42,166
It looked more like a ditch.

514
00:27:43,387 --> 00:27:47,812
However, one of our environment artists created a beautiful riverbed set that swapped in when

515
00:27:47,852 --> 00:27:50,695
a wilderness map with a stream loaded into an arid biome.

516
00:27:51,957 --> 00:27:55,701
The images on the screen are the same wilderness stream plot in all three biomes.

517
00:27:56,522 --> 00:28:01,724
As you can see, the ARID version has a slightly different layout, and there are elements of

518
00:28:01,764 --> 00:28:03,685
biome-specific deco in all three.

519
00:28:05,566 --> 00:28:08,227
This system also worked on maps for other plot types.

520
00:28:09,888 --> 00:28:14,650
Now we had ARID small towns and tundra shantytowns for very little extra effort.

521
00:28:15,931 --> 00:28:19,333
It wasn't part of the original plan, but it came free with the technology.

522
00:28:20,751 --> 00:28:23,252
This asset swap system was further extended

523
00:28:23,312 --> 00:28:25,992
to provide visual variation in a number of different ways.

524
00:28:26,953 --> 00:28:28,993
We created a number of color variations

525
00:28:29,033 --> 00:28:31,154
for each civilian vehicle that the game

526
00:28:31,194 --> 00:28:33,274
would randomly choose between on load

527
00:28:33,354 --> 00:28:34,595
that kept things looking fresh.

528
00:28:35,555 --> 00:28:38,036
We were also able to swap out posters and signs

529
00:28:38,116 --> 00:28:39,276
and other miscellaneous deco.

530
00:28:42,239 --> 00:28:44,561
Our original method for testing new parcels

531
00:28:44,721 --> 00:28:47,163
that we created in-game was to pick a plot

532
00:28:47,383 --> 00:28:49,204
that they were eligible to appear in

533
00:28:49,525 --> 00:28:50,926
and reload it until the parcel

534
00:28:50,946 --> 00:28:52,387
that we wanted to test appeared.

535
00:28:53,508 --> 00:28:54,829
This wasn't terribly efficient.

536
00:28:55,809 --> 00:28:57,531
As we created more and more parcels,

537
00:28:57,711 --> 00:29:00,173
the strategy became to load the plot a few times

538
00:29:00,233 --> 00:29:01,274
to see if you got lucky,

539
00:29:01,954 --> 00:29:03,735
then get impatient enough to edit

540
00:29:03,855 --> 00:29:05,317
the parcel definitions locally

541
00:29:05,377 --> 00:29:07,218
to comment out all of the other parcels

542
00:29:07,278 --> 00:29:08,399
except for the one that you wanted.

543
00:29:10,417 --> 00:29:13,179
Our heroic systems programmer rose to meet this challenge

544
00:29:13,459 --> 00:29:15,981
and created Tactical Quick Launch, or TQL.

545
00:29:17,182 --> 00:29:19,224
TQL could load the plot without launching

546
00:29:19,244 --> 00:29:20,064
the tactical game.

547
00:29:20,925 --> 00:29:23,327
The plot would then load all of the component parcel

548
00:29:23,427 --> 00:29:25,048
and PCP maps as you watched.

549
00:29:25,728 --> 00:29:28,290
On slower computers, you could see the individual maps

550
00:29:28,390 --> 00:29:29,331
wink into existence.

551
00:29:30,232 --> 00:29:32,673
This gave the people working on the tactical game

552
00:29:32,894 --> 00:29:35,155
an appreciation for what was going on under the hood.

553
00:29:43,057 --> 00:29:46,580
One of the key features of TQL was that after the plot had loaded,

554
00:29:46,840 --> 00:29:50,843
you could select any parcel on the map and change it from a menu to any other parcel

555
00:29:50,883 --> 00:29:52,684
that would be eligible to fill in that slot.

556
00:29:53,505 --> 00:29:55,407
Parcel testing just got a lot easier.

557
00:29:56,848 --> 00:30:00,811
Eventually, a rudimentary menu was added that would allow you to change a number

558
00:30:00,851 --> 00:30:02,332
of variables before loading the map.

559
00:30:02,853 --> 00:30:06,876
You could select the time of day, the biome, the mission you wanted to go on,

560
00:30:07,156 --> 00:30:10,319
the squad you were playing with, how difficult the enemy should be, etc.

561
00:30:11,420 --> 00:30:13,681
Once you hit start, it would launch a tactical game

562
00:30:13,881 --> 00:30:15,242
on the map you had just constructed.

563
00:30:16,342 --> 00:30:18,083
This was a huge boon to testing

564
00:30:18,463 --> 00:30:19,684
and improving the game in general.

565
00:30:20,384 --> 00:30:23,125
I don't think we could have pulled it off without TQL.

566
00:30:26,447 --> 00:30:28,008
Now that we've had a glimpse at the tools,

567
00:30:28,228 --> 00:30:30,269
I'd like to talk about some of the challenges

568
00:30:30,309 --> 00:30:32,490
we ran into later in production on XCOM 2.

569
00:30:34,492 --> 00:30:38,894
Once we had the entire game in place and were able to start doing complete campaign playthroughs,

570
00:30:39,474 --> 00:30:42,896
we started picking up on an issue with how our tactical missions were playing out.

571
00:30:43,977 --> 00:30:48,319
Being able to go on any mission in any of our five plot types really genericized the

572
00:30:48,339 --> 00:30:48,759
spaces.

573
00:30:49,660 --> 00:30:51,500
No place really had an identity.

574
00:30:52,381 --> 00:30:56,583
Our solution to this issue was to pair specific plot types with specific missions.

575
00:30:57,486 --> 00:31:01,167
Previous to the iteration, you could have gone on a Guerrilla Ops mission on any of

576
00:31:01,207 --> 00:31:02,028
the six plot types.

577
00:31:02,788 --> 00:31:05,889
Now, you would only go on Guerrilla Ops in small towns.

578
00:31:06,610 --> 00:31:09,071
This required rebuilding all of the plots in the game.

579
00:31:10,691 --> 00:31:14,473
While this was a pretty major reconfiguration, it was actually a good thing.

580
00:31:15,508 --> 00:31:17,549
It allowed us to once again shrink our plots

581
00:31:17,709 --> 00:31:19,790
and tailor their size to be mission specific,

582
00:31:20,230 --> 00:31:22,670
as some missions required more space than others,

583
00:31:23,171 --> 00:31:25,351
and previously all plots had to be big enough

584
00:31:25,371 --> 00:31:26,912
to accommodate the mission that required

585
00:31:26,952 --> 00:31:28,092
the most amount of real estate.

586
00:31:29,392 --> 00:31:31,053
This helped with player navigation,

587
00:31:31,653 --> 00:31:34,874
as it was much easier, it was much clearer

588
00:31:34,954 --> 00:31:37,475
which direction to go when you started next to

589
00:31:37,595 --> 00:31:39,055
or ran up against the edge of the map.

590
00:31:39,735 --> 00:31:42,156
It also reduced memory footprint, loading times,

591
00:31:42,436 --> 00:31:44,257
and improved performance.

592
00:31:45,810 --> 00:31:48,952
Thanks to our map setup, we lost zero art in this conversion.

593
00:31:49,713 --> 00:31:51,534
It took me a week to reconstruct everything,

594
00:31:51,795 --> 00:31:53,136
and the game was better off for it.

595
00:31:54,096 --> 00:31:55,938
If this was done on Enemy Unknown,

596
00:31:56,098 --> 00:31:58,220
it would have required emergency surgery

597
00:31:58,380 --> 00:32:01,102
on every tactical map, and it couldn't have been done

598
00:32:01,142 --> 00:32:03,644
at that point in production without slipping the ship date.

599
00:32:04,965 --> 00:32:07,467
Being able to address this quickly was a good indication

600
00:32:07,507 --> 00:32:09,709
that we had improved our pipeline significantly.

601
00:32:12,465 --> 00:32:14,846
Now that we were doing regular full game play throughs,

602
00:32:15,646 --> 00:32:18,167
it became apparent that having all tactical missions

603
00:32:18,207 --> 00:32:19,667
be random left something missing.

604
00:32:20,668 --> 00:32:22,208
In Enemy Unknown, we had a series

605
00:32:22,248 --> 00:32:23,829
of what we called tentpole missions.

606
00:32:24,689 --> 00:32:26,570
They advance the story in key places

607
00:32:26,750 --> 00:32:28,170
and usually involve cinematics.

608
00:32:29,031 --> 00:32:31,051
We needed something like this for XCOM too,

609
00:32:31,392 --> 00:32:32,932
but these were big budget affairs

610
00:32:33,092 --> 00:32:34,813
and we were fairly late in production.

611
00:32:36,433 --> 00:32:38,654
Perhaps we can leverage our procedural system

612
00:32:38,674 --> 00:32:40,335
to cut down on the amount of work it takes

613
00:32:40,375 --> 00:32:41,415
to put one of these together.

614
00:32:42,513 --> 00:32:44,634
What if we made the map lead up procedural

615
00:32:44,754 --> 00:32:46,956
but the final destination was a static parcel

616
00:32:46,996 --> 00:32:49,818
with narrative elements including cinematics and VO?

617
00:32:51,539 --> 00:32:53,000
This proved to be a good hybrid

618
00:32:53,521 --> 00:32:55,602
as the levels came together relatively quickly.

619
00:32:56,263 --> 00:32:57,624
Instead of making an entire map

620
00:32:57,644 --> 00:32:58,985
for these custom narrative missions,

621
00:32:59,225 --> 00:33:02,867
we created a single 32 by 32 parcel for them and poured all

622
00:33:02,887 --> 00:33:04,609
of the effort into that one small space.

623
00:33:05,669 --> 00:33:06,990
They went together rather smoothly.

624
00:33:07,974 --> 00:33:12,719
The images on the screen are a black site, our first Golden Path mission, and the Psygate,

625
00:33:12,759 --> 00:33:13,539
which was our third.

626
00:33:14,440 --> 00:33:16,602
Apologies if either of these were spoilers.

627
00:33:19,625 --> 00:33:24,350
When the final ratio of missions was established, this put a third of the missions into one

628
00:33:24,470 --> 00:33:25,511
of the five plot types.

629
00:33:26,332 --> 00:33:30,836
People playing the game were reporting that they were seeing a lot of small town, way

630
00:33:30,876 --> 00:33:32,077
more than the other plot types.

631
00:33:33,995 --> 00:33:36,156
What if we added another plot type to the game

632
00:33:36,236 --> 00:33:37,936
to split the load of guerrilla ops missions?

633
00:33:39,296 --> 00:33:41,677
Okay, but our other plot types typically

634
00:33:41,737 --> 00:33:45,278
have three dozen parcels and six dozen PCPs to support them,

635
00:33:45,858 --> 00:33:48,298
and we don't have enough time to build that many new maps.

636
00:33:49,699 --> 00:33:51,539
The obvious question that we hadn't considered

637
00:33:51,559 --> 00:33:54,180
to that point was, well, do we really need

638
00:33:54,200 --> 00:33:55,920
that many maps to sell a new plot type?

639
00:33:57,040 --> 00:33:58,761
We only had enough time in the schedule

640
00:33:58,781 --> 00:34:00,541
to build half that amount without crunching.

641
00:34:01,350 --> 00:34:03,651
We decided to cross our fingers and take a chance

642
00:34:03,711 --> 00:34:05,413
in the reduced number of maps being enough.

643
00:34:06,874 --> 00:34:09,516
Slums came in real hot, but we got it all done in time

644
00:34:09,556 --> 00:34:11,257
to be play-sested and ship with the title.

645
00:34:12,338 --> 00:34:14,599
As it turns out, the more plot types you have,

646
00:34:14,679 --> 00:34:16,320
the less content you need for each one.

647
00:34:17,721 --> 00:34:19,603
There was enough Slums content to support

648
00:34:19,663 --> 00:34:22,125
a single playthrough without getting any repeat content.

649
00:34:23,005 --> 00:34:25,647
Only our most hardcore fans noticed that the Slums

650
00:34:25,707 --> 00:34:28,289
was a less robust set than the others.

651
00:34:29,416 --> 00:34:31,478
Because we built the plot type with all the knowledge

652
00:34:31,518 --> 00:34:32,899
and experience of building the others,

653
00:34:33,759 --> 00:34:35,781
we were able to take it farther more quickly.

654
00:34:36,682 --> 00:34:38,723
It ended up being one of the most iconic spaces

655
00:34:39,083 --> 00:34:40,505
and was featured in a lot of marketing.

656
00:34:41,345 --> 00:34:42,926
I was happy to have been wrong on this one.

657
00:34:45,729 --> 00:34:48,851
Okay, so now that we've shipped XCOM 2, how did we do?

658
00:34:50,072 --> 00:34:52,093
XCOM 2 shipped with around 80 plots,

659
00:34:52,634 --> 00:34:54,755
a comparable number to the 80 tactical maps

660
00:34:54,796 --> 00:34:55,956
that ship with Enemy Unknown.

661
00:34:56,838 --> 00:34:59,598
However, these plots had over 200 parcels

662
00:34:59,718 --> 00:35:02,399
and 450 PCPs to support them.

663
00:35:03,259 --> 00:35:05,560
While we had technically the same number of map layouts,

664
00:35:05,700 --> 00:35:07,620
between all the content loading procedurally

665
00:35:07,640 --> 00:35:09,761
inside of them, each layout could provide

666
00:35:09,781 --> 00:35:11,381
a dramatically different visual appearance

667
00:35:11,421 --> 00:35:12,441
in gameplay experience.

668
00:35:14,001 --> 00:35:15,802
Watching people play and talk about the game,

669
00:35:15,962 --> 00:35:17,802
tactical maps were generally well regarded,

670
00:35:18,102 --> 00:35:20,083
and people were playing through the game multiple times

671
00:35:20,263 --> 00:35:21,343
without complaining about them,

672
00:35:21,963 --> 00:35:23,103
which is one of our main goals.

673
00:35:24,117 --> 00:35:26,899
Also, we were all playing the game over and over internally,

674
00:35:27,259 --> 00:35:29,120
and I would occasionally hear from a co-worker

675
00:35:29,280 --> 00:35:32,002
about how he had come across some negative content

676
00:35:32,082 --> 00:35:34,984
in his third playthrough that he had never seen before

677
00:35:35,064 --> 00:35:36,825
and marveled at how much stuff we had made.

678
00:35:38,326 --> 00:35:39,907
Well, that's cool, but wait a second.

679
00:35:40,267 --> 00:35:41,488
Did we make too much stuff?

680
00:35:42,789 --> 00:35:45,450
How many playthroughs are okay before content is repeated?

681
00:35:46,511 --> 00:35:49,133
We underestimated how much we could stretch our content,

682
00:35:49,233 --> 00:35:51,354
and as a result, we built more than we needed to.

683
00:35:52,711 --> 00:35:56,673
We planned on playing through a campaign without seeing any individual building twice.

684
00:35:57,434 --> 00:36:01,756
With all of the other visual variation going on, the location of the building inside the

685
00:36:01,776 --> 00:36:06,679
plot, the rotation it came in at, and the different objectives associated with it, it

686
00:36:06,719 --> 00:36:08,400
was okay to see a building more than once.

687
00:36:09,021 --> 00:36:13,163
Sometimes it was cooler to recognize a building, then play through it in a different way.

688
00:36:14,124 --> 00:36:18,847
The takeaway is that future content could involve fewer maps, which was a valuable lesson

689
00:36:18,907 --> 00:36:19,847
for expansion planning.

690
00:36:23,190 --> 00:36:27,814
Not long after XCOM 2 was out the door, we began planning for an expansion pack.

691
00:36:28,715 --> 00:36:33,199
A traditional video game expansion pack is typically a discrete set of content that lives

692
00:36:33,259 --> 00:36:34,960
alongside the base game campaign.

693
00:36:35,821 --> 00:36:40,545
What makes a Firaxis expansion pack so exciting is that they often involve revisiting elements

694
00:36:40,585 --> 00:36:41,245
of the core game.

695
00:36:42,066 --> 00:36:44,328
The XCOM 2 expansion was no exception to this.

696
00:36:46,009 --> 00:36:51,433
As a level designer, I've had very few opportunities to alter content posts yet, yet it's a fairly

697
00:36:51,493 --> 00:36:55,457
common occurrence to look back on old work with the benefit of distance and hindsight

698
00:36:55,977 --> 00:36:57,619
and come up with ways to improve upon it.

699
00:36:58,579 --> 00:37:03,243
In addition, no amount of internal testing and evaluation will substitute for the feedback

700
00:37:03,283 --> 00:37:06,066
you get from reading forums and watching Twitch post-launch.

701
00:37:07,544 --> 00:37:11,747
One of what I thought was the more valuable and actionable pieces of feedback that bubbled

702
00:37:11,807 --> 00:37:15,869
up from all of our post-launch playthroughs and from observing the internet was regarding

703
00:37:15,909 --> 00:37:16,570
our plot types.

704
00:37:17,650 --> 00:37:22,613
While the various plot types we had created from XCOM 2 were visually distinct, they didn't

705
00:37:22,653 --> 00:37:23,814
vary much in gameplay.

706
00:37:24,574 --> 00:37:26,996
This was something that we wanted to address in the expansion.

707
00:37:28,423 --> 00:37:29,804
But before we could address this,

708
00:37:29,924 --> 00:37:31,485
we had a bunch of new missions planned

709
00:37:31,505 --> 00:37:33,186
that required a bunch of new plot types.

710
00:37:33,947 --> 00:37:35,608
We now had a much better understanding

711
00:37:35,648 --> 00:37:36,869
of how everything fit together,

712
00:37:37,209 --> 00:37:38,430
and we could use this knowledge

713
00:37:38,490 --> 00:37:40,211
to take the procedural system farther

714
00:37:40,471 --> 00:37:41,632
than we had on the base game.

715
00:37:42,273 --> 00:37:43,914
I'd like to walk through a few of these now.

716
00:37:46,736 --> 00:37:48,357
The idea for the abandoned city

717
00:37:48,397 --> 00:37:50,238
spawned from a conversation lamenting

718
00:37:50,298 --> 00:37:51,779
the cost of building interiors.

719
00:37:52,700 --> 00:37:54,742
Building interiors are the most expensive

720
00:37:54,822 --> 00:37:56,403
custom part of an XCOM map,

721
00:37:56,503 --> 00:37:58,164
and took the longest time to create.

722
00:37:58,983 --> 00:38:01,445
However, the game encourages players

723
00:38:01,485 --> 00:38:03,547
to travel via the rooftop in order to gain

724
00:38:03,567 --> 00:38:05,808
the aiming bonuses against units on the ground

725
00:38:06,249 --> 00:38:08,030
and fewer chances of being surprised

726
00:38:08,230 --> 00:38:10,512
by the more open lines of sight on the rooftops.

727
00:38:12,133 --> 00:38:14,195
I postulated that we could address the problem

728
00:38:14,235 --> 00:38:16,456
without changing the gameplay mechanics or the art.

729
00:38:17,497 --> 00:38:19,618
What if we built a city without any roofs?

730
00:38:21,019 --> 00:38:23,161
Obviously, the buildings themselves had to have roofs,

731
00:38:23,281 --> 00:38:25,283
but they didn't have to be accessible to the player.

732
00:38:26,283 --> 00:38:28,065
We'll make them go inside, by golly.

733
00:38:29,638 --> 00:38:31,860
Exploring this idea led to the discovery

734
00:38:31,900 --> 00:38:33,521
that it was tough to make a believable,

735
00:38:33,601 --> 00:38:36,063
dense urban environment out of standalone buildings

736
00:38:36,123 --> 00:38:40,947
that were all 16 by 16, 16 by 32, and 32 by 32.

737
00:38:42,529 --> 00:38:44,430
The buildings felt like they needed to be larger,

738
00:38:44,731 --> 00:38:46,932
but the best gameplay coming out of the plot type

739
00:38:47,032 --> 00:38:49,174
was the fighting into and out of buildings.

740
00:38:50,175 --> 00:38:52,077
I wanted to proceduralize our buildings,

741
00:38:52,157 --> 00:38:54,719
but all of our visibility and other technical markup

742
00:38:54,779 --> 00:38:56,640
required the entire building to exist

743
00:38:56,681 --> 00:38:57,841
within a single map file.

744
00:38:59,312 --> 00:39:01,233
We wrote some tech to allow a single building

745
00:39:01,273 --> 00:39:02,594
to span multiple parcels.

746
00:39:04,154 --> 00:39:06,396
This way, we could have buildings the size and shape

747
00:39:06,436 --> 00:39:08,757
that we needed without losing the visual and gameplay

748
00:39:08,797 --> 00:39:10,318
variety of the procedural system.

749
00:39:12,099 --> 00:39:13,620
Armed with our previous conclusion

750
00:39:13,660 --> 00:39:15,481
that we could make the system out of fewer maps,

751
00:39:15,861 --> 00:39:18,523
the entire block building system is only 16 pieces.

752
00:39:19,083 --> 00:39:22,826
There were four each of building end caps, corners, straights,

753
00:39:23,086 --> 00:39:24,246
and T intersections.

754
00:39:25,087 --> 00:39:27,628
Because each plot had a differently sized and shaped

755
00:39:27,648 --> 00:39:28,189
block building.

756
00:39:29,058 --> 00:39:30,378
No two buildings feel the same.

757
00:39:33,140 --> 00:39:35,341
Tunnels were another attempt to extend the game

758
00:39:35,381 --> 00:39:36,221
in a different direction.

759
00:39:36,881 --> 00:39:39,422
Tunnels is an entirely interior plot type

760
00:39:39,502 --> 00:39:41,403
with limited sight lines and negative space.

761
00:39:42,364 --> 00:39:43,964
The visual focus of the tunnels is

762
00:39:44,024 --> 00:39:45,885
on the PCPs and not the parcels.

763
00:39:46,486 --> 00:39:49,087
The parcels are mostly generic mechanical spaces

764
00:39:49,287 --> 00:39:51,828
and the art love went into the expansive subway tunnels

765
00:39:51,948 --> 00:39:53,248
and the cathedral-like sewers.

766
00:39:54,289 --> 00:39:56,350
Because they are procedural, they share a lot

767
00:39:56,370 --> 00:39:58,771
of filler content which saved quite a bit on our time.

768
00:40:00,298 --> 00:40:03,960
The sewer tunnels are wide and open and have a pit running down the center which cannot

769
00:40:04,000 --> 00:40:08,223
be entered but is regularly crossed by bridges which frequently became choke points.

770
00:40:09,083 --> 00:40:13,486
This produces an interesting difference in combat from the limited sight lines and verticality

771
00:40:13,606 --> 00:40:14,507
of the subway tunnels.

772
00:40:19,150 --> 00:40:23,372
Chosen Strongholds were spawned by the idea of creating a procedural dungeon crawl in

773
00:40:23,492 --> 00:40:23,813
XCOM.

774
00:40:24,787 --> 00:40:27,008
Continuing with the idea of creating as few maps

775
00:40:27,048 --> 00:40:28,349
as possible to support this,

776
00:40:28,849 --> 00:40:31,531
how many unique 16 by 16 rooms do we need

777
00:40:31,551 --> 00:40:34,273
to support three dungeon runs of seven room dungeons?

778
00:40:35,194 --> 00:40:36,635
After a lot of experimentation,

779
00:40:36,795 --> 00:40:38,556
we ended up creating 15 rooms.

780
00:40:39,697 --> 00:40:41,899
Because the majority of the combat occurred

781
00:40:41,959 --> 00:40:44,320
between two rooms, randomizing the order

782
00:40:44,340 --> 00:40:46,442
of the rooms appeared had a profound effect

783
00:40:46,502 --> 00:40:47,282
upon the gameplay.

784
00:40:48,743 --> 00:40:50,565
This spawned an interesting conversation

785
00:40:50,605 --> 00:40:52,426
with the environment artist I was paired with

786
00:40:52,546 --> 00:40:53,206
on this plot type.

787
00:40:54,332 --> 00:40:56,153
He was upset that the layout of the base

788
00:40:56,233 --> 00:40:57,414
made no logical sense.

789
00:40:58,375 --> 00:40:59,876
He was expecting the player to start

790
00:40:59,936 --> 00:41:02,077
at the entrance to the base and fight through the rooms

791
00:41:02,217 --> 00:41:04,339
in the order that a guy building a functioning base

792
00:41:04,379 --> 00:41:05,040
would place them in.

793
00:41:06,120 --> 00:41:07,882
We could have built that dungeon procedurally,

794
00:41:08,002 --> 00:41:10,283
but I expect we would have had to make three times

795
00:41:10,323 --> 00:41:12,145
the number of rooms in order to have them

796
00:41:12,245 --> 00:41:14,767
in a sensical order and still get the gameplay variation

797
00:41:14,807 --> 00:41:15,507
we were looking for.

798
00:41:17,028 --> 00:41:18,530
It raises an interesting question.

799
00:41:19,891 --> 00:41:21,832
How much do these spaces need to make sense?

800
00:41:22,978 --> 00:41:26,560
I pointed out all the other shortcuts and liberties we took on the other plot types

801
00:41:26,600 --> 00:41:27,581
for the sake of gameplay.

802
00:41:28,562 --> 00:41:31,804
Has anyone noticed that there isn't a single bathroom in all of XCOM?

803
00:41:33,565 --> 00:41:37,928
Personally, I think there's a lot of leeway available in the in-game representation of

804
00:41:37,989 --> 00:41:42,472
reality that you have before you actually break immersion for the player, and no one

805
00:41:42,532 --> 00:41:45,734
playing the game will pay as much attention to it as the people who are working on it.

806
00:41:48,821 --> 00:41:53,804
The xeniform biome was originally conceived as its own plot type, similar to the idea

807
00:41:53,864 --> 00:41:56,265
of having arid and tundra versions of the wilderness.

808
00:41:57,266 --> 00:42:01,889
Just like the other two, the procedural solution to implementing this was to create a fourth

809
00:42:01,949 --> 00:42:03,610
swap type for wilderness assets.

810
00:42:04,530 --> 00:42:09,293
We made a fourth set of rocks, trees, ground deco, and terrain materials that simulated

811
00:42:09,433 --> 00:42:13,616
alien flora that had been released into the terrestrial wild, corrupting it.

812
00:42:15,355 --> 00:42:18,376
We created new times of day with unusual colors and effects

813
00:42:18,416 --> 00:42:20,217
that would only load with a new biome type,

814
00:42:20,417 --> 00:42:21,618
furthering the visual difference.

815
00:42:22,858 --> 00:42:24,879
This swap could be applied to hundreds of maps

816
00:42:24,899 --> 00:42:26,300
that we had created for the base game.

817
00:42:27,480 --> 00:42:29,661
In this way, the procedural system opened up

818
00:42:29,781 --> 00:42:32,002
new avenues of development for an expansion,

819
00:42:32,162 --> 00:42:33,843
as we could alter base game content

820
00:42:34,003 --> 00:42:35,324
without editing any of it.

821
00:42:36,324 --> 00:42:37,945
The two screenshots are of the same

822
00:42:38,005 --> 00:42:39,566
base game wilderness lake parcel.

823
00:42:40,406 --> 00:42:41,767
The left is the tempered version,

824
00:42:41,907 --> 00:42:43,267
as it was constructed in the editor.

825
00:42:43,570 --> 00:42:46,412
The right is after going a swap to the xenoform biome.

826
00:42:47,373 --> 00:42:49,174
Fairly dramatic visual departure.

827
00:42:52,276 --> 00:42:54,218
One of our goals in the expansion was to add

828
00:42:54,258 --> 00:42:56,559
gameplay variation to the base game plot types

829
00:42:56,639 --> 00:42:58,481
to match their distinct visual variation.

830
00:42:59,442 --> 00:43:02,984
To solve this, we added a unique PCP set to each plot type

831
00:43:03,024 --> 00:43:04,425
to help change the way they played.

832
00:43:05,231 --> 00:43:07,892
There was a focus on adding verticality and negative space

833
00:43:07,932 --> 00:43:11,213
to plots, with each plot type getting its own unique take

834
00:43:11,273 --> 00:43:11,753
on the theme.

835
00:43:12,674 --> 00:43:14,714
Wilderness and Cheney got coastal cliffs,

836
00:43:15,295 --> 00:43:19,036
city center got canals, slums got washes, retaining walls,

837
00:43:19,116 --> 00:43:21,997
and modular overpasses, and small town got ravines.

838
00:43:23,778 --> 00:43:26,039
In order to incorporate these new items

839
00:43:26,079 --> 00:43:27,539
so their appearance would be balanced,

840
00:43:27,719 --> 00:43:29,960
I had to redo all 80 plots in the game.

841
00:43:31,060 --> 00:43:32,261
It only took a couple of weeks,

842
00:43:32,421 --> 00:43:33,881
and its benefits were twofold.

843
00:43:34,903 --> 00:43:38,184
The plots now centered around the gameplay defining PCP sets

844
00:43:38,204 --> 00:43:39,005
for that plot type,

845
00:43:39,445 --> 00:43:41,605
creating the gameplay variety we were looking for.

846
00:43:42,425 --> 00:43:44,466
Plots could now be shrunk even further due

847
00:43:44,506 --> 00:43:46,607
to mission iteration that took place

848
00:43:46,827 --> 00:43:48,527
after the original plots were constructed.

849
00:43:49,387 --> 00:43:51,308
The new plots were as tight as we could get them

850
00:43:51,528 --> 00:43:52,808
and they were playing better than ever.

851
00:43:54,389 --> 00:43:56,989
We also wanted to coax players back into buildings,

852
00:43:57,409 --> 00:43:59,330
something we had addressed in the abandoned city

853
00:43:59,730 --> 00:44:02,131
but needed attention everywhere else.

854
00:44:04,597 --> 00:44:07,378
Building interiors were interfering with our concealment system.

855
00:44:07,898 --> 00:44:12,580
Jumping through windows, an ex-com soldier's preferred method of building entry, would

856
00:44:12,620 --> 00:44:13,360
break concealment.

857
00:44:14,301 --> 00:44:19,203
A lot of our new missions were on timers, and players had to spend extra turns moving

858
00:44:19,243 --> 00:44:23,044
to and opening doors in order to make a concealed squad go through the interior.

859
00:44:24,158 --> 00:44:26,519
we gained the ability to set the starting state of doors

860
00:44:27,059 --> 00:44:28,740
and took a pass through the base game buildings,

861
00:44:29,060 --> 00:44:30,520
setting a bunch of them to start open.

862
00:44:31,361 --> 00:44:33,321
This significantly improved the efficiency

863
00:44:33,381 --> 00:44:35,202
of concealed movement and building interiors.

864
00:44:38,323 --> 00:44:40,244
Now that you've heard where we've taken

865
00:44:40,304 --> 00:44:42,784
our procedural system, it's time to take a step back

866
00:44:42,824 --> 00:44:44,965
and look at the advantages and disadvantages

867
00:44:45,165 --> 00:44:46,566
of switching to using this system.

868
00:44:47,886 --> 00:44:49,847
I think the talk thus far has demonstrated

869
00:44:49,887 --> 00:44:51,627
the specifics of most of the advantages.

870
00:44:52,765 --> 00:44:54,745
It's also worth noting the benefit

871
00:44:54,785 --> 00:44:56,666
that the procedural system had for modders.

872
00:44:57,566 --> 00:45:00,807
The Long War II guys, our flagship total conversion mod,

873
00:45:00,847 --> 00:45:02,847
were able to rearrange quite a few things

874
00:45:03,207 --> 00:45:05,188
to suit their own ends without creating

875
00:45:05,228 --> 00:45:07,088
very many new parcels or PCPs.

876
00:45:08,149 --> 00:45:10,469
They mostly focused on creating new plot layouts

877
00:45:10,509 --> 00:45:12,210
to suit the mission types they had created.

878
00:45:13,710 --> 00:45:16,031
It's worth going through some of the disadvantages as well.

879
00:45:17,149 --> 00:45:19,170
The environment artists almost all preferred

880
00:45:19,210 --> 00:45:20,130
making static maps.

881
00:45:20,810 --> 00:45:22,671
They felt like they lost a lot of control

882
00:45:22,751 --> 00:45:23,932
over the appearance of a scene

883
00:45:23,972 --> 00:45:26,152
through the procedural system, and they were right.

884
00:45:27,593 --> 00:45:30,134
Firaxis prioritizes gameplay over visuals,

885
00:45:30,254 --> 00:45:32,055
but this is not true for many studios,

886
00:45:32,115 --> 00:45:33,195
and it may be a hard sell

887
00:45:33,255 --> 00:45:34,816
for a more artist-centric environment.

888
00:45:36,336 --> 00:45:38,117
Cinematics were more difficult to create

889
00:45:38,177 --> 00:45:39,297
in a procedural environment.

890
00:45:40,177 --> 00:45:42,398
A fun conversation to have with a cinematic artist

891
00:45:42,458 --> 00:45:44,279
is to tell them that the framing and background

892
00:45:44,319 --> 00:45:46,260
of their shot will change every time they watch it.

893
00:45:48,162 --> 00:45:50,543
We also never developed the technology to write out

894
00:45:50,603 --> 00:45:52,923
a procedurally generated map as a static map,

895
00:45:53,063 --> 00:45:55,284
so cinematic artists often had no idea

896
00:45:55,344 --> 00:45:56,684
how much space they had to work with.

897
00:45:58,265 --> 00:46:00,225
It was hard to fit a lot of visual storytelling

898
00:46:00,265 --> 00:46:01,445
into the smaller map chunks.

899
00:46:02,166 --> 00:46:04,126
This was a staple of the Enemy Unknown maps,

900
00:46:04,266 --> 00:46:06,146
and we lost it to some degree with the Switch.

901
00:46:07,127 --> 00:46:09,907
This is not necessarily a disadvantage of going procedural,

902
00:46:10,387 --> 00:46:11,988
it was just one that we ended up with

903
00:46:12,148 --> 00:46:14,408
as a result of choosing to use smaller map sizes.

904
00:46:17,660 --> 00:46:20,862
The initial idea behind taking XCOM procedural was,

905
00:46:21,062 --> 00:46:23,264
it's better because it's different every time.

906
00:46:24,365 --> 00:46:27,307
Paraxis has a long history of procedural content development

907
00:46:27,347 --> 00:46:28,648
with the Civilization series,

908
00:46:29,288 --> 00:46:32,110
but that doesn't necessarily translate into every genre.

909
00:46:32,911 --> 00:46:34,072
Outside of scenarios,

910
00:46:34,352 --> 00:46:36,453
Civilization doesn't even have level designers.

911
00:46:37,734 --> 00:46:40,476
If I had to approach a procedural level design system again,

912
00:46:40,496 --> 00:46:41,957
I would be more careful

913
00:46:42,017 --> 00:46:43,579
with what I was willing to leave to chance.

914
00:46:44,410 --> 00:46:46,612
There's a lot to be said for handcrafted content,

915
00:46:46,852 --> 00:46:49,374
and there's something to be lost for abandoning it entirely.

916
00:46:50,955 --> 00:46:52,356
The question that comes out of it is,

917
00:46:52,977 --> 00:46:54,819
how procedural does your game need to be?

918
00:46:55,659 --> 00:46:58,442
There's a sliding scale between replayability and character.

919
00:46:59,262 --> 00:47:01,504
More smaller maps provide the most variety,

920
00:47:01,564 --> 00:47:02,465
but can lack soul.

921
00:47:03,426 --> 00:47:06,288
Fewer larger maps allows for more visual storytelling

922
00:47:06,548 --> 00:47:08,030
at the expense of replayability.

923
00:47:09,191 --> 00:47:10,892
Where do you want to land on the spectrum?

924
00:47:15,703 --> 00:47:16,304
That's all I got.

925
00:47:26,172 --> 00:47:29,534
So it looks like we have a few minutes for questions if anyone has one wants to come

926
00:47:29,574 --> 00:47:29,955
up to the mic.

927
00:47:31,907 --> 00:47:36,969
Hi, I'm wondering all the mission contents of the enemy placement where the objective

928
00:47:37,229 --> 00:47:41,410
R was working with using only procedural generated map.

929
00:47:41,750 --> 00:47:46,392
Was it metadata in the plot or parcel themselves or there was something that the level designer

930
00:47:46,432 --> 00:47:47,373
was adding afterwards?

931
00:47:48,733 --> 00:47:52,815
All of the mission specific metadata was added to all of the parcels and PCPs.

932
00:47:53,115 --> 00:47:56,877
Each map knew what missions it was allowed for and that was added to the definition.

933
00:47:58,309 --> 00:48:01,112
And so that was covering all the potential variation of valid

934
00:48:01,132 --> 00:48:03,134
mission in the map.

935
00:48:03,354 --> 00:48:04,235
There was a lot of markup.

936
00:48:04,756 --> 00:48:05,317
Perfect, thanks.

937
00:48:07,900 --> 00:48:09,762
Over here.

938
00:48:09,782 --> 00:48:11,984
How do you deal with more global issues such as lighting

939
00:48:12,004 --> 00:48:12,585
and performance?

940
00:48:14,145 --> 00:48:19,210
Well, one of the downsides of switching to the procedural system was that in Enemy Unknown,

941
00:48:19,390 --> 00:48:24,595
we were using pre-rendered lighting that was baked out into the maps, but that was no longer

942
00:48:25,515 --> 00:48:27,097
an option with the procedural system.

943
00:48:27,377 --> 00:48:33,303
So we switched to a deferred system, which, you know, had the lighting rendering in real

944
00:48:33,343 --> 00:48:36,166
time, and that didn't look quite as good.

945
00:48:38,146 --> 00:48:43,208
And it was more expensive, but the variety that we got from being able to load any map

946
00:48:43,248 --> 00:48:45,810
with a different time of day, I think more than made up for it.

947
00:48:48,251 --> 00:48:48,591
Over here.

948
00:48:49,872 --> 00:48:54,034
Did you support tools for, say I'm a level designer, and for this one story mission I

949
00:48:54,054 --> 00:48:58,276
want guys to spawn this way and run around the right side of this building, did you support

950
00:48:58,316 --> 00:48:59,596
that kind of specific scripting?

951
00:48:59,856 --> 00:49:00,697
You mean for enemies?

952
00:49:01,677 --> 00:49:02,758
Yeah, for enemies or allies.

953
00:49:04,324 --> 00:49:08,307
We didn't do a lot of direct control over enemies via scripting.

954
00:49:08,928 --> 00:49:10,549
Most of that was handled by the system.

955
00:49:10,969 --> 00:49:16,254
We could call for additional enemies, but the game decided on the fly where it wanted

956
00:49:16,294 --> 00:49:18,056
to put them based on where the player was.

957
00:49:18,556 --> 00:49:18,796
Gotcha.

958
00:49:18,937 --> 00:49:19,197
Thanks.

959
00:49:22,860 --> 00:49:23,180
Alright.

960
00:49:23,741 --> 00:49:25,062
Well, I think we're out of questions.

961
00:49:25,282 --> 00:49:25,883
Thanks for coming.

