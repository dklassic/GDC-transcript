1
00:00:05,982 --> 00:00:08,383
All right, so hi everybody, I'm Martin Walsh,

2
00:00:08,383 --> 00:00:11,745
and my talk is Modeling AI Perception and Awareness

3
00:00:11,745 --> 00:00:14,006
in Splinter Cell Blacklist.

4
00:00:14,006 --> 00:00:15,526
It's a 25 minute talk, so I'm gonna try

5
00:00:15,526 --> 00:00:17,967
to keep it pretty tight, including this intro,

6
00:00:17,967 --> 00:00:21,389
but I do wanna let you guys know I'm from Ubisoft Toronto.

7
00:00:21,389 --> 00:00:23,590
I was the AI lead on Blacklist,

8
00:00:23,590 --> 00:00:25,811
the AI tech lead on Splinter Cell Conviction,

9
00:00:25,811 --> 00:00:28,032
and I have about 10 years experience in the industry.

10
00:00:30,747 --> 00:00:32,808
So why perception and awareness?

11
00:00:32,808 --> 00:00:34,429
Well, I mean, if the AI in your game

12
00:00:34,429 --> 00:00:36,470
doesn't always magically know where the player is,

13
00:00:36,470 --> 00:00:38,791
you need some type of perception and awareness model.

14
00:00:38,791 --> 00:00:40,952
And with more and more games incorporating

15
00:00:40,952 --> 00:00:43,073
stealth elements, how these models function

16
00:00:43,073 --> 00:00:45,935
can really shape the quality of the experience you provide.

17
00:00:45,935 --> 00:00:48,036
And Blacklist obviously has a very heavy stealth component.

18
00:00:48,036 --> 00:00:50,437
So for us, these models are extremely important.

19
00:00:50,437 --> 00:00:51,398
But before I start describing them,

20
00:00:51,398 --> 00:00:54,980
I just want to talk about three characteristics

21
00:00:54,980 --> 00:00:57,681
that I think these models need to display to be really good.

22
00:01:00,116 --> 00:01:03,138
So first of all, they need to feel fair.

23
00:01:03,138 --> 00:01:04,980
I mean, getting detected can really

24
00:01:04,980 --> 00:01:06,581
be the difference between success

25
00:01:06,581 --> 00:01:08,683
and like chucking your controller at the screen,

26
00:01:08,683 --> 00:01:11,084
especially if you feel that that detection was unfair.

27
00:01:11,084 --> 00:01:14,807
And second is they need to provide consistent feedback.

28
00:01:14,807 --> 00:01:16,969
So you need to have some idea of how

29
00:01:16,969 --> 00:01:20,452
the AI is going to react, what they're reacting to,

30
00:01:20,452 --> 00:01:22,113
so that you can strategize and improve.

31
00:01:25,169 --> 00:01:27,471
And the third is that they need to demonstrate intelligence.

32
00:01:27,471 --> 00:01:29,632
If your opponents feel dumb, then you really

33
00:01:29,632 --> 00:01:31,674
get no satisfaction in beating them.

34
00:01:31,674 --> 00:01:32,895
But what's interesting is not being dumb

35
00:01:32,895 --> 00:01:34,476
doesn't necessarily mean being smart.

36
00:01:34,476 --> 00:01:37,378
And what it actually means is always being plausible.

37
00:01:37,378 --> 00:01:39,580
And that's something that I'll come back

38
00:01:39,580 --> 00:01:40,481
to a lot throughout this talk.

39
00:01:40,481 --> 00:01:42,262
And finally, it's interesting to note

40
00:01:42,262 --> 00:01:43,523
that there's often a conflict that

41
00:01:43,523 --> 00:01:46,165
exists between fairness, consistency, and intelligence.

42
00:01:46,165 --> 00:01:48,206
And that's something that's important to be aware of.

43
00:01:48,206 --> 00:01:49,888
And I'll allude to that as well throughout the presentation.

44
00:01:52,813 --> 00:01:54,934
I'm going to talk about four types of perception

45
00:01:54,934 --> 00:01:55,475
and awareness.

46
00:01:55,475 --> 00:01:57,516
But before I jump in, I just want to let you guys know,

47
00:01:57,516 --> 00:01:59,156
I'm going to stop saying perception and awareness

48
00:01:59,156 --> 00:02:01,257
because it's really long and annoying to say.

49
00:02:01,257 --> 00:02:04,479
And although they are two different things,

50
00:02:04,479 --> 00:02:07,500
awareness almost always follows right after perception.

51
00:02:07,500 --> 00:02:09,481
So in this talk, I'm going to use those two terms

52
00:02:09,481 --> 00:02:10,321
interchangeably.

53
00:02:10,321 --> 00:02:10,381
OK.

54
00:02:10,381 --> 00:02:11,622
So the four models I'm going to talk about

55
00:02:11,622 --> 00:02:14,383
are visual, environmental, auditory,

56
00:02:14,383 --> 00:02:15,263
and social and contextual.

57
00:02:23,108 --> 00:02:24,830
with the two most common obviously

58
00:02:24,830 --> 00:02:26,232
being visual and auditory.

59
00:02:26,232 --> 00:02:28,434
So let's jump right in.

60
00:02:28,434 --> 00:02:29,555
So visual perception.

61
00:02:29,555 --> 00:02:33,419
So often, this is how we think about vision in games,

62
00:02:33,419 --> 00:02:35,260
the classic vision cone.

63
00:02:35,260 --> 00:02:37,583
And this does a decent job of modeling

64
00:02:37,583 --> 00:02:39,465
what's directly in front of the NPC

65
00:02:39,465 --> 00:02:42,087
and what he should detect pretty quickly.

66
00:02:42,087 --> 00:02:43,208
But it's not a great model.

67
00:02:43,208 --> 00:02:46,011
It doesn't do a good job of modeling peripheral vision.

68
00:02:46,011 --> 00:02:48,213
It doesn't really model vision at a distance very well.

69
00:02:50,175 --> 00:02:53,455
So this is vision in real life, right? This is how we see in

70
00:02:53,455 --> 00:02:57,976
real life. So we actually have close to like 180 degrees of

71
00:02:57,976 --> 00:03:00,777
vision, but as things move away from our focal point, we start

72
00:03:00,777 --> 00:03:02,857
to see them less and less clearly. This is vision in

73
00:03:02,857 --> 00:03:05,938
blacklist. So if I were you, I'd be thinking like, what the hell

74
00:03:05,938 --> 00:03:08,679
is all this crap, right? But honestly, all that stuff really

75
00:03:08,679 --> 00:03:10,519
is there for a reason. I'll describe a couple of things that

76
00:03:10,519 --> 00:03:13,460
you're seeing here. So first of all, we do actually have the

77
00:03:13,460 --> 00:03:16,640
standard vision cone, which is that orange V that I've marked

78
00:03:16,640 --> 00:03:19,701
out there. And this reflects the area where the NPC. So this is

79
00:03:20,037 --> 00:03:22,298
can see detail and should be able to spot the player

80
00:03:22,298 --> 00:03:22,798
pretty quickly.

81
00:03:22,798 --> 00:03:24,719
And we actually had multiple nested cones.

82
00:03:24,719 --> 00:03:26,620
So a player obviously would get spotted faster

83
00:03:26,620 --> 00:03:27,341
in the innermost cone.

84
00:03:27,341 --> 00:03:30,862
And then we also have those coffin-shaped boxes

85
00:03:30,862 --> 00:03:33,123
that you can see on the outside marked by those yellow lines.

86
00:03:33,123 --> 00:03:35,084
And this defines the entire area that the NPC

87
00:03:35,084 --> 00:03:36,625
should be able to see.

88
00:03:36,625 --> 00:03:38,486
What's interesting to note about these boxes

89
00:03:38,486 --> 00:03:41,347
is that as opposed to a cone that expands at a distance,

90
00:03:41,347 --> 00:03:43,088
they actually shrink at a distance, which

91
00:03:43,088 --> 00:03:44,769
models the fact that you'll still

92
00:03:44,769 --> 00:03:46,890
tend to notice things that are directly in front of you.

93
00:03:47,307 --> 00:03:50,388
even at a distance, but not necessarily the things

94
00:03:50,388 --> 00:03:51,489
that are off to the side.

95
00:03:51,489 --> 00:03:52,789
And these are also nested.

96
00:03:52,789 --> 00:03:54,589
And here we're displaying the outermost.

97
00:03:54,589 --> 00:03:56,230
And so for each of these, our designer

98
00:03:56,230 --> 00:03:58,711
had to specify how many nested shapes there were,

99
00:03:58,711 --> 00:04:01,792
their sizes, and the linear detection range for each,

100
00:04:01,792 --> 00:04:04,392
where the min of that range is the time to detect the player

101
00:04:04,392 --> 00:04:06,593
when he's closest to the NPC and the max,

102
00:04:06,593 --> 00:04:08,314
obviously, at the farthest.

103
00:04:08,314 --> 00:04:11,775
And our designer had to specify that per player stance,

104
00:04:11,775 --> 00:04:13,955
per difficulty, and per archetype.

105
00:04:13,955 --> 00:04:15,456
So that was a lot of fun for our designer.

106
00:04:16,271 --> 00:04:18,612
And then what happens at run time is these shapes get

107
00:04:18,612 --> 00:04:21,033
checked in order, and then the time range of the first

108
00:04:21,033 --> 00:04:22,914
inclusive shape is used.

109
00:04:22,914 --> 00:04:26,216
And there are also other shapes there that I've pointed

110
00:04:26,216 --> 00:04:28,877
one out, which is the peripheral vision shape.

111
00:04:28,877 --> 00:04:32,179
There's also those kind of wings that you can see in the

112
00:04:32,179 --> 00:04:33,560
back of the NPC, which is our sixth sense shape.

113
00:04:33,560 --> 00:04:34,500
I'm not going to talk about those, but you

114
00:04:34,500 --> 00:04:35,140
sort of get the idea.

115
00:04:35,140 --> 00:04:38,122
But obviously, being in a shape isn't enough to get

116
00:04:38,122 --> 00:04:38,642
detected, right?

117
00:04:38,642 --> 00:04:41,083
You have to be seen, in other words, unobstructed, and you

118
00:04:41,083 --> 00:04:41,463
have to be lit.

119
00:04:42,100 --> 00:04:43,201
And so what our detection model does

120
00:04:43,201 --> 00:04:45,443
is it recasts to eight different bones on the player's body,

121
00:04:45,443 --> 00:04:46,784
one per frame.

122
00:04:46,784 --> 00:04:47,985
And then depending on the stance,

123
00:04:47,985 --> 00:04:50,226
it takes more or less bones to be detected.

124
00:04:50,226 --> 00:04:54,530
So in this case, you can see Sam Fisher is in cover.

125
00:04:54,530 --> 00:04:56,651
And so that's the stance that actually takes the most bones.

126
00:04:56,651 --> 00:04:58,132
And here, there are only two bones

127
00:04:58,132 --> 00:04:59,353
that are visible to the NPC.

128
00:04:59,353 --> 00:05:01,035
So detection hasn't actually started yet.

129
00:05:01,035 --> 00:05:03,376
So then finally, once enough lit bones are seen,

130
00:05:03,376 --> 00:05:06,158
that's when the player starts getting detected, right?

131
00:05:06,158 --> 00:05:08,400
And so that's when that range-based timer kicks in.

132
00:05:08,400 --> 00:05:10,101
You can see it represented by that HUD, which

133
00:05:10,101 --> 00:05:11,062
is actually a growing arc.

134
00:05:11,595 --> 00:05:13,576
And the tuning of this timing and feedback

135
00:05:13,576 --> 00:05:14,817
is really critical to the player.

136
00:05:14,817 --> 00:05:17,359
This represents really his window of opportunity

137
00:05:17,359 --> 00:05:19,500
to break line of sight or maybe kill the NPC,

138
00:05:19,500 --> 00:05:21,922
otherwise he's going to get detected.

139
00:05:21,922 --> 00:05:23,663
So naturally, with a model this complex,

140
00:05:23,663 --> 00:05:25,545
we tuned it a couple times by eye,

141
00:05:25,545 --> 00:05:26,906
and then we were good to go.

142
00:05:26,906 --> 00:05:27,286
No, it was brutal.

143
00:05:27,286 --> 00:05:27,726
It was brutal.

144
00:05:27,726 --> 00:05:29,127
Tuning it was a nightmare.

145
00:05:29,127 --> 00:05:34,311
And actually, so what happened was our designer

146
00:05:34,311 --> 00:05:37,233
tweaked it until he thought it was fun.

147
00:05:37,687 --> 00:05:39,608
and our creative director thought it was fun.

148
00:05:39,608 --> 00:05:42,190
And then we went to play tests, and the results were awful.

149
00:05:42,190 --> 00:05:42,991
They were all over the place.

150
00:05:42,991 --> 00:05:45,093
Some people thought they were getting detected too fast,

151
00:05:45,093 --> 00:05:45,673
some too slow.

152
00:05:45,673 --> 00:05:49,516
So our designer combed through hours of play test video,

153
00:05:49,516 --> 00:05:51,658
and he identified three major issues that we had.

154
00:05:51,658 --> 00:05:55,441
So the first was that we had some special case code.

155
00:05:55,441 --> 00:05:56,962
So our designers wanted it that.

156
00:05:57,521 --> 00:06:00,062
In certain situations, if the player was in cover,

157
00:06:00,062 --> 00:06:02,543
the NPC would walk right by him without detecting him,

158
00:06:02,543 --> 00:06:04,184
even if our model said he should have been detected.

159
00:06:04,184 --> 00:06:06,845
This was actually fun in a lot of situations.

160
00:06:06,845 --> 00:06:08,605
But we found in the video that actually what

161
00:06:08,605 --> 00:06:11,646
was happening sometimes is that the NPC's flashlight would

162
00:06:11,646 --> 00:06:12,967
be lighting up the player at random,

163
00:06:12,967 --> 00:06:15,648
and then he still wouldn't be detecting him.

164
00:06:15,648 --> 00:06:17,449
So our solution to this, unfortunately,

165
00:06:17,449 --> 00:06:20,210
was just more special case code, which is essentially just

166
00:06:20,210 --> 00:06:22,751
if lit by flashlight, ignore the other code.

167
00:06:22,751 --> 00:06:24,992
So not necessarily our finest moment, but it worked.

168
00:06:27,518 --> 00:06:29,159
So the second issue that we found

169
00:06:29,159 --> 00:06:31,621
was that the players were getting detected too easily

170
00:06:31,621 --> 00:06:33,462
at a distance, and specifically at a distance

171
00:06:33,462 --> 00:06:36,183
when they weren't directly in front of the NPC.

172
00:06:36,183 --> 00:06:38,885
So obviously, this is what led to us changing.

173
00:06:38,885 --> 00:06:40,366
We originally just had regular boxes,

174
00:06:40,366 --> 00:06:42,047
and we changed them to these coffin-shaped boxes

175
00:06:42,047 --> 00:06:42,667
that I talked about.

176
00:06:44,444 --> 00:06:46,265
And the third thing was that we were finding that players

177
00:06:46,265 --> 00:06:49,226
were just getting, that it was actually too easy overall.

178
00:06:49,226 --> 00:06:51,806
So once we kind of got rid of those other issues,

179
00:06:51,806 --> 00:06:53,407
then actually the players found it too easy.

180
00:06:53,407 --> 00:06:56,288
And so the solution to that was that we just kept tweaking.

181
00:06:56,288 --> 00:06:58,468
And we literally did that till the end of the project.

182
00:06:58,468 --> 00:07:00,549
And what happened was that after every play test,

183
00:07:00,549 --> 00:07:02,390
the results started to converge,

184
00:07:02,390 --> 00:07:03,810
so that by the final play test,

185
00:07:03,810 --> 00:07:05,791
very few participants actually mentioned vision

186
00:07:05,791 --> 00:07:06,911
one way or the other.

187
00:07:06,911 --> 00:07:08,732
And the couple that did were sort of split on the issue.

188
00:07:08,732 --> 00:07:10,612
So we really kind of felt like we'd hit our sweet spot.

189
00:07:11,549 --> 00:07:13,471
So in the end, we were really happy with the results.

190
00:07:13,471 --> 00:07:14,972
But it wasn't easy getting there, obviously.

191
00:07:14,972 --> 00:07:17,494
And one thing we realized was that the players actually

192
00:07:17,494 --> 00:07:20,836
wanted a more sophisticated and less forgiving vision model

193
00:07:20,836 --> 00:07:22,738
than we had initially anticipated.

194
00:07:22,738 --> 00:07:24,880
And if I had to do it again, I'd probably

195
00:07:24,880 --> 00:07:26,901
try to playtest this a lot earlier than we did.

196
00:07:26,901 --> 00:07:28,322
So the second type of awareness I want to talk about

197
00:07:28,322 --> 00:07:34,387
is environmental awareness, which our illustrious mayor,

198
00:07:34,387 --> 00:07:37,149
Rob Ford, is doing a great job of displaying there.

199
00:07:38,589 --> 00:07:42,210
But for us, environmental awareness really means two things.

200
00:07:42,210 --> 00:07:45,692
So the first is being aware of the layout, right?

201
00:07:45,692 --> 00:07:48,093
So layout tells you stuff like, for example,

202
00:07:48,093 --> 00:07:49,913
I'm in a large room, it's connected to a hallway

203
00:07:49,913 --> 00:07:52,715
by two doors, or maybe if there was a window by a window.

204
00:07:52,715 --> 00:07:55,036
And then once you have that type of information,

205
00:07:55,036 --> 00:07:56,996
you can start reasoning about the player's location

206
00:07:56,996 --> 00:07:58,957
in interesting ways, right, with respect to the environment.

207
00:07:58,957 --> 00:08:00,618
So you can start thinking about stuff like

208
00:08:00,618 --> 00:08:03,259
he's hiding in a dead end, or he's sniping us

209
00:08:03,259 --> 00:08:04,700
from a rooftop that we can't get to,

210
00:08:04,700 --> 00:08:06,721
and I'll actually discuss that specific example

211
00:08:06,721 --> 00:08:07,541
a little bit later on.

212
00:08:08,060 --> 00:08:12,003
And then the second is awareness of objects, or more specifically, like, awareness to changes

213
00:08:12,003 --> 00:08:15,786
in objects, like a door that got opened or a light that got turned on or something like

214
00:08:15,786 --> 00:08:15,987
that.

215
00:08:22,832 --> 00:08:24,573
So why is this important for us?

216
00:08:24,573 --> 00:08:28,495
Well, one reason is that our encounters can start anywhere.

217
00:08:28,495 --> 00:08:30,636
So you could have literally stealthed your way

218
00:08:30,636 --> 00:08:31,877
through 3 quarters of the level.

219
00:08:31,877 --> 00:08:33,478
You get detected there, and that's

220
00:08:33,478 --> 00:08:34,378
where our encounter starts.

221
00:08:34,378 --> 00:08:37,320
So that's in contrast to a lot of more linear shooters

222
00:08:37,320 --> 00:08:38,861
where they can stage the encounters.

223
00:08:39,421 --> 00:08:42,123
But unlike a lot of stealth games,

224
00:08:42,123 --> 00:08:44,464
we didn't want being detected to be a failure condition.

225
00:08:44,464 --> 00:08:45,244
We wouldn't want you to reset.

226
00:08:45,244 --> 00:08:47,866
And in fact, we wanted you to then be able to play the game

227
00:08:47,866 --> 00:08:50,608
like a cover shooter with the added ability of being able

228
00:08:50,608 --> 00:08:53,469
to vanish or maybe outflank the NPCs

229
00:08:53,469 --> 00:08:56,131
and then recreate those initial stealth conditions.

230
00:08:56,131 --> 00:08:58,952
So older versions of Splinter Cell only supported a max

231
00:08:58,952 --> 00:09:00,053
of four active NPCs.

232
00:09:00,053 --> 00:09:02,054
So those guys always had something to do.

233
00:09:02,054 --> 00:09:03,915
And shooting actually wasn't really an option.

234
00:09:05,755 --> 00:09:07,396
But for us, in Conviction as well, we had 12 active NPCs.

235
00:09:07,396 --> 00:09:09,657
And the player can see them all the time.

236
00:09:09,657 --> 00:09:12,539
He has vision modes that he can use to see them through walls.

237
00:09:12,539 --> 00:09:14,920
He could outflank them during combat.

238
00:09:14,920 --> 00:09:17,301
So really, those guys need to be doing something intelligent

239
00:09:17,301 --> 00:09:18,882
all the time.

240
00:09:18,882 --> 00:09:20,382
And using the old system, which again, was just

241
00:09:20,382 --> 00:09:22,443
designed for four, and also all they were concerned with

242
00:09:22,443 --> 00:09:24,324
was getting line of sight on the player, what happened

243
00:09:24,324 --> 00:09:25,625
was a lot of times you just see NPCs

244
00:09:25,625 --> 00:09:27,926
that were staring at the player through walls, which obviously

245
00:09:27,926 --> 00:09:28,707
doesn't look intelligent.

246
00:09:30,864 --> 00:09:33,829
So on conviction, we developed a solution to this

247
00:09:33,829 --> 00:09:35,332
that we call the TEAS.

248
00:09:35,332 --> 00:09:37,515
It's a new AI model of the environment for us.

249
00:09:37,515 --> 00:09:40,120
So TEAS stands for Tactical Environment Awareness System.

250
00:09:42,167 --> 00:09:45,211
So what this consists of, it's essentially position nodes

251
00:09:45,211 --> 00:09:47,654
that are linked to other position nodes through choke nodes.

252
00:09:47,654 --> 00:09:48,895
And what that represents here is you

253
00:09:48,895 --> 00:09:51,238
can see that red position node that I've marked out,

254
00:09:51,238 --> 00:09:52,500
and it's above that blue area.

255
00:09:52,500 --> 00:09:55,163
And so what it says is that blue area is connected

256
00:09:55,163 --> 00:09:56,104
to that yellow area.

257
00:09:56,104 --> 00:09:57,385
You can't see the position node for that

258
00:09:57,385 --> 00:09:58,246
because it's inside the room.

259
00:09:58,246 --> 00:10:00,709
Through that green choke node, which represents the door.

260
00:10:01,290 --> 00:10:03,152
And so now, NPCs have a lot more info

261
00:10:03,152 --> 00:10:04,674
about the environment, right?

262
00:10:04,674 --> 00:10:06,836
And so, in the case where an NPC can't,

263
00:10:06,836 --> 00:10:09,579
or maybe even shouldn't, engage the player,

264
00:10:09,579 --> 00:10:12,722
he can now go ahead and guard the door, window,

265
00:10:12,722 --> 00:10:15,045
or whatever choke it is that's leading to the player,

266
00:10:15,045 --> 00:10:17,087
and that obviously produces much more believable behavior.

267
00:10:17,747 --> 00:10:18,988
And what's interesting about this,

268
00:10:18,988 --> 00:10:20,268
we actually auto-generated it.

269
00:10:20,268 --> 00:10:22,469
So the way it worked was our level designers

270
00:10:22,469 --> 00:10:23,549
would paint the nav mesh.

271
00:10:23,549 --> 00:10:26,010
So they'd paint the blue area and the yellow area.

272
00:10:26,010 --> 00:10:28,030
And then we'd auto-generate the position nodes and the choke

273
00:10:28,030 --> 00:10:28,771
nodes.

274
00:10:28,771 --> 00:10:30,591
But then we allowed the designers to manipulate them.

275
00:10:30,591 --> 00:10:32,692
And the reason for that was that we actually

276
00:10:32,692 --> 00:10:34,773
used them not just to identify the area that's

277
00:10:34,773 --> 00:10:36,653
directly below them, but they were actually fallback

278
00:10:36,653 --> 00:10:37,814
positions for our NPCs.

279
00:10:37,814 --> 00:10:39,794
So if they couldn't find a piece of cover

280
00:10:39,794 --> 00:10:41,615
that would give them a line of sight on the door,

281
00:10:41,615 --> 00:10:43,475
they knew they could always fall back to those position nodes.

282
00:10:43,475 --> 00:10:45,036
Like in this case, you can see the designer actually

283
00:10:45,036 --> 00:10:45,356
attached to it.

284
00:10:45,645 --> 00:10:48,446
a second position node to that choke node that I didn't mark.

285
00:10:48,446 --> 00:10:50,447
And we actually used the T's for tons of stuff

286
00:10:50,447 --> 00:10:51,808
other than just that.

287
00:10:51,808 --> 00:10:53,729
We used it for coordinating room entries.

288
00:10:53,729 --> 00:10:56,711
We did hierarchical pathfinding with it.

289
00:10:56,711 --> 00:10:59,352
And we even used it to calculate audio distance.

290
00:10:59,352 --> 00:11:00,232
And I'll talk about that in a second.

291
00:11:00,232 --> 00:11:02,514
And as I mentioned, the second thing

292
00:11:02,514 --> 00:11:05,975
is awareness of changes to objects in the environment.

293
00:11:05,975 --> 00:11:08,617
And we actually got a ton of mileage out of NPCs

294
00:11:08,617 --> 00:11:11,398
noticing things like open doors or windows.

295
00:11:11,398 --> 00:11:13,279
And to do this, we used a really simple system called

296
00:11:13,279 --> 00:11:14,340
the Changed Actor System.

297
00:11:14,340 --> 00:11:15,160
So the idea was that.

298
00:11:15,447 --> 00:11:16,868
when an actor would change state,

299
00:11:16,868 --> 00:11:18,549
it would create an event with a lifetime,

300
00:11:18,549 --> 00:11:20,930
and then the first NPC to witness that event

301
00:11:20,930 --> 00:11:23,251
would claim it, and then depending on his state

302
00:11:23,251 --> 00:11:24,831
and what was going on, it could prompt

303
00:11:24,831 --> 00:11:26,612
a minor investigation.

304
00:11:26,612 --> 00:11:27,953
And so, I mean, this could have been used

305
00:11:27,953 --> 00:11:30,334
tactically by the player, but really it was mostly there

306
00:11:30,334 --> 00:11:32,675
to give the impression of intelligence and awareness.

307
00:11:32,675 --> 00:11:34,055
And this was a really easy win for us,

308
00:11:34,055 --> 00:11:35,536
and it was actually something that was mentioned

309
00:11:35,536 --> 00:11:36,957
specifically in a couple of reviews.

310
00:11:37,563 --> 00:11:42,029
And it's kind of ironic, but not all that surprising that the tease was this long and

311
00:11:42,029 --> 00:11:46,114
complicated system to develop, but nobody mentioned the fact that our NPCs could guard

312
00:11:46,114 --> 00:11:50,580
doors, although they probably would have mentioned it if they were staring through walls.

313
00:11:50,580 --> 00:11:55,406
But as soon as the NPCs remarked that a door was opened, that's what people noticed.

314
00:11:55,406 --> 00:11:55,907
But yeah, that's okay.

315
00:11:58,681 --> 00:12:01,442
So the third type of perception is auditory.

316
00:12:01,442 --> 00:12:03,803
So in general, it's pretty simple, right?

317
00:12:03,803 --> 00:12:06,585
Every audio event has a distance and a priority.

318
00:12:06,585 --> 00:12:09,006
If an NPC is in range of that event, then they'll hear it.

319
00:12:09,006 --> 00:12:10,727
And they'll react differently based on the event,

320
00:12:10,727 --> 00:12:13,468
based on who else is in range, his current state, et cetera.

321
00:12:13,468 --> 00:12:15,949
We actually have two major issues with our audio events.

322
00:12:15,949 --> 00:12:18,090
So one was actually accurately calculating

323
00:12:18,090 --> 00:12:18,751
the audio distance.

324
00:12:18,751 --> 00:12:20,972
So obviously, the Euclidean straight line distance

325
00:12:20,972 --> 00:12:21,632
isn't good enough.

326
00:12:21,632 --> 00:12:22,633
In a stealth game, you don't want

327
00:12:22,633 --> 00:12:24,513
to be heard through walls and stuff like that.

328
00:12:25,269 --> 00:12:29,294
So we tried using our sound engine, but our sound engine wasn't actually optimized to calculate

329
00:12:29,294 --> 00:12:33,379
sort of uh... the distance between two random points in the world. And there was another issue as well

330
00:12:33,379 --> 00:12:34,340
which is that

331
00:12:34,340 --> 00:12:37,704
our audio data was often out of sync with our level data which caused all kinds of

332
00:12:37,704 --> 00:12:39,466
false positive bugs and stuff like that. So

333
00:12:39,466 --> 00:12:43,111
we started using the T's and the way that we did this was

334
00:12:44,219 --> 00:12:46,941
And the Ts could tell us sort of the room path,

335
00:12:46,941 --> 00:12:50,082
or like the path in rooms between the source

336
00:12:50,082 --> 00:12:54,185
and the destination, which would be where the NPC was.

337
00:12:54,185 --> 00:12:57,427
And then we just took the sum of the straight line distance.

338
00:12:57,427 --> 00:12:58,927
So in other words, it was the distance

339
00:12:58,927 --> 00:13:00,748
between sort of the source of the audio event

340
00:13:00,748 --> 00:13:03,390
to the closest choke node to the closest choke

341
00:13:03,390 --> 00:13:05,331
node of the room leading to the next node, et cetera,

342
00:13:05,331 --> 00:13:06,512
all the way to the NPC.

343
00:13:06,512 --> 00:13:09,553
And the results were actually accurate enough

344
00:13:09,553 --> 00:13:12,135
that once we made that switch, we never looked back.

345
00:13:12,135 --> 00:13:12,935
It worked really well for us.

346
00:13:15,860 --> 00:13:18,541
And the second problem with auditory events

347
00:13:18,541 --> 00:13:20,562
is it's really a general problem actually,

348
00:13:20,562 --> 00:13:22,543
which is that it can feel really unfair

349
00:13:22,543 --> 00:13:25,084
to sort of be creating sounds that get noticed

350
00:13:25,084 --> 00:13:26,844
by NPCs that you don't even see, right?

351
00:13:26,844 --> 00:13:28,605
A guy around the corner could potentially

352
00:13:28,605 --> 00:13:30,486
hear the sound that you make and you won't know why,

353
00:13:30,486 --> 00:13:32,367
and you may not even know that you made a sound, right?

354
00:13:32,367 --> 00:13:33,807
Because you don't really directly control

355
00:13:33,807 --> 00:13:35,088
the sounds that you're making.

356
00:13:35,088 --> 00:13:37,009
And so what would happen is,

357
00:13:37,009 --> 00:13:38,989
the way we found this was in internal reviews,

358
00:13:38,989 --> 00:13:41,631
our creative director, he'd be playing the game

359
00:13:41,631 --> 00:13:44,092
and then he'd get detected and he wouldn't know why

360
00:13:44,092 --> 00:13:45,392
and he'd check the controller and he'd.

361
00:13:45,992 --> 00:13:47,194
And he'd look at me.

362
00:13:47,194 --> 00:13:50,637
And sometimes, what we'd do is we'd pause the game,

363
00:13:50,637 --> 00:13:51,939
and we'd free camera on the corner.

364
00:13:51,939 --> 00:13:54,381
And we'd say, look, Max, there's the NPC,

365
00:13:54,381 --> 00:13:56,263
and here's where you were.

366
00:13:56,263 --> 00:13:57,785
And sometimes he'd agree.

367
00:13:57,785 --> 00:14:00,388
He'd be like, yeah, I guess it made sense that he heard me.

368
00:14:00,770 --> 00:14:02,592
But that didn't actually stop him from complaining

369
00:14:02,592 --> 00:14:04,133
the next time it happened.

370
00:14:04,133 --> 00:14:05,654
And ultimately, he was right.

371
00:14:05,654 --> 00:14:07,235
I mean, it's kind of irrelevant.

372
00:14:07,235 --> 00:14:08,416
The player can't pause the game.

373
00:14:08,416 --> 00:14:10,817
The player can't free cam through the level.

374
00:14:10,817 --> 00:14:12,438
And so one thing that we learned here,

375
00:14:12,438 --> 00:14:13,679
and also in tuning some visual stuff,

376
00:14:13,679 --> 00:14:16,221
is that it's really only important what's plausible

377
00:14:16,221 --> 00:14:17,422
from the player's point of view.

378
00:14:17,422 --> 00:14:19,763
It doesn't matter what the NPC can see or hear.

379
00:14:20,075 --> 00:14:21,716
sort of from a simulation perspective.

380
00:14:21,716 --> 00:14:24,157
It's what the player thinks the NPC should

381
00:14:24,157 --> 00:14:24,898
be able to see or hear.

382
00:14:24,898 --> 00:14:27,359
So I mean, one way that we could have solved this

383
00:14:27,359 --> 00:14:27,959
was like brute force.

384
00:14:27,959 --> 00:14:29,940
We could have just tuned down the distance

385
00:14:29,940 --> 00:14:30,761
of all of our audio events.

386
00:14:30,761 --> 00:14:33,942
But then that would create a bunch of other problems, right?

387
00:14:33,942 --> 00:14:35,423
Like you don't want to be kind of running down

388
00:14:35,423 --> 00:14:38,065
a hallway towards an NPC with his back turned,

389
00:14:38,065 --> 00:14:40,446
and then he can only hear you sort of at the last second

390
00:14:40,446 --> 00:14:43,327
and you'd stab him in the neck just as he's turning around.

391
00:14:44,362 --> 00:14:46,663
Because not only does that sort of make them feel dumb,

392
00:14:46,663 --> 00:14:48,524
but also it's game breaking, right?

393
00:14:48,524 --> 00:14:49,784
You just run through the entire game,

394
00:14:49,784 --> 00:14:51,545
stabbing everyone in the neck.

395
00:14:51,545 --> 00:14:53,666
So this was a big problem, right?

396
00:14:53,666 --> 00:14:54,926
I mean, if you think about it,

397
00:14:54,926 --> 00:14:57,968
for two NPCs at exactly the same distance from the player,

398
00:14:57,968 --> 00:15:01,509
it can feel fair to get detected by the guy that you can see

399
00:15:01,509 --> 00:15:03,030
and unfair to get detected by the guy

400
00:15:03,030 --> 00:15:04,370
who's right around the corner.

401
00:15:04,370 --> 00:15:07,552
So I mean, we considered having some HUD feedback for this,

402
00:15:07,552 --> 00:15:08,252
which might have helped,

403
00:15:08,252 --> 00:15:10,353
but I mean, design really wanted minimal HUD.

404
00:15:10,353 --> 00:15:11,893
So in the end, we solved this in two ways.

405
00:15:14,376 --> 00:15:17,257
So the first thing we did was that NPCs that are off screen

406
00:15:17,257 --> 00:15:18,697
and far enough away from the player

407
00:15:18,697 --> 00:15:22,238
that it's sort of plausible that they didn't hear

408
00:15:22,238 --> 00:15:24,979
had their hearing reduced by half for some events.

409
00:15:24,979 --> 00:15:27,480
And we actually applied this to some indirect visual events

410
00:15:27,480 --> 00:15:29,000
as well, like seeing an NPC get shot.

411
00:15:29,000 --> 00:15:32,921
And the result of this, that literally the game instantly

412
00:15:32,921 --> 00:15:36,402
became more fun and almost as important for me,

413
00:15:36,402 --> 00:15:38,343
our creative director stopped complaining.

414
00:15:38,343 --> 00:15:41,324
By the way, that image is not supposed

415
00:15:41,324 --> 00:15:42,644
to be our creative director complaining.

416
00:15:43,688 --> 00:15:45,328
That's an NPC you can't hear.

417
00:15:45,328 --> 00:15:47,909
And the second thing we did is we wanted to provide better

418
00:15:47,909 --> 00:15:49,689
feedback to the player.

419
00:15:49,689 --> 00:15:52,810
And we actually overhauled our entire bark system,

420
00:15:52,810 --> 00:15:56,210
our entire dialogue system on Blacklist.

421
00:15:56,210 --> 00:15:58,551
And because if the NPC calls out what he hears,

422
00:15:58,551 --> 00:16:01,471
if you're running and then you hear an NPC go, hey,

423
00:16:01,471 --> 00:16:03,932
I heard footsteps, then you instantly know what you did.

424
00:16:03,932 --> 00:16:05,712
But the problem is you obviously don't

425
00:16:05,712 --> 00:16:07,293
want to hear that line over and over again.

426
00:16:07,293 --> 00:16:07,933
It's pretty on the nose.

427
00:16:07,933 --> 00:16:11,033
And so what we did is we developed a three-tiered bark

428
00:16:11,033 --> 00:16:11,553
somewhere.

429
00:16:12,025 --> 00:16:14,606
the first tier were very specific,

430
00:16:14,606 --> 00:16:15,927
all the way down to the third tier

431
00:16:15,927 --> 00:16:17,448
that was much more generic.

432
00:16:17,448 --> 00:16:19,249
And then what we do is as we ran out of

433
00:16:19,249 --> 00:16:20,329
tier one barks to play,

434
00:16:20,329 --> 00:16:22,190
we dropped down to tier two and then tier three.

435
00:16:22,190 --> 00:16:24,511
And so the result was that as a player,

436
00:16:24,511 --> 00:16:26,552
you sort of got the specific feedback you needed

437
00:16:26,552 --> 00:16:28,273
the first couple times that you did something.

438
00:16:28,273 --> 00:16:29,533
And then, you know, like I said,

439
00:16:29,533 --> 00:16:31,334
as we ran out of those specific things,

440
00:16:31,334 --> 00:16:33,835
then we could give more generic barks back to the player.

441
00:16:36,726 --> 00:16:40,509
So the last type of awareness that I want to discuss

442
00:16:40,509 --> 00:16:42,411
is social and contextual.

443
00:16:42,411 --> 00:16:44,673
And this is something that actually a lot of action games

444
00:16:44,673 --> 00:16:45,393
don't model at all.

445
00:16:45,393 --> 00:16:46,794
So we did this for two reasons.

446
00:16:46,794 --> 00:16:51,458
So first of all, it makes the NPCs seem more intelligent

447
00:16:51,458 --> 00:16:53,420
and more aware, right?

448
00:16:53,420 --> 00:16:56,983
And in our game, you spend more time looking at the NPCs

449
00:16:56,983 --> 00:16:58,784
than you do in a lot of games.

450
00:16:58,784 --> 00:17:01,506
But we also use this system to create

451
00:17:01,506 --> 00:17:03,248
anti-exploits in the form of group behaviors.

452
00:17:03,248 --> 00:17:04,629
And I'll talk about that in a second.

453
00:17:05,450 --> 00:17:08,671
So specifically I'm going to give you two examples. Um, the

454
00:17:08,671 --> 00:17:13,833
first I'll talk about our conversation system, um, and in

455
00:17:13,833 --> 00:17:16,313
the second I'll show you one of our, uh, combat anti-exploit

456
00:17:16,313 --> 00:17:17,714
strategies. So in a lot of games if you interrupt two NPCs

457
00:17:17,714 --> 00:17:21,294
talking, um, it usually does one of two things. It either kind of

458
00:17:21,294 --> 00:17:24,815
completely breaks the conversation and those NPCs just

459
00:17:24,815 --> 00:17:28,976
kind of walk off on their own, or the conversation restarts

460
00:17:28,976 --> 00:17:32,277
somehow, but it, it feels pretty robotic. Um, so in our game when

461
00:17:32,277 --> 00:17:33,638
NPCs are in a conversation...

462
00:17:34,274 --> 00:17:35,436
they're actually in a group behavior.

463
00:17:35,436 --> 00:17:37,298
And so what that means is that they automatically

464
00:17:37,298 --> 00:17:38,280
become aware of each other.

465
00:17:38,280 --> 00:17:40,322
And that allows them to actually discuss

466
00:17:40,322 --> 00:17:41,444
minor events in context.

467
00:17:41,444 --> 00:17:46,751
So we had our narrative guy wrote specific reaction

468
00:17:46,751 --> 00:17:49,295
and breakout and rejoin lines for each conversation we had.

469
00:17:49,295 --> 00:17:50,957
And you'll hear that in a second.

470
00:17:51,166 --> 00:17:55,388
And also, you know, if one NPC stops talking or doesn't respond because he went to go investigate an event,

471
00:17:55,388 --> 00:18:00,130
the other is aware, so he'll, you know, maybe go and investigate the spot where he thinks his buddy should have been.

472
00:18:00,130 --> 00:18:03,891
And just those things really give the impression of social and contextual awareness.

473
00:18:03,891 --> 00:18:06,432
So here's a little video that demonstrates what I'm talking about.

474
00:18:06,432 --> 00:18:09,713
Hell of a night to be out here, isn't it?

475
00:18:09,713 --> 00:18:09,873
What?

476
00:18:09,873 --> 00:18:12,815
You get a little wet, you think you're gonna melt.

477
00:18:12,815 --> 00:18:13,795
It's slippery out here.

478
00:18:13,795 --> 00:18:16,736
A little wind, I'm taking flying lessons.

479
00:18:16,736 --> 00:18:17,696
I'll make sure to...

480
00:18:17,696 --> 00:18:18,717
I'm just kidding.

481
00:18:18,717 --> 00:18:20,578
Good boy. You made it happen.

482
00:18:28,101 --> 00:18:32,070
Make sure Sadiq and his last few family will be here.

483
00:18:32,070 --> 00:18:34,055
There he is again. Nowhere to run.

484
00:18:34,055 --> 00:18:35,960
Fine. I'll take a look.

485
00:19:07,855 --> 00:19:09,599
So yeah, we really like that.

486
00:19:09,599 --> 00:19:13,868
And so yeah, the last thing I want to talk about

487
00:19:13,868 --> 00:19:17,136
is the combat anti-exploit I was referring to.

488
00:19:17,963 --> 00:19:19,364
In this case, it's unreachable.

489
00:19:19,364 --> 00:19:21,585
So depending on where the player is

490
00:19:21,585 --> 00:19:24,565
and what the situation is, the AI may not be able to,

491
00:19:24,565 --> 00:19:26,826
or may not want to directly engage the player in combat.

492
00:19:26,826 --> 00:19:29,267
And in that case, we had group behaviors,

493
00:19:29,267 --> 00:19:31,588
which would play out as the situation unfolded,

494
00:19:31,588 --> 00:19:34,168
and specific dialogue lines that would give feedback

495
00:19:34,168 --> 00:19:35,969
to the player on what they were doing.

496
00:19:35,969 --> 00:19:37,009
But what's interesting to note,

497
00:19:37,009 --> 00:19:37,910
and what you'll hear in this video,

498
00:19:37,910 --> 00:19:39,550
is that those lines aren't just call-outs.

499
00:19:39,550 --> 00:19:41,151
They don't just announce, I'm throwing a grenade,

500
00:19:41,151 --> 00:19:42,251
or I'm flanking, or whatever,

501
00:19:42,251 --> 00:19:44,031
but they were actually discussions.

502
00:19:44,031 --> 00:19:45,072
So it didn't feel like the NPCs

503
00:19:45,072 --> 00:19:46,632
were just announcing what they were doing.

504
00:19:47,300 --> 00:19:48,961
but it felt like they were tactically coordinating.

505
00:19:48,961 --> 00:19:51,422
And this actually gave more interesting feedback

506
00:19:51,422 --> 00:19:51,843
to the player.

507
00:19:51,843 --> 00:19:54,364
So in this example, what you're going to see

508
00:19:54,364 --> 00:19:56,205
is the players ambushing the NPCs

509
00:19:56,205 --> 00:19:57,966
from an unreachable rooftop, which

510
00:19:57,966 --> 00:19:58,847
we know thanks to the Ts.

511
00:19:58,847 --> 00:20:01,388
And you can hear them call that out.

512
00:20:01,388 --> 00:20:03,930
And you can hear them coordinate a strategy to deal with that.

513
00:20:03,930 --> 00:20:07,052
And so the way we did this was, so first of all, like I said,

514
00:20:07,052 --> 00:20:09,373
we could identify the player was in an unreachable area.

515
00:20:10,610 --> 00:20:13,591
because we knew that the choke nodes that were leading to,

516
00:20:13,591 --> 00:20:15,472
like all the choke nodes that were leading to the player

517
00:20:15,472 --> 00:20:18,193
in Ts were non-crossable by NPCs.

518
00:20:18,193 --> 00:20:20,113
And also, I didn't mention it before,

519
00:20:20,113 --> 00:20:22,834
but we gave the LDs the power to sort of mark up

520
00:20:22,834 --> 00:20:24,215
those areas a bit more so we could know

521
00:20:24,215 --> 00:20:26,555
if he was on a small rooftop or a balcony or whatever.

522
00:20:26,555 --> 00:20:30,537
And then when we detected that scenario,

523
00:20:30,537 --> 00:20:33,398
we would kick off a contextual group behavior.

524
00:20:33,398 --> 00:20:36,238
And we actually had different varieties of those

525
00:20:36,238 --> 00:20:37,239
and variations within them.

526
00:20:37,239 --> 00:20:38,219
So for example, if this was,

527
00:20:38,397 --> 00:20:40,483
the second or third time that they'd seen the player

528
00:20:40,483 --> 00:20:41,165
in an area like this,

529
00:20:41,165 --> 00:20:43,752
they would have used the again version,

530
00:20:43,752 --> 00:20:46,439
which just had some dialogue substitution.

531
00:20:46,439 --> 00:20:46,980
So yeah, take a look.

532
00:21:15,584 --> 00:21:24,366
We can't get up there.

533
00:21:24,366 --> 00:21:24,666
Relax.

534
00:21:24,666 --> 00:21:25,186
We'll find him.

535
00:21:25,186 --> 00:21:26,986
He's still up there, right?

536
00:21:26,986 --> 00:21:27,406
He's not here anymore.

537
00:21:27,406 --> 00:21:27,847
Move out and find him.

538
00:21:27,847 --> 00:21:29,427
So and one thing that's interesting there is if,

539
00:21:29,427 --> 00:21:31,627
so here, there the player sort of tried to outflank the NPCs,

540
00:21:31,627 --> 00:21:31,787
right?

541
00:21:31,787 --> 00:21:32,848
And so that's what you saw.

542
00:21:32,848 --> 00:21:34,788
But if you would have started picking them off

543
00:21:34,788 --> 00:21:37,268
from that rooftop, that behavior would have branched

544
00:21:37,268 --> 00:21:39,149
into the retreat behavior, where one of those guys

545
00:21:39,149 --> 00:21:41,169
would have called out, you know, he's ambushing us and.

546
00:21:41,953 --> 00:21:45,254
um, um, started laying down suppressive fire while the other guys, uh, fell back to cover.

547
00:21:45,254 --> 00:21:49,556
And again, we, we were able to find good spots, kind of hiding spots for them, uh, also using

548
00:21:49,556 --> 00:21:57,359
the Ts. So, that is it. Just before, I just want to say thank you to everyone who came out to

549
00:21:57,359 --> 00:22:01,801
support from Ubisoft, to Nick, Zach, and Heather for helping me out with this presentation, to

550
00:22:01,801 --> 00:22:06,263
the whole AI team who made all this cool stuff, um, and everyone we worked really closely

551
00:22:06,263 --> 00:22:09,324
with, Laurent, Chris, Josh, and the entire Blacklist team. Thanks a lot.

552
00:22:19,066 --> 00:22:22,288
So yeah, I think I actually do have time for questions.

553
00:22:22,288 --> 00:22:23,710
I guess those videos said it all, huh?

554
00:22:23,710 --> 00:22:30,595
I have a question about the, here, over here, this side.

555
00:22:30,595 --> 00:22:30,955
Oh, wow.

556
00:22:30,955 --> 00:22:32,156
Great lights.

557
00:22:32,156 --> 00:22:34,778
Oh, there you go.

558
00:22:34,778 --> 00:22:39,922
The question about the coffin-shaped perception boxes.

559
00:22:39,922 --> 00:22:40,703
Yes.

560
00:22:40,703 --> 00:22:43,125
Did that help a lot in terms of if the player's

561
00:22:43,125 --> 00:22:45,767
on a different level, he doesn't expect to be perceived,

562
00:22:45,767 --> 00:22:47,688
or if he's climbing onto something?

563
00:22:48,462 --> 00:22:49,303
So that's a really good point.

564
00:22:49,303 --> 00:22:50,865
Yeah, I didn't mention that, but yeah,

565
00:22:50,865 --> 00:22:52,527
like you saw those boxes were capped at the top.

566
00:22:52,527 --> 00:22:53,308
That was exactly it.

567
00:22:53,308 --> 00:22:56,352
And that was actually a metric that was sort of used

568
00:22:56,352 --> 00:22:58,054
by level design so that when they would put pipes

569
00:22:58,054 --> 00:22:59,275
across the ceiling and stuff like that,

570
00:22:59,275 --> 00:23:00,397
they had to make sure that those pipes

571
00:23:00,397 --> 00:23:01,718
were outside of that box.

572
00:23:01,718 --> 00:23:02,439
Yeah, absolutely.

573
00:23:02,439 --> 00:23:02,660
Thanks.

574
00:23:04,000 --> 00:23:09,943
So when you have these cooperative tactics like flanking and covering fire and things like that,

575
00:23:09,943 --> 00:23:15,246
who's making the decisions to choose those tactics? Who's like giving commands to those

576
00:23:15,246 --> 00:23:19,869
characters? Is there like a leader follower relationship? Is there a centralized AI that

577
00:23:19,869 --> 00:23:24,811
does that? So we have, yeah, we have essentially a director, an AI manager essentially that would

578
00:23:24,811 --> 00:23:26,152
detect those scenarios and then...

579
00:23:26,692 --> 00:23:31,354
essentially kick off those behaviors and we would elect, so some of those scenarios did

580
00:23:31,354 --> 00:23:36,277
have leaders, but we would elect those leaders on the fly essentially, but we would prioritize

581
00:23:36,277 --> 00:23:36,857
certain archetypes.

582
00:23:36,857 --> 00:23:39,879
You didn't see it there, but we had, for example, a heavy archetype, so if a heavy archetype

583
00:23:39,879 --> 00:23:41,900
was present, he would become the leader of that group.

584
00:23:45,102 --> 00:23:47,784
Hi, so good talk, first of all.

585
00:23:47,784 --> 00:23:51,286
One thing is, did you think that balancing the perception,

586
00:23:51,286 --> 00:23:54,147
because you said that you had some kind of balancing

587
00:23:54,147 --> 00:23:56,648
on the different difficulty level for the game?

588
00:23:56,648 --> 00:23:57,009
Yes.

589
00:23:57,009 --> 00:24:01,471
So is that enough for giving a good experience to the user?

590
00:24:01,471 --> 00:24:04,973
Because sometimes, if you play an easy game mode,

591
00:24:04,973 --> 00:24:06,954
then you will get a really different experience

592
00:24:06,954 --> 00:24:08,955
for who plays the heavy one.

593
00:24:08,955 --> 00:24:11,436
But you get an experience different from their behavior

594
00:24:11,436 --> 00:24:13,538
side, and not only from the fact that the game is

595
00:24:13,538 --> 00:24:14,298
simpler or harder.

596
00:24:15,146 --> 00:24:17,627
It's true, and I mean it's a tough balance, right?

597
00:24:17,627 --> 00:24:21,949
So yeah, you don't want to like completely nerf the AI for, you know, in low difficulty.

598
00:24:21,949 --> 00:24:22,669
Yeah, absolutely.

599
00:24:22,669 --> 00:24:28,392
It's a tough balance to, it's tough to balance difficulty during stealth,

600
00:24:28,392 --> 00:24:30,953
like overall combat balancing is a lot easier, I think.

601
00:24:30,953 --> 00:24:31,733
So yeah, it's.

602
00:24:32,159 --> 00:24:33,720
I don't have a good answer, sorry.

603
00:24:33,720 --> 00:24:37,141
But it's more like, how much did you leave to the level

604
00:24:37,141 --> 00:24:39,661
designer or the game designer to balance?

605
00:24:39,661 --> 00:24:42,422
Was it a bit less control to them

606
00:24:42,422 --> 00:24:44,223
to avoid that they were nothing to watch the AI?

607
00:24:44,223 --> 00:24:45,723
We gave them a lot of control.

608
00:24:45,723 --> 00:24:49,064
But I mean, we work really closely with our,

609
00:24:49,064 --> 00:24:51,785
the AI designer is with us, and our lead designer

610
00:24:51,785 --> 00:24:52,925
was always with us.

611
00:24:52,925 --> 00:24:55,546
I don't know if you've been to any of the AI summit.

612
00:24:55,546 --> 00:24:58,067
Sounds like there's this big divide between.

613
00:24:58,892 --> 00:25:00,212
design and programming sometimes.

614
00:25:00,212 --> 00:25:00,933
But for us, it's not.

615
00:25:00,933 --> 00:25:03,414
We're really one big team, and so we work together.

616
00:25:03,414 --> 00:25:05,575
They're not going to do anything that's

617
00:25:05,575 --> 00:25:07,516
going to make our guys look stupid, basically.

618
00:25:07,516 --> 00:25:08,236
Thanks a lot.

619
00:25:08,236 --> 00:25:09,597
Thanks.

620
00:25:09,597 --> 00:25:11,778
Question on the perception again.

621
00:25:11,778 --> 00:25:14,099
With regards to those coffins, did you

622
00:25:14,099 --> 00:25:16,920
link that to any kind of bone on the NPCs,

623
00:25:16,920 --> 00:25:19,041
in terms of if they were looking,

624
00:25:19,041 --> 00:25:22,263
or was that completely based on facing angle or the root node?

625
00:25:22,760 --> 00:25:23,680
So that's a great question.

626
00:25:23,680 --> 00:25:28,722
We actually did some kind of complicated stuff for that.

627
00:25:28,722 --> 00:25:33,024
So when they're in idle, we actually linked it

628
00:25:33,024 --> 00:25:33,784
to the facing.

629
00:25:33,784 --> 00:25:34,684
And the reason we did that was we

630
00:25:34,684 --> 00:25:37,546
wanted to give some ability to the animators

631
00:25:37,546 --> 00:25:39,426
to create some kind of cool idle animations

632
00:25:39,426 --> 00:25:40,207
without kind of like.

633
00:25:40,500 --> 00:25:42,721
you know, it sucks if you're kind of sneaking up on an NPC

634
00:25:42,721 --> 00:25:45,161
and the guy turns to sneeze and because he did that,

635
00:25:45,161 --> 00:25:45,942
you get detected, right?

636
00:25:45,942 --> 00:25:48,723
Whereas when they were in search and in combat,

637
00:25:48,723 --> 00:25:50,303
where their sort of facing was a lot more,

638
00:25:50,303 --> 00:25:53,024
or sorry, their head look was a lot more deliberate,

639
00:25:53,024 --> 00:25:56,165
then it was linked directly to the head look.

640
00:25:56,165 --> 00:25:59,727
So, for example, to touch back on what Alex asked earlier,

641
00:25:59,727 --> 00:26:03,308
if they were going upstairs or if they were looking up,

642
00:26:03,308 --> 00:26:05,329
then the entire thing would tilt with them, basically.

643
00:26:05,329 --> 00:26:06,089
Thanks.

644
00:26:06,089 --> 00:26:07,690
Sorry, I think there was someone over there waiting.

645
00:26:08,144 --> 00:26:13,085
Yeah, just a quick question regarding using the Ts for audio.

646
00:26:13,085 --> 00:26:13,665
Yes.

647
00:26:13,665 --> 00:26:17,866
I'm just curious, did that thing exist beforehand?

648
00:26:17,866 --> 00:26:22,727
I was curious if you could have done the same with maybe like a, what do you call this?

649
00:26:22,727 --> 00:26:23,087
Pathfind?

650
00:26:23,087 --> 00:26:24,407
A pathfind function, basically.

651
00:26:24,407 --> 00:26:27,528
Well, but the problem with pathfind is you need navmesh, right?

652
00:26:27,528 --> 00:26:32,609
So then if you want to know if one guy in a balcony hears another guy in a balcony,

653
00:26:32,609 --> 00:26:35,590
you don't actually want the pathfind distance, you want some other distance.

654
00:26:35,590 --> 00:26:35,770
Right.

655
00:26:36,278 --> 00:26:39,221
So for us, any two areas that were linked,

656
00:26:39,221 --> 00:26:42,984
whether it was sort of walkably or visually,

657
00:26:42,984 --> 00:26:44,946
those were all linked in that way that you saw.

658
00:26:44,946 --> 00:26:48,309
So there it was a door, but I sort of briefly mentioned

659
00:26:48,309 --> 00:26:50,611
that when Sam was on the rooftop, we knew that,

660
00:26:50,611 --> 00:26:53,573
and we knew it was unreachable because all of the nodes

661
00:26:53,573 --> 00:26:55,255
that were linked to him were non-walkable.

662
00:26:55,255 --> 00:26:56,896
There was a teased node up there.

663
00:26:56,896 --> 00:26:57,076
Exactly.

664
00:26:58,643 --> 00:27:01,224
Yeah, just about the difficulty balancing.

665
00:27:01,224 --> 00:27:03,145
Did you actually change the distances

666
00:27:03,145 --> 00:27:05,565
and the shapes of those objects, or did you

667
00:27:05,565 --> 00:27:08,726
more like balance the time that it takes to actually detect?

668
00:27:08,726 --> 00:27:09,406
Everything.

669
00:27:09,406 --> 00:27:10,006
OK, excellent.

670
00:27:10,006 --> 00:27:10,206
Thanks.

671
00:27:10,206 --> 00:27:12,927
I had a quick question following up about the T's.

672
00:27:12,927 --> 00:27:18,769
So let's say when Sam was up on the rooftop

673
00:27:18,769 --> 00:27:22,389
and he would make a pretty significant noise,

674
00:27:22,389 --> 00:27:24,170
would the AI not really be able to hear him

675
00:27:24,170 --> 00:27:25,710
because the T's were not connected?

676
00:27:26,093 --> 00:27:32,260
No, no, that's it. It was connected, right? So like I said, it was connected, but the choke node that connected it was non-walkable.

677
00:27:32,260 --> 00:27:38,528
But they did that mattered for the NPCs to know that they couldn't get up there, but it was still linked through T's essentially.

678
00:27:44,355 --> 00:27:53,138
Speaking of noise and detection and stuff like that, I noticed in one of your screenshots, Sam was crouching next to what looked like an air conditioner or something like that.

679
00:27:53,138 --> 00:27:59,841
Did you model the noise that he was making with ambient noise as well?

680
00:27:59,841 --> 00:28:07,385
So there's a relative thing, you know, if you're in the middle of a factory or crouching next to, or you had your rainstorm, for example.

681
00:28:07,385 --> 00:28:10,066
Was there different thresholds of noise?

682
00:28:11,180 --> 00:28:16,963
that we considered doing but we didn't actually do it. We had a

683
00:28:16,963 --> 00:28:21,005
couple of areas in the game where we did some special stuff

684
00:28:21,005 --> 00:28:23,406
for that but it wasn't a generic thing that we did. Oh, did you

685
00:28:23,406 --> 00:28:26,788
want me to make that announcement for you? So I have a

686
00:28:26,788 --> 00:28:29,569
special announcement from Dave. I don't know if Aaron canary is

687
00:28:29,569 --> 00:28:38,794
here but Dave has your laptop charger. Should have come. Hey.

688
00:28:41,948 --> 00:28:44,290
if you had any kind of, when one AI actually found the player,

689
00:28:44,290 --> 00:28:50,093
if there was any other system that actually sent

690
00:28:50,093 --> 00:28:53,236
that awareness or perception to the other AIs,

691
00:28:53,236 --> 00:28:55,837
or if they all immediately knew about it?

692
00:28:55,837 --> 00:28:58,079
No, I mean, we had to propagate explicitly, right?

693
00:28:58,079 --> 00:29:00,500
So the idea was that if you, yeah,

694
00:29:00,500 --> 00:29:01,521
I didn't actually talk about that.

695
00:29:01,521 --> 00:29:04,403
But the idea is that even once you got detected,

696
00:29:04,403 --> 00:29:06,164
you were only detected by that single NPC.

697
00:29:06,164 --> 00:29:08,506
And he had to propagate that detection somehow

698
00:29:08,506 --> 00:29:09,206
to all of his buddies.

699
00:29:09,206 --> 00:29:11,428
Either by gunfire or by yelling, basically.

700
00:29:11,754 --> 00:29:16,977
So was there, would they have to, would they talk to each other? Would they have any kind of

701
00:29:16,977 --> 00:29:22,281
bonus to find Sam now that someone has seen him and is engaged? Or are they all basically

702
00:29:22,281 --> 00:29:29,707
stuck in the same awareness routine that they were already in?

703
00:29:29,707 --> 00:29:32,869
I'm not sure I completely understand the question but basically what would happen is, you

704
00:29:32,869 --> 00:29:36,992
know, it would, it would, so, so, you know, let's say all of the NPCs are in idle because

705
00:29:36,992 --> 00:29:39,454
nothing's happened yet. And then, you know,

706
00:29:39,875 --> 00:29:43,757
the, the, one of them spots Sam and he starts firing, then

707
00:29:43,757 --> 00:29:47,598
because another NPC heard gunfire, that would then

708
00:29:47,598 --> 00:29:50,360
transition him into combat essentially. And then he would

709
00:29:50,360 --> 00:29:52,301
be in combat against the player and then, you know, like I

710
00:29:52,301 --> 00:29:54,442
mentioned earlier, if you were able to outflank them and

711
00:29:54,442 --> 00:29:56,943
disappear, they would sort of go back and start searching for

712
00:29:56,943 --> 00:29:57,003
you.

713
00:29:57,003 --> 00:29:58,164
So, uh, kind of a follow up on that one. Uh, how much

714
00:30:06,250 --> 00:30:12,233
how much did AI's behavior change if they knew that your character was there?

715
00:30:12,233 --> 00:30:16,996
Because, yeah, I was wondering because there's a lot of games that it's like,

716
00:30:16,996 --> 00:30:20,437
and the one I think of immediately because I've been playing it the most recently is Skyrim,

717
00:30:20,437 --> 00:30:21,638
where it's, oh, that was just the wind.

718
00:30:21,638 --> 00:30:24,359
You've got a dead body right next to you.

719
00:30:24,359 --> 00:30:26,140
Clearly it was just the wind.

720
00:30:26,140 --> 00:30:28,321
Yeah, that's a really good question.

721
00:30:28,321 --> 00:30:30,302
Yeah, we did a lot for that, actually.

722
00:30:30,302 --> 00:30:33,223
So, first of all, we never, ever let them return to sort of pure idle.

723
00:30:33,597 --> 00:30:37,420
you wouldn't be in a gunfight one second and then munching on a sandwich or whatever the next

724
00:30:37,420 --> 00:30:43,345
second. But the other thing, we actually had a difference between sort of pre-combat and

725
00:30:43,345 --> 00:30:47,349
post-combat search. So in that one slide where I talked about barks, there was this weird

726
00:30:47,349 --> 00:30:51,792
screenshot that probably nobody got, but that was a piece of our entire barks matrix. It was this

727
00:30:51,792 --> 00:30:55,936
huge kind of table that had all that stuff in there. So our narrative guys did a fantastic job

728
00:30:55,936 --> 00:31:00,359
with that. And basically, yeah, it altered their behavior so they would investigate

729
00:31:00,359 --> 00:31:00,640
differently.

730
00:31:00,929 --> 00:31:04,253
and altered their dialogue. So there was a difference between, you know, like, like,

731
00:31:04,253 --> 00:31:07,677
we think someone's here, you know, he's made some, something's made a bunch of noise and

732
00:31:07,677 --> 00:31:11,922
we're looking around versus there's a pile of bodies or we, you know, there's a, we've

733
00:31:11,922 --> 00:31:13,945
just been in a gunfight. So yeah, absolutely. We took that.

734
00:31:13,945 --> 00:31:15,827
So there were several stages of...

735
00:31:16,848 --> 00:31:21,174
we don't think, you know, nothing's here to, there might be something here to, we know

736
00:31:21,174 --> 00:31:26,280
there's something here to, there's something here that's trying to kill us. That would

737
00:31:26,280 --> 00:31:29,604
change it. Yeah, even to there was something trying to kill us and now we don't know where

738
00:31:29,604 --> 00:31:31,407
it is. Yeah, absolutely. Okay. Cool. Alright, that's it. Thanks a lot guys.

