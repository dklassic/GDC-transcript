1
00:00:07,526 --> 00:00:10,949
So, uh, hi, my name's Ryan Duffin, as you can see.

2
00:00:11,350 --> 00:00:13,031
I'm an animation lead at DICE LA.

3
00:00:13,872 --> 00:00:16,114
I know this is a very competitive time slot.

4
00:00:16,514 --> 00:00:17,895
Excuse me, sorry.

5
00:00:17,996 --> 00:00:20,338
And I do appreciate you all choosing to be here.

6
00:00:21,661 --> 00:00:23,301
This talk was officially named before it was written,

7
00:00:23,842 --> 00:00:25,942
and it named drops as appropriate,

8
00:00:26,222 --> 00:00:28,563
but as the talk started to coalesce,

9
00:00:29,083 --> 00:00:31,104
I found this title more appropriate.

10
00:00:32,244 --> 00:00:33,804
There are so many things that we don't do in games

11
00:00:33,884 --> 00:00:35,925
because we're so far from them being easy,

12
00:00:36,785 --> 00:00:38,666
but we made our tools and systems so flexible

13
00:00:38,686 --> 00:00:40,626
that I ran out of excuses to not go crazy.

14
00:00:41,467 --> 00:00:43,247
So this is gonna be a story about my descent

15
00:00:43,367 --> 00:00:45,868
into perfectionist madness with a lot of video examples.

16
00:00:47,991 --> 00:00:52,295
A little bit more about me, I've been working in games since 2001, most notably worked on

17
00:00:52,375 --> 00:00:56,938
Spider-Man 2, Killzone 2, Alan Wake, and a bunch of other stuff here.

18
00:00:57,218 --> 00:00:59,220
Green Lantern movie, I hope you all saw that one.

19
00:01:00,721 --> 00:01:05,765
I've been working at DICE since Battlefield 3, then on Battlefield 4, most recently Battlefield 1.

20
00:01:06,846 --> 00:01:10,729
I do a lot of different things at DICE, but First Person has, for the last six years,

21
00:01:10,769 --> 00:01:12,931
been the most measurable output of my work.

22
00:01:14,689 --> 00:01:19,172
I've spoken at GDC a few times before, at the Animation Bootcamp, since the beginning.

23
00:01:20,032 --> 00:01:23,234
If you're going to go back and watch any of these, I'd recommend the 2016 one, because

24
00:01:23,294 --> 00:01:23,975
it's the shortest.

25
00:01:26,537 --> 00:01:30,439
But I think it's also my most important message, if I was a broken record, this would be the

26
00:01:30,459 --> 00:01:31,240
thing that I say the most.

27
00:01:31,300 --> 00:01:36,043
It's about caring about the details as much as the biggest fan of your game, and not just

28
00:01:36,083 --> 00:01:37,464
necessarily as much as you do.

29
00:01:37,504 --> 00:01:39,626
It's very bright up here.

30
00:01:42,995 --> 00:01:45,016
That's an important frame to view this talk through,

31
00:01:45,216 --> 00:01:47,257
because I'm going to show you a shit ton of details

32
00:01:47,277 --> 00:01:49,498
that you might have a hard time convincing some people

33
00:01:49,558 --> 00:01:50,819
the importance of.

34
00:01:52,600 --> 00:01:53,880
I've just decided to roll with the fact

35
00:01:53,900 --> 00:01:55,941
that I'm bad at naming talks and aspire

36
00:01:55,961 --> 00:01:57,542
to double down in the future until it just doesn't

37
00:01:57,582 --> 00:01:58,723
fit on the slide anymore.

38
00:02:00,163 --> 00:02:01,904
So I'm not a technical animator, but maybe more

39
00:02:01,924 --> 00:02:03,265
of an animator technically.

40
00:02:03,305 --> 00:02:04,985
That's always a fun conversation.

41
00:02:05,746 --> 00:02:07,667
To me, tech animation has become a word so broad

42
00:02:07,687 --> 00:02:08,687
that it's lost its meaning.

43
00:02:10,256 --> 00:02:13,437
I'm not here to talk today about animating in the way that some of you might think.

44
00:02:14,517 --> 00:02:16,197
Anybody who knows me has probably heard me say this.

45
00:02:16,257 --> 00:02:20,198
My belief is that a good gameplay animator animates in the engine, not in the content

46
00:02:20,218 --> 00:02:20,778
creation tools.

47
00:02:20,838 --> 00:02:22,939
And every year, more and more of you seem to agree with me.

48
00:02:23,419 --> 00:02:26,439
And I'm sure that came from me agreeing with somebody else before who was smarter than

49
00:02:26,459 --> 00:02:26,539
me.

50
00:02:27,720 --> 00:02:32,461
This will be a talk about the advantages of data-driven systems creating forward-thinking

51
00:02:32,501 --> 00:02:34,121
solutions to specific problems.

52
00:02:35,420 --> 00:02:37,921
and then the kind of crazy shit that your content creators will be able to do

53
00:02:38,602 --> 00:02:39,082
if you let them.

54
00:02:39,703 --> 00:02:43,345
And when I put it in bullet points like this, it does sound boring, but this talk

55
00:02:43,365 --> 00:02:45,106
will be pretty much nothing but examples.

56
00:02:46,719 --> 00:02:49,141
So, I work on Battlefield games, as you know,

57
00:02:50,182 --> 00:02:53,125
but this is not a talk, you don't have to care about guns,

58
00:02:53,265 --> 00:02:55,268
or war, or horses, or even Battlefield

59
00:02:55,308 --> 00:02:56,249
to get something out of this.

60
00:02:56,789 --> 00:02:58,531
My examples are soldiers and weapons

61
00:02:58,611 --> 00:02:59,752
because I work on a war game.

62
00:03:00,513 --> 00:03:02,515
But you didn't need to care about this stuff specifically

63
00:03:02,695 --> 00:03:03,636
to get something out of this talk.

64
00:03:04,477 --> 00:03:06,880
I'm gonna try my best to not assume too much familiarity

65
00:03:06,900 --> 00:03:08,581
with the Battlefield franchise and the process,

66
00:03:08,641 --> 00:03:09,723
so you can all follow along.

67
00:03:11,546 --> 00:03:16,671
This is the stuff that I care about and that I want you to care about and hopefully that this will inform the talk.

68
00:03:19,093 --> 00:03:24,638
That said, the examples that I'm going to show are in two sections. One, guns, and one, horses.

69
00:03:26,600 --> 00:03:30,965
To set this up a little bit better, Dice LA, the studio where I've worked since its inception, did

70
00:03:32,498 --> 00:03:33,159
That's not the right word.

71
00:03:33,519 --> 00:03:36,640
But did three of the five expansions for Battlefield 4.

72
00:03:37,580 --> 00:03:40,301
DICE LA was involved in the last nine months of Battlefield 1,

73
00:03:40,461 --> 00:03:43,161
including two of the six single-player stories,

74
00:03:43,221 --> 00:03:44,482
and then some of the multiplayer weapons.

75
00:03:45,262 --> 00:03:46,802
Contrary to some perceptions, DICE LA

76
00:03:46,822 --> 00:03:48,023
is not only a support studio.

77
00:03:48,043 --> 00:03:49,103
We do have other things cooking.

78
00:03:49,523 --> 00:03:50,843
This is just the part that I work on.

79
00:03:51,844 --> 00:03:54,304
We have taken over the life service aspect of Battlefield 4

80
00:03:54,544 --> 00:03:55,145
and Battlefield 1.

81
00:03:55,445 --> 00:03:57,125
So there's some unique challenges

82
00:03:57,205 --> 00:03:59,166
to building on the back of what's essentially

83
00:03:59,206 --> 00:03:59,906
someone else's game.

84
00:04:01,947 --> 00:04:05,409
Being creative in this situation isn't as hard or as bad as you might think.

85
00:04:06,330 --> 00:04:08,131
We had a lot of say in what we include and what we don't.

86
00:04:08,451 --> 00:04:11,572
You don't necessarily chart the course, but you can steer the ship.

87
00:04:15,254 --> 00:04:17,636
On the technical side, taking over a game can be tricky.

88
00:04:18,536 --> 00:04:21,438
To put it crassly, post-launch can be a bit like dumpster diving.

89
00:04:22,565 --> 00:04:25,987
The team that wrote this stuff that you need has already shipped and they're already on

90
00:04:26,027 --> 00:04:27,868
vacation or they're busy on the next project.

91
00:04:28,648 --> 00:04:31,870
You often get stuck doing asset archaeology and trying to figure out the previous team's

92
00:04:31,890 --> 00:04:35,912
intent, assuming good intent is always important in these situations.

93
00:04:36,732 --> 00:04:40,554
You can curse lack of documentation like you can curse the weather, but it doesn't take

94
00:04:40,574 --> 00:04:43,776
too many productions to understand how your confluence page gets out of date.

95
00:04:45,617 --> 00:04:49,579
On top of that, there's a small matter that whatever you ship is set in stone in the old

96
00:04:49,679 --> 00:04:51,199
ways of game development.

97
00:04:52,117 --> 00:04:55,839
Now your bugs or your pet features may linger forever as I can fix this.

98
00:04:57,259 --> 00:05:00,081
In fact, there are things in Battlefield 1 that are now fixed in the live game because

99
00:05:00,141 --> 00:05:02,262
I found them while putting together this talk.

100
00:05:03,163 --> 00:05:06,785
Balancing new content with fixing or tweaking the old is always tricky.

101
00:05:08,648 --> 00:05:12,829
So, animators at Dice work pretty technically with Ant, our proprietary animation software.

102
00:05:13,429 --> 00:05:17,510
I can't show you that, but the important thing is that it lets animators do a lot of crazy

103
00:05:17,550 --> 00:05:19,131
stuff without having to ask for code support.

104
00:05:19,491 --> 00:05:22,852
We're very empowered in EA with our animation tools for animators.

105
00:05:23,472 --> 00:05:26,113
That is not to downplay the awesome engineers who have our backs.

106
00:05:26,253 --> 00:05:29,213
I had help through all this, and I couldn't have done it without them building the tools

107
00:05:29,233 --> 00:05:29,473
first.

108
00:05:30,234 --> 00:05:33,655
But lots of the solutions I'm about to show were possible because I was empowered by my

109
00:05:33,695 --> 00:05:33,935
tools.

110
00:05:35,645 --> 00:05:38,128
And I'm not talking about Ant to brag about EA or Frostbite.

111
00:05:38,649 --> 00:05:39,971
I'm just suggesting that you push for tools

112
00:05:39,991 --> 00:05:41,613
that allow you to do more without asking

113
00:05:41,653 --> 00:05:42,674
for other people to support you.

114
00:05:43,836 --> 00:05:45,398
Most of what I'm about to show wouldn't have happened

115
00:05:45,538 --> 00:05:47,121
if I had to convince somebody else

116
00:05:47,241 --> 00:05:48,843
that it was important at every step of the way.

117
00:05:49,764 --> 00:05:51,707
So let's get started with the actual examples.

118
00:05:53,522 --> 00:05:57,646
DICE LA's history of repurposing things is most easily traced back to Battlefield 4 with

119
00:05:57,706 --> 00:06:02,791
our shield and bow, which I've talked about publicly at GDC in 2014, and the bow a bit

120
00:06:02,972 --> 00:06:04,493
at Consul in Norway last year.

121
00:06:04,513 --> 00:06:07,957
I actually had a whole segment on this, but the talk was an hour and a half with that,

122
00:06:08,057 --> 00:06:09,278
so I'm going to skip all that.

123
00:06:09,799 --> 00:06:11,941
What we're really here to talk about is Battlefield 1.

124
00:06:14,480 --> 00:06:16,942
So this isn't a first-person talk or a gun talk,

125
00:06:17,403 --> 00:06:18,424
but I wanna frame the rest of this

126
00:06:18,444 --> 00:06:20,806
with a little more of my philosophy on the subject

127
00:06:20,826 --> 00:06:22,007
and why pushing the bar here matters.

128
00:06:22,967 --> 00:06:24,829
The Overwatch animators get to infuse character

129
00:06:24,909 --> 00:06:26,170
to their first-person animations.

130
00:06:26,290 --> 00:06:27,912
Genji is Genji, Mercy is Mercy.

131
00:06:28,672 --> 00:06:30,173
We unfortunately don't have that luxury.

132
00:06:30,553 --> 00:06:32,113
Our soldiers have to be pretty generic.

133
00:06:32,793 --> 00:06:35,674
The kind of gun, the gun kind of has to be the character.

134
00:06:36,474 --> 00:06:38,075
Thankfully for the era of Battlefield 1,

135
00:06:38,475 --> 00:06:40,275
the guns themselves have an enormous amount of character

136
00:06:40,315 --> 00:06:42,856
and variety, maybe more than any other time in history.

137
00:06:43,616 --> 00:06:46,737
And as militaries and weapon manufacturers

138
00:06:46,777 --> 00:06:48,217
tried to figure out what worked and what didn't.

139
00:06:50,165 --> 00:06:52,046
We have several weapons in the game as far back as 1870,

140
00:06:52,506 --> 00:06:54,468
and maybe even earlier.

141
00:06:54,488 --> 00:06:56,429
And we have other weapons that were used well

142
00:06:56,469 --> 00:06:58,770
in the 20th century and even into the 21st century.

143
00:07:00,031 --> 00:07:01,812
There wasn't much consensus or standards

144
00:07:01,852 --> 00:07:04,314
about different actions, magazine types, et cetera.

145
00:07:05,055 --> 00:07:06,115
They hadn't even figured out yet

146
00:07:06,175 --> 00:07:07,676
if the bullets go in the top or the bottom.

147
00:07:09,117 --> 00:07:10,978
This is maybe the only major war

148
00:07:10,998 --> 00:07:13,560
that every type of action of firearm was used.

149
00:07:15,305 --> 00:07:18,606
There were guns that were tested by militaries and failed because they were too powerful.

150
00:07:19,527 --> 00:07:24,188
The militaries asked for changes and the answer from the engineer was, no, it's fine.

151
00:07:25,189 --> 00:07:27,389
And they lost millions of potential sales in the process.

152
00:07:28,330 --> 00:07:30,910
I'm sure there's more than a few game developers who can relate to that.

153
00:07:34,812 --> 00:07:38,093
Some of the guns have never been seen in a game before until now, and some may never

154
00:07:38,133 --> 00:07:39,093
be seen in a game again.

155
00:07:40,164 --> 00:07:43,087
In short, my mentality towards these guns was portraiture, basically.

156
00:07:44,007 --> 00:07:47,170
It's not self-expression, but you're just trying to capture what's already there.

157
00:07:47,970 --> 00:07:53,495
And a big shout-out to Ian McCollum of Forgotten Weapons, who, at least to me, was the best instructor in this stuff.

158
00:07:55,176 --> 00:07:59,480
So, when LA was asked to help finish Battlefield 1, it made sense that we would help out on the guns.

159
00:07:59,900 --> 00:08:05,485
Our lead weapon artist, Chris, is as OCD about this stuff, about the models, as I am about the animations.

160
00:08:06,831 --> 00:08:10,455
We made somewhere around a third of the weapons in the main game, and already there were some

161
00:08:10,535 --> 00:08:12,778
fun and interesting opportunities to do something different.

162
00:08:14,079 --> 00:08:17,743
For example, this handgun, the M1912, loads with a stripper clip from the top like most

163
00:08:17,803 --> 00:08:21,307
rifles of the day, but it also had a novel way of dumping your unused bullets.

164
00:08:24,502 --> 00:08:28,705
So this 8 round reload is correct for reloading the gun when it's empty, which is what the

165
00:08:28,745 --> 00:08:29,965
manufacturer clearly intended.

166
00:08:30,766 --> 00:08:32,787
But our game lets you reload whenever you want.

167
00:08:33,567 --> 00:08:37,110
So we could have loaded any bullet count less than 8, one bullet at a time like our shotguns

168
00:08:37,170 --> 00:08:38,550
work in previous Battlefield games.

169
00:08:39,451 --> 00:08:43,853
We have a system for that like I'm about to demonstrate, but that'd be potentially slow

170
00:08:43,893 --> 00:08:45,795
and worse it'd be boring and kind of samey.

171
00:08:47,235 --> 00:08:50,857
Ian, whose hands these are, showed us this unique feature of the gun, allowing you to

172
00:08:50,878 --> 00:08:53,259
eject all the ammo currently in it to make room for a new clip of 8.

173
00:08:55,482 --> 00:08:56,463
And so we used that instead.

174
00:08:57,124 --> 00:09:00,547
It's potentially slower than a start loop end, depending on how deep into the magazine

175
00:09:00,567 --> 00:09:02,149
you got, but it's a little more unique.

176
00:09:02,910 --> 00:09:06,574
So this animation is always ejecting its full payload of 8 bullets, up to 8 bullets.

177
00:09:07,395 --> 00:09:10,919
I hooked it up to compare the magazine size with its current ammo count, and then I just

178
00:09:11,039 --> 00:09:11,620
hid the difference.

179
00:09:11,880 --> 00:09:12,201
Voila.

180
00:09:12,401 --> 00:09:14,664
And I didn't have to convince a tech animator to support me on this.

181
00:09:15,164 --> 00:09:15,605
I just did it.

182
00:09:16,846 --> 00:09:19,827
uh... the correct number of bullets always ejects and now we're telling a story that

183
00:09:20,047 --> 00:09:21,168
only this gun has to tell

184
00:09:21,188 --> 00:09:24,870
uh... despite the slow ass reload some people love this gun and nobody's really

185
00:09:24,890 --> 00:09:25,470
complained about it

186
00:09:26,130 --> 00:09:29,131
if it's not worth it then uh... we have many faster pistol options in the game

187
00:09:30,512 --> 00:09:33,994
there were other places where we got to have fun in an otherwise very hectic

188
00:09:34,034 --> 00:09:35,854
schedule this is the Calibri pistol

189
00:09:36,595 --> 00:09:40,496
uh... I swear when we got this we just all assumed it was going to be an Easter egg

190
00:09:41,157 --> 00:09:43,058
it turned out it's just one of the guns that everybody gets

191
00:09:44,096 --> 00:09:47,741
Credit where credit is due, the concept of the Calibri's stupid animations were my blocking,

192
00:09:48,101 --> 00:09:51,965
but the full glory of this animation is the handiwork of one of our animators, Barbara Rojas.

193
00:09:52,947 --> 00:09:56,611
This was a hard gun not to keep for myself and an important lesson as a lead

194
00:09:56,871 --> 00:09:58,533
that sometimes you have to hand off the good stuff.

195
00:10:00,805 --> 00:10:04,286
Shipping Battlefield 1 was a hard project and like any production, there was definitely

196
00:10:04,306 --> 00:10:08,828
a line to walk of what was going to be good and what was going to be extra cool.

197
00:10:09,809 --> 00:10:13,330
Knowing that we'd be doing some of the DLC for this game, I kept a list of all the things

198
00:10:13,450 --> 00:10:17,592
I felt were holding us back, hoping that we'd be able to improve on an already solid foundation.

199
00:10:19,613 --> 00:10:22,855
So In the Name of the Tsar was the first post-launch pack from the LA studio.

200
00:10:23,475 --> 00:10:27,097
We had a bit more time to muck around than usual after shipping Battlefield 1, while

201
00:10:27,137 --> 00:10:28,817
the Stockholm studio did the first DLC.

202
00:10:30,002 --> 00:10:32,250
I wanted to start building up new features for the DLC weapons.

203
00:10:33,273 --> 00:10:34,056
And I'll explain why.

204
00:10:36,715 --> 00:10:40,816
I did mention how much character the weapons of the era had, and that is true sometimes.

205
00:10:41,036 --> 00:10:44,396
We've definitely added some guns with a lot of character since the Battlefield 1 launch

206
00:10:44,416 --> 00:10:47,117
with our three expansions, and I'll talk about these soon enough.

207
00:10:48,057 --> 00:10:51,338
But we're not just a game set in the early 20th century, we're a World War I game.

208
00:10:52,478 --> 00:10:57,019
And we had to include the standard infantry rifles, a lot of which we weren't able to

209
00:10:57,059 --> 00:10:57,799
ship on launch.

210
00:10:58,719 --> 00:11:02,380
The Russians, the Italians, the Canadians, the Japanese, they all had very iconic rifles.

211
00:11:02,980 --> 00:11:05,681
that were in this war and just couldn't fit in the main game.

212
00:11:05,741 --> 00:11:09,283
So we knew the three packs would include these six bolt action rifles here.

213
00:11:10,923 --> 00:11:15,365
But the standard rifles of the day were very, very standardized, a lot more than some of

214
00:11:15,385 --> 00:11:17,966
the weirder guns that I've shown and I will be showing.

215
00:11:18,986 --> 00:11:20,307
Basically they all work like this.

216
00:11:20,867 --> 00:11:23,208
With some small differences, it's how they still work today.

217
00:11:23,988 --> 00:11:28,510
The American Springfield rifle that we had in the main game is so similar to the German

218
00:11:28,550 --> 00:11:31,931
Mauser that the Germans actually sued over it as a copyright thing.

219
00:11:32,631 --> 00:11:36,742
So for the rest of this to make sense, I need to explain a little more about the original

220
00:11:37,043 --> 00:11:39,529
system and a little more technical stuff about guns.

221
00:11:39,910 --> 00:11:41,233
But I promise this is not a gun talk.

222
00:11:42,850 --> 00:11:44,110
A clip versus magazine.

223
00:11:44,191 --> 00:11:48,273
So this is a systems talk, not a gun talk, but for it to make complete sense, we need

224
00:11:48,293 --> 00:11:51,134
to clarify the difference of a clip and a magazine, and there are some other lessons

225
00:11:51,174 --> 00:11:52,835
of development here for anybody.

226
00:11:52,855 --> 00:11:56,197
A magazine is where the gun stores its bullets.

227
00:11:56,237 --> 00:12:00,279
They can be external, like most modern guns, or internal, like many older guns.

228
00:12:01,180 --> 00:12:05,142
Clips are for grouping bullets together for the purpose of loading into a usually internal

229
00:12:05,182 --> 00:12:05,682
magazine.

230
00:12:06,302 --> 00:12:08,243
You'll hear me say the term stripper clip.

231
00:12:08,884 --> 00:12:11,385
That is where you just strip it away afterwards.

232
00:12:12,902 --> 00:12:14,285
That's how most of these rifles worked.

233
00:12:15,327 --> 00:12:16,649
You might think this is pedantic,

234
00:12:16,770 --> 00:12:18,793
but let me tell you how many places in our database

235
00:12:18,894 --> 00:12:21,178
that dates back to Battlefield 3 references clips

236
00:12:21,438 --> 00:12:22,420
when it means magazines,

237
00:12:22,560 --> 00:12:24,805
and then we started making a game with clips.

238
00:12:25,990 --> 00:12:28,851
Not to mention that our animation assets are also called clips.

239
00:12:29,211 --> 00:12:31,632
So suddenly we have three different things that are all fighting with each other and

240
00:12:31,652 --> 00:12:33,152
we should have just named them right in the first place.

241
00:12:34,573 --> 00:12:39,114
For our purposes, magazine reloads are linear, start to end animations, and generally pretty

242
00:12:39,154 --> 00:12:39,795
easy to make work.

243
00:12:39,835 --> 00:12:40,875
And this is why this matters.

244
00:12:41,675 --> 00:12:43,156
Clips are where things are going to get tricky.

245
00:12:43,476 --> 00:12:45,316
Most of these bolt action rifles use clips.

246
00:12:49,372 --> 00:12:52,854
The core of our reload system for single-shot weapons leading up to Battlefield 1

247
00:12:53,414 --> 00:12:56,976
is a simple start-loop-end like we've been using since at least Battlefield 3

248
00:12:57,076 --> 00:13:00,558
probably long before, something all the game animators here are surely familiar with.

249
00:13:03,439 --> 00:13:06,601
You start, you loop the correct number of bullets to load, and then you end the animation.

250
00:13:06,641 --> 00:13:08,081
It's really basic stuff for gameplay.

251
00:13:08,822 --> 00:13:12,363
This is actually the first weapon I ever animated at DICE on Battlefield 3,

252
00:13:13,104 --> 00:13:14,905
and it sucks, and I'm really sorry about that.

253
00:13:16,690 --> 00:13:21,632
The difference in Battlefield 1 is that we added the ability to add a number of bullets

254
00:13:21,832 --> 00:13:23,533
at once to represent stripper clips.

255
00:13:25,053 --> 00:13:26,854
Oh, it's supposed to be playing back.

256
00:13:28,255 --> 00:13:29,135
This is not my system.

257
00:13:29,155 --> 00:13:32,336
This was the talented team in Stockholm.

258
00:13:34,523 --> 00:13:38,627
Clips also loop so you can load multiple clips even if most weapons we had didn't.

259
00:13:39,407 --> 00:13:41,569
A few of the main Battlefield 1 weapons work this way.

260
00:13:42,750 --> 00:13:46,152
It's also important to note that this is a gross oversimplification of the concept.

261
00:13:46,392 --> 00:13:49,295
It was actually really difficult to get this working and it's not an easy setup.

262
00:13:50,275 --> 00:13:53,798
But it is important because it's the foundation of everything that we're going to go apeshit

263
00:13:53,818 --> 00:13:54,639
with from here on out.

264
00:13:56,260 --> 00:13:58,161
I wanted to include this example from Battlefield 4.

265
00:13:58,281 --> 00:14:00,823
It's one of my favorites and I probably talk about it too much.

266
00:14:02,452 --> 00:14:06,376
I want you to see what a big magazine looks like without clips with the start loop end

267
00:14:06,416 --> 00:14:06,796
system.

268
00:14:07,377 --> 00:14:08,859
It starts to get a little repetitive.

269
00:14:09,719 --> 00:14:10,941
So yes I animated this.

270
00:14:11,221 --> 00:14:15,686
It's 17 seconds to reload this entire gun and believe it or not the gun was very popular.

271
00:14:15,706 --> 00:14:17,808
I like to argue with designers about this one.

272
00:14:20,028 --> 00:14:24,269
So, already Battlefield 1's reload system is pretty solid and well ahead of some of

273
00:14:24,329 --> 00:14:26,250
our competitors, but it is also pretty rigid.

274
00:14:27,210 --> 00:14:29,791
For example, once we commit to start loop end, that's it.

275
00:14:29,871 --> 00:14:32,972
That's the logic of the gun regardless of how we're going to use it.

276
00:14:33,852 --> 00:14:37,694
If we didn't make some changes to the existing system for these kind of guns, our new weapons

277
00:14:37,714 --> 00:14:39,374
were going to have to look a lot like the old ones.

278
00:14:40,174 --> 00:14:40,975
Pretty much exactly.

279
00:14:41,855 --> 00:14:45,956
So we made a bunch of changes, but lists are boring, so let's just cover these in examples.

280
00:14:46,830 --> 00:14:48,611
You'll see this slide a lot, don't worry about reading it.

281
00:14:49,011 --> 00:14:49,731
First, the easy stuff.

282
00:14:51,012 --> 00:14:53,193
This is the Gasser Revolver from Main Game Battlefield 1,

283
00:14:53,654 --> 00:14:54,314
which I animated.

284
00:14:55,135 --> 00:14:57,876
It uses the start loop end logic minus any kind of clip,

285
00:14:58,417 --> 00:15:00,198
regardless for the amount of bullets fired.

286
00:15:00,778 --> 00:15:02,639
As you can see, it starts to get a little repetitive

287
00:15:02,679 --> 00:15:03,600
if you empty the whole thing.

288
00:15:05,041 --> 00:15:07,582
We knew we were dealing with a similar problem to the bolt-action rifles.

289
00:15:08,022 --> 00:15:09,442
There was only one way to animate it.

290
00:15:09,502 --> 00:15:12,903
Switch hands, open the gate, loop the eject and load however many times,

291
00:15:12,983 --> 00:15:14,744
close the gate, and switch back.

292
00:15:15,264 --> 00:15:17,284
We've already done this for three different guns on Battlefield 1,

293
00:15:17,444 --> 00:15:18,405
and we don't want to do it again.

294
00:15:19,845 --> 00:15:23,466
So, when we decided to add another single-gate loaded revolver

295
00:15:23,526 --> 00:15:26,047
with the M1895 and In the Name of the Tsar,

296
00:15:26,487 --> 00:15:28,107
I saw a couple opportunities for improvement.

297
00:15:28,907 --> 00:15:31,888
First, randomizing the individual loops to break the repetition.

298
00:15:32,837 --> 00:15:36,041
This gun was animated by Colin Cromwell, one of our other animators.

299
00:15:37,182 --> 00:15:40,625
This is what the M18985 reload would look like without any new tech.

300
00:15:41,226 --> 00:15:43,488
One eject and one load looped up to seven times.

301
00:15:46,451 --> 00:15:46,932
That's boring.

302
00:15:48,393 --> 00:15:51,416
So here's what it looks like with some loops added for variety.

303
00:15:52,567 --> 00:15:55,709
or to demonstrate with the format that I've been using so far, here's what's actually

304
00:15:55,749 --> 00:15:56,609
happening under the hood.

305
00:15:57,650 --> 00:16:01,352
Loop variants aren't anything novel to game animators, but I'm not sure that I've seen

306
00:16:01,372 --> 00:16:03,113
them applied to reload animations before.

307
00:16:03,933 --> 00:16:08,275
So already we're looking better than we did before, but it's still long and kind of repetitive.

308
00:16:09,999 --> 00:16:13,381
A good option for variety that we'd wanted to do in Battlefield 1 but didn't have the

309
00:16:13,401 --> 00:16:18,243
tech for was swapping the entire revolver cylinder out, but that would be a change in

310
00:16:18,263 --> 00:16:18,643
the logic.

311
00:16:18,663 --> 00:16:20,904
It's no longer start, loop, end, but a magazine swap.

312
00:16:21,044 --> 00:16:27,347
So our engineer, Randy Stanton, who is responsible for most of this stuff on the code side, hooked

313
00:16:27,387 --> 00:16:31,148
us up so we can not only change the reload animations by bullet count, but we can even

314
00:16:31,168 --> 00:16:32,569
change the reloading logic itself.

315
00:16:35,042 --> 00:16:38,745
So for zero rounds left, we've done a completely different animation that doesn't require starts

316
00:16:38,805 --> 00:16:42,188
and loops and ends, but plays just like a regular magazine reload.

317
00:16:42,649 --> 00:16:46,652
Start to finish, notice even the ammo count is updating right about the correct time.

318
00:16:51,242 --> 00:16:52,103
This was major code work.

319
00:16:52,463 --> 00:16:54,045
I've emphasized our data-driven power,

320
00:16:54,085 --> 00:16:55,246
but this would not have happened

321
00:16:55,266 --> 00:16:56,487
without lots of engineering time.

322
00:16:57,448 --> 00:17:00,111
This was also probably the most animator-enabling addition

323
00:17:00,131 --> 00:17:02,794
that we made to the system of those six on my list.

324
00:17:03,675 --> 00:17:05,437
Our new weapon animations would be really boring

325
00:17:05,457 --> 00:17:06,738
without this more than anything.

326
00:17:08,620 --> 00:17:10,302
So we took this same tech and applied it

327
00:17:10,342 --> 00:17:12,124
to one of our new light machine guns,

328
00:17:12,184 --> 00:17:13,245
the Parabellum MG1417.

329
00:17:15,836 --> 00:17:19,957
The Parabellum MG 1417 feeds a cloth belt through as it fires, so I thought it'd be

330
00:17:19,977 --> 00:17:24,038
cool to have to reel all that belt back in when you reload.

331
00:17:24,898 --> 00:17:29,099
There's a story that may or may not be true, that the phrase, the whole nine yards, originates

332
00:17:29,159 --> 00:17:30,979
in World War I from the lengths of these cloth belts.

333
00:17:31,659 --> 00:17:34,560
Giving them the whole nine yards is meant to be unloading every last bullet.

334
00:17:34,740 --> 00:17:37,700
Nine yards is actually closer to what they used in the airplanes, not in the infantry

335
00:17:37,720 --> 00:17:38,001
weapons.

336
00:17:39,461 --> 00:17:41,721
In this case, I don't know if that story's true.

337
00:17:42,041 --> 00:17:42,541
I want it to be.

338
00:17:45,137 --> 00:17:48,800
In this case, we didn't change the reload logic by ammo types, but we did change the

339
00:17:48,900 --> 00:17:53,144
reload timers to match the five different reload animations for this gun.

340
00:17:53,884 --> 00:17:58,108
The longer you fire, the more belt you have to reel back in until you use the whole thing.

341
00:17:58,528 --> 00:18:01,991
If you empty it, then you would just rip the belt off on the left and load a new cylinder.

342
00:18:02,011 --> 00:18:03,692
It winds up being actually faster.

343
00:18:04,433 --> 00:18:08,236
This adds a fun design element to it, knowing the longer that you fire without reloading,

344
00:18:08,416 --> 00:18:10,838
the more you accumulate reload debt.

345
00:18:12,279 --> 00:18:15,961
Most of the Parabellum animation set was done by James Fiorella, one of our animators.

346
00:18:16,722 --> 00:18:19,344
Then I built the four manual reloads, starting with his empty.

347
00:18:20,545 --> 00:18:24,547
Speaking of the cloth belt, that leverages another new piece of tech, animation phase

348
00:18:24,567 --> 00:18:24,848
control.

349
00:18:27,237 --> 00:18:30,979
Now I'm here to talk about the cool stuff that LA did to Battlefield, but this feature

350
00:18:31,019 --> 00:18:33,521
actually comes from Stockholm, who did this in They Shall Not Pass.

351
00:18:34,381 --> 00:18:37,383
I forgot about this when I was putting the slides together, but we did actually do something,

352
00:18:37,723 --> 00:18:42,466
even where a basic version of this in the main game for revolvers to procedurally clock

353
00:18:42,506 --> 00:18:44,647
the cylinder as we fire and as we reload.

354
00:18:44,667 --> 00:18:46,308
This is more complicated.

355
00:18:46,588 --> 00:18:51,911
So They Shall Not Pass was the first expansion that included a machine gun with a transparent

356
00:18:52,071 --> 00:18:53,552
or open magazine.

357
00:18:54,632 --> 00:18:59,616
You would see the bullet count deplete and the magazine spring, the follower push the

358
00:18:59,636 --> 00:19:00,837
bullets in as it was fired.

359
00:19:02,037 --> 00:19:05,720
Transparent magazines have been something of a white whale for us on our weapon team

360
00:19:05,740 --> 00:19:08,062
for a long time and the animators on this pack totally nailed it.

361
00:19:13,485 --> 00:19:16,868
So the magazine is controlled by what's called the phase animation, mapping the length of

362
00:19:16,888 --> 00:19:18,969
the animation to the capacity of the magazine.

363
00:19:20,130 --> 00:19:24,251
So basically this is a 20 frame animation on a magazine map to 20 rounds.

364
00:19:24,871 --> 00:19:26,212
Each frame is one round fired.

365
00:19:26,372 --> 00:19:29,553
Obviously in game we are hiding the bullets before they come out the top of the gun.

366
00:19:30,894 --> 00:19:32,754
This is what I mean by phase animation.

367
00:19:32,994 --> 00:19:38,496
The duration corresponds to a 0 to 1 float value that in the other cases I'll be showing

368
00:19:38,536 --> 00:19:41,037
here it corresponds to whatever the magazine size is.

369
00:19:41,618 --> 00:19:43,798
Float 0 when it's empty and 1 when it's full.

370
00:19:46,668 --> 00:19:48,529
With that, explain back to the Parabellum.

371
00:19:49,210 --> 00:19:50,670
The cloth belt comes out the left side of the gun

372
00:19:50,711 --> 00:19:52,792
as a fake physics chain that's always on.

373
00:19:52,972 --> 00:19:55,414
It's very basic and not even really worth explaining.

374
00:19:56,394 --> 00:19:57,535
But using the phase control,

375
00:19:57,655 --> 00:20:01,137
we could tag it up to hide based on phase.

376
00:20:01,938 --> 00:20:03,439
So the belt is always there.

377
00:20:04,580 --> 00:20:07,161
We're just unhiding it the first 10 or so rounds.

378
00:20:09,003 --> 00:20:10,604
We also do the same thing with the bullets

379
00:20:10,824 --> 00:20:12,525
on the right side of the gun that are feeding in

380
00:20:12,565 --> 00:20:14,546
when it's almost empty for the last five or so.

381
00:20:15,679 --> 00:20:20,001
Phase control was also a crucial part of getting the different reload animations to play and

382
00:20:20,041 --> 00:20:22,622
how we told our engine which one to play when.

383
00:20:23,602 --> 00:20:26,103
We could drive animation playback by bullet count essentially now.

384
00:20:28,064 --> 00:20:32,165
Phase control is a perfect example of asset dumpster diving that I mentioned earlier.

385
00:20:32,605 --> 00:20:33,866
Stockholm built this for one gun.

386
00:20:35,331 --> 00:20:37,413
I made a system out of it and used it every chance I could.

387
00:20:38,334 --> 00:20:40,217
This was a perfect fit for several of our weapons.

388
00:20:40,557 --> 00:20:45,503
We added it to three of them in The Name of the Tsar alone and one in Battlefield 1 Apocalypse,

389
00:20:45,683 --> 00:20:46,364
the last DLC.

390
00:20:47,691 --> 00:20:49,411
Almost all of our weapon systems change,

391
00:20:49,792 --> 00:20:51,152
almost all of these changes that I'm showing here

392
00:20:51,192 --> 00:20:52,532
happened during In the Name of the Tsar,

393
00:20:53,193 --> 00:20:54,433
but I'm gonna jump ahead to a weapon

394
00:20:54,453 --> 00:20:56,293
from the next expansion, Turning Tides,

395
00:20:56,794 --> 00:20:58,634
which didn't drive any of these new features,

396
00:20:58,694 --> 00:21:00,715
but it most clearly demonstrates the need for,

397
00:21:00,735 --> 00:21:02,895
the justification for these.

398
00:21:02,955 --> 00:21:06,036
So, Alt Deploy is one of the ones we used here.

399
00:21:06,056 --> 00:21:07,597
Let me explain what that is.

400
00:21:09,517 --> 00:21:10,477
Without skipping the slide.

401
00:21:13,538 --> 00:21:14,559
My laptop's very old.

402
00:21:14,579 --> 00:21:15,979
This should be playing.

403
00:21:21,529 --> 00:21:22,569
It's not, I'll just explain it.

404
00:21:22,629 --> 00:21:25,511
So deploy is when you first bring out the gun,

405
00:21:25,832 --> 00:21:27,233
and alt deploy is when you switch to,

406
00:21:27,353 --> 00:21:29,634
this is like an underbarrel shotgun from Battlefield 4.

407
00:21:29,874 --> 00:21:32,076
So when you switch to a secondary weapon

408
00:21:32,877 --> 00:21:36,079
underneath the primary, it's basically a change in logic

409
00:21:37,400 --> 00:21:39,081
to a piggyback weapon, essentially.

410
00:21:39,601 --> 00:21:41,543
We've had this since Battlefield 3, Battlefield 4.

411
00:21:42,964 --> 00:21:44,145
Try to play it one more time.

412
00:21:48,207 --> 00:21:48,468
There we go.

413
00:21:52,845 --> 00:21:55,766
So the first one is the deploy, the second one is the alt deploy.

414
00:21:58,587 --> 00:22:00,608
We did use this system for rifle grenades in Battlefield 1.

415
00:22:01,608 --> 00:22:04,829
And it's a good system, but it takes a lot more animation work, both in first and third

416
00:22:04,849 --> 00:22:05,189
person.

417
00:22:05,809 --> 00:22:07,390
And I'll explain why this matters momentarily.

418
00:22:09,110 --> 00:22:13,612
So on the Carcano, which was also animated by James, it's different than most of our

419
00:22:13,652 --> 00:22:16,133
sniper rifles because it uses an end block magazine.

420
00:22:17,317 --> 00:22:19,399
An N-block is most famous from the M1 Garand.

421
00:22:19,859 --> 00:22:24,202
It's a kind of clip that sits inside the gun's internal magazine and then is ejected at some

422
00:22:24,242 --> 00:22:24,462
point.

423
00:22:24,602 --> 00:22:28,965
So for the M1, the M-block is famously ejected with a loud ping when the last round is fired.

424
00:22:29,845 --> 00:22:33,047
We also have a couple of main game rifles that use N-blocks, but we didn't have these

425
00:22:33,087 --> 00:22:35,789
systems yet, so they aren't completely mechanically accurate.

426
00:22:36,249 --> 00:22:38,411
And sorry Twitter, but we're not going back and changing them.

427
00:22:39,737 --> 00:22:43,939
On the Carcano, the end block falls out the bottom when the last round is chambered.

428
00:22:44,359 --> 00:22:47,240
It's basically the bullets are holding it in place and as soon as the last one is stripped

429
00:22:47,260 --> 00:22:49,902
away the magazine, or the end block, falls out.

430
00:22:51,402 --> 00:22:51,703
Usually.

431
00:22:52,683 --> 00:22:58,106
We were able to do that by adding a one-off bolt action animation that plays on the second

432
00:22:58,126 --> 00:22:59,266
to the last round fired.

433
00:23:00,107 --> 00:23:03,328
We don't see it very well in first person, but it's there and you can hear it.

434
00:23:06,600 --> 00:23:09,422
This clears the way for a faster reload with one or two rounds left.

435
00:23:12,464 --> 00:23:16,406
Thanks to the different logic by ammo count, we can also have the correct slower reload

436
00:23:16,446 --> 00:23:21,068
animation that removes the old block, the old end block first, and yes, removing the

437
00:23:21,128 --> 00:23:24,590
end block contains the correct amount of bullets that you have remaining.

438
00:23:25,771 --> 00:23:28,932
I made a whole video of this that I put on my YouTube channel showing the differences

439
00:23:28,992 --> 00:23:33,175
of the bullets out and bullets in, especially when it gets low on ammo.

440
00:23:34,876 --> 00:23:42,408
That video apparently got recorded at like 240p, so thanks to BattlefieldStreamerBloodhoundHD for these videos, because mine looked like shit.

441
00:23:43,671 --> 00:23:45,534
So, there is a problem here.

442
00:23:47,487 --> 00:23:50,088
Battlefield 1 added a sniper gadget called K-Bullets.

443
00:23:50,389 --> 00:23:53,610
They're basically armor-piercing bullets that need to always be an option for the scout

444
00:23:53,650 --> 00:23:56,551
class, which means all bolt-action rifles have to have this.

445
00:23:57,672 --> 00:24:02,154
K-Bullets is a different system than ALT-Deploy, which cleverly repurposes bolt-action and

446
00:24:02,194 --> 00:24:08,236
reload animations to make a different system altogether, but it's pretty restrictive.

447
00:24:08,336 --> 00:24:08,656
It needs a...

448
00:24:10,711 --> 00:24:12,151
It restricts the way that reloads can work.

449
00:24:12,231 --> 00:24:16,433
So it needs a bolt action animation, which is easy enough, but it also uses the same

450
00:24:16,473 --> 00:24:21,694
start clip loop and reload animations to load and reload a single new KBullet.

451
00:24:22,635 --> 00:24:26,376
There wasn't really a way to give this swap its own animation under the KBullet system.

452
00:24:28,077 --> 00:24:31,698
There's more limitation for bolt actions that would mean animating them all the same way

453
00:24:31,738 --> 00:24:33,858
because it's always going to repurpose another part of the animation.

454
00:24:35,257 --> 00:24:38,739
As you can probably guess, the existing K-bullets setup isn't going to work for the Carcano

455
00:24:38,759 --> 00:24:41,520
because you just saw the two reloads and none of them load one single bullet.

456
00:24:45,042 --> 00:24:49,544
So with a bit of code changes that enabled this option for animators and designers, we

457
00:24:49,564 --> 00:24:53,366
could use the Alt-Deploy system for K-bullets on the Carcano or anywhere else that we wanted.

458
00:24:54,147 --> 00:24:57,349
It just meant that we had to do a bit more animation for switching to and from the K-bullets,

459
00:24:57,449 --> 00:24:59,410
including removing and replacing the end block.

460
00:25:00,130 --> 00:25:04,252
It also needed its own reload animation to eject a single shell casing and load a new

461
00:25:04,312 --> 00:25:04,933
single cartridge.

462
00:25:08,150 --> 00:25:10,711
This isn't something we wanted to do for every gun, it's a lot of work.

463
00:25:11,992 --> 00:25:14,413
It's just for special cases that wouldn't work with the old system.

464
00:25:14,473 --> 00:25:17,374
But that leads me to the gun that initially drove a lot of these changes.

465
00:25:18,815 --> 00:25:19,875
The Mosin-Nagant rifle.

466
00:25:20,775 --> 00:25:22,056
This is back in the name of the Tsar.

467
00:25:23,416 --> 00:25:28,500
The Mosin Nagant is a gun that our fans probably knew better than most of what was in Battlefield 1.

468
00:25:28,840 --> 00:25:31,503
They made so many of these and they're very inexpensive.

469
00:25:32,103 --> 00:25:35,446
It's not uncommon to talk to people who have fired these or fired one yourself.

470
00:25:36,307 --> 00:25:40,971
It was one of the most used weapons in World War 1 and I wanted the first new sniper rifle

471
00:25:40,991 --> 00:25:42,972
to come out of DICE LA to be something special.

472
00:25:42,992 --> 00:25:45,414
It'd be very different from the guns that came before it.

473
00:25:46,754 --> 00:25:50,737
Now a lot of our reload system involves ejecting perfectly good bullets that get magically

474
00:25:50,777 --> 00:25:54,941
re-added to your ammo pool and I'm okay with some suspension of disbelief, but for the

475
00:25:55,001 --> 00:25:59,144
standard Russian infantry rifle, wasting bullets seemed to be not okay.

476
00:26:01,366 --> 00:26:04,989
So I set up an arbitrary rule that you would never see a loaded cartridge eject from the

477
00:26:05,029 --> 00:26:06,610
Mosin-Nagant that the player didn't catch.

478
00:26:07,597 --> 00:26:11,338
Obviously this made life more difficult, but great things aren't born from easy lives.

479
00:26:12,178 --> 00:26:17,219
I believe creativity thrives within constraints, so sometimes I make up constraints, and hopefully

480
00:26:17,299 --> 00:26:18,039
some of this comes through.

481
00:26:19,020 --> 00:26:22,581
This is the reload animation for the Mosin-Nagant when you have one bullet left, you'll see

482
00:26:22,601 --> 00:26:25,762
that he, or in this case, she, catches it.

483
00:26:26,822 --> 00:26:31,703
Unlike previous rifles, our new ability to change reload logic, reload by logic, allowed

484
00:26:31,743 --> 00:26:33,644
us to eject the last round of the rifle.

485
00:26:34,644 --> 00:26:38,507
and just load a new clip of five instead of looping through four single bullet load animations

486
00:26:38,968 --> 00:26:42,771
which is not only faster but makes more sense. Already this is an improvement over the way

487
00:26:42,791 --> 00:26:50,818
the game shipped. In this case it is a little slower than it could be because she has to

488
00:26:50,858 --> 00:26:55,422
catch, in the case of our Russian Scout, the first female character in one of the Battlefield

489
00:26:55,442 --> 00:27:00,206
multiplayer games, she's going to waste a perfectly good bullet so she's going to catch

490
00:27:00,246 --> 00:27:02,248
that and has to grab it before loading the new clip.

491
00:27:03,474 --> 00:27:08,597
As you can probably guess from the clip, from the text on this, this is a straight through

492
00:27:08,637 --> 00:27:13,161
animation playing a magazine type reload instead of anything around our start loop end system.

493
00:27:15,422 --> 00:27:19,125
The reload from empty is pretty much the same except it's a little bit faster because now

494
00:27:19,145 --> 00:27:22,387
you're just ejecting the spent casing before loading a new clip.

495
00:27:23,508 --> 00:27:24,389
Once again, straight through.

496
00:27:24,709 --> 00:27:26,270
But then it gets interesting.

497
00:27:30,628 --> 00:27:34,471
So this is the reload system for having fired just one shot, and it does use our start loop

498
00:27:34,511 --> 00:27:36,353
end system, because here it makes more sense.

499
00:27:37,153 --> 00:27:43,018
So now we're all set up for reloading one bullet up to five bullets, if I wasn't a masochist.

500
00:27:44,379 --> 00:27:47,582
So this would be a good opportunity to throw in loop variations, but it's only one to three

501
00:27:47,622 --> 00:27:47,942
rounds.

502
00:27:48,663 --> 00:27:52,046
And of course we only see one round in our hand at a time, because the animation has

503
00:27:52,086 --> 00:27:52,426
to loop.

504
00:27:53,387 --> 00:27:55,008
But wouldn't it be cool to see the rounds in our hands?

505
00:27:56,095 --> 00:27:59,217
So we haven't fully taken advantage of the clip system yet.

506
00:27:59,377 --> 00:28:01,038
I'm just using the single bullet part of it.

507
00:28:03,979 --> 00:28:06,200
The clip system was intended to load a group of bullets

508
00:28:06,220 --> 00:28:07,721
at the same time, but no one said

509
00:28:07,741 --> 00:28:09,162
it had to actually be a clip.

510
00:28:11,443 --> 00:28:13,544
So this is the three round reload for the Mosin Nagant.

511
00:28:14,144 --> 00:28:16,525
We get to see more than one bullet in hand at a time,

512
00:28:16,645 --> 00:28:18,646
and the animation's fast enough that it's not too weird

513
00:28:18,666 --> 00:28:22,248
for them to register in the magazine at the same time.

514
00:28:23,397 --> 00:28:27,203
We see the looping group animation only once, which is the two bullets going in, followed

515
00:28:27,243 --> 00:28:30,508
by the single bullet loop only once, and now we have a loaded rifle.

516
00:28:32,831 --> 00:28:36,055
So as you can maybe guess, that the two round reload animation looks like this.

517
00:28:37,998 --> 00:28:39,741
Only playing the group and not the single.

518
00:28:41,578 --> 00:28:45,759
Now I can't show you our ant interface, but I can show you this expert recreation, which

519
00:28:45,819 --> 00:28:46,699
explains how I set it up.

520
00:28:47,960 --> 00:28:51,681
Effectively, we give the player five reload animations, one for every possible ammo count

521
00:28:51,701 --> 00:28:53,301
of the gun, for the price of just three.

522
00:28:54,021 --> 00:28:58,863
It's all set up to loop, and if we wanted to use this for the four or five round reload,

523
00:28:59,423 --> 00:29:00,143
it would plug right in.

524
00:29:01,063 --> 00:29:04,844
This also makes audio's life a little bit easier, which they deserve after all the time

525
00:29:04,884 --> 00:29:06,165
that I spent making it harder.

526
00:29:07,826 --> 00:29:11,807
Now while I'm definitely trying to glamorize this and advocate smart workflows, it's worth

527
00:29:11,847 --> 00:29:14,508
mentioning that this is still two guns worth of reload animations.

528
00:29:17,929 --> 00:29:18,849
So that covers that.

529
00:29:20,310 --> 00:29:24,551
Let's touch briefly on how the M91 also required the use of the alt-deploy changes.

530
00:29:25,831 --> 00:29:29,432
Remember K-bullets, and remember my rule about not wasting bullets.

531
00:29:30,172 --> 00:29:35,494
So this would have worked with the stripper clip reload that we had for the one through

532
00:29:35,534 --> 00:29:36,014
three rounds.

533
00:29:37,985 --> 00:29:38,925
but we couldn't waste bullets.

534
00:29:39,405 --> 00:29:41,767
So the Mosin-Nagant had to get the alt-deploy treatment

535
00:29:41,787 --> 00:29:43,568
with one-off changeover animations

536
00:29:43,608 --> 00:29:46,089
between regular bullets and armor-piercing K-bullets

537
00:29:46,349 --> 00:29:47,110
without dropping them.

538
00:29:48,090 --> 00:29:49,511
At the time that we implemented these,

539
00:29:49,551 --> 00:29:51,552
the K-bullet system wasn't quite ready for it,

540
00:29:51,832 --> 00:29:52,813
and we did have some issues,

541
00:29:53,073 --> 00:29:54,914
so these animations had to be really fast

542
00:29:55,134 --> 00:29:56,195
to minimize the problems.

543
00:29:57,515 --> 00:29:59,737
Overall, this gun was a huge time sink.

544
00:30:01,618 --> 00:30:01,778
Sorry.

545
00:30:03,427 --> 00:30:05,408
and in comparison to any of the bolt actions in the main game

546
00:30:06,449 --> 00:30:09,951
but I thought of it as a flagship weapon, not only an iconic weapon of the war

547
00:30:09,991 --> 00:30:11,412
but one that demanded new features

548
00:30:11,932 --> 00:30:15,254
that both liberated us creatively and would speed things up for future weapons

549
00:30:16,195 --> 00:30:19,637
there was a lot of pain up front both for me and Randy, our engineer, but it paid

550
00:30:19,657 --> 00:30:21,958
off in spades with the other new weapons that followed

551
00:30:24,256 --> 00:30:28,258
With all this in our toolbox, the second half of the Tsar weapons that we added and beyond

552
00:30:28,298 --> 00:30:30,639
could start following the paths paved by the first lot.

553
00:30:31,520 --> 00:30:34,882
I didn't mention this earlier, but at some point in production, our weapon list for In

554
00:30:34,902 --> 00:30:38,724
the Name of the Tsar went from six to eleven new guns, and we probably wouldn't have gone

555
00:30:38,784 --> 00:30:41,205
so nuts with the new systems if we'd known that at the time.

556
00:30:42,125 --> 00:30:46,688
But the new tools from the first six guns made all the following much easier while still

557
00:30:46,728 --> 00:30:48,469
allowing us to preserve some of the unique character.

558
00:30:51,730 --> 00:30:52,571
I just hit the Windows button.

559
00:30:52,691 --> 00:30:53,051
That's nice.

560
00:30:53,071 --> 00:30:53,291
Thank you.

561
00:30:54,645 --> 00:30:57,466
Okay, well, mostly it allowed us to do that.

562
00:30:58,506 --> 00:31:01,747
So this is the Perino M1908 machine gun.

563
00:31:02,088 --> 00:31:04,388
It's another one of those weapons of the era with a great story.

564
00:31:05,088 --> 00:31:08,589
They were still trying to figure out what worked best as far as military small arms

565
00:31:08,629 --> 00:31:08,809
go.

566
00:31:09,410 --> 00:31:14,111
This had a water-cooled barrel and a unique 120-round hopper of bullets.

567
00:31:14,731 --> 00:31:18,092
There was 20 rounds in a tray, stacked six high.

568
00:31:20,062 --> 00:31:23,607
It had a major advantage over belt-fed machine guns of the day, and it could be continuously

569
00:31:23,667 --> 00:31:28,374
fired, effectively forever, by a single machine gunner as long as the water and the bullets

570
00:31:28,414 --> 00:31:29,556
were continually topped off.

571
00:31:29,977 --> 00:31:32,160
I believe in testing, this was fired for seven days straight.

572
00:31:33,325 --> 00:31:37,190
The Italian government decided this thing was so good, they deemed it top secret so

573
00:31:37,210 --> 00:31:37,910
it couldn't be copied.

574
00:31:38,591 --> 00:31:39,672
But then World War broke out.

575
00:31:40,293 --> 00:31:44,418
They didn't have time to test and perfect the design because of its secret nature and

576
00:31:44,458 --> 00:31:48,162
so when the war broke out, they couldn't get into production fast enough and it lost out

577
00:31:48,222 --> 00:31:50,845
to another, arguably inferior machine gun.

578
00:31:51,466 --> 00:31:54,429
Timing matters, folks, even when you have the superior product.

579
00:31:56,279 --> 00:31:59,941
There's nothing stupid about this gun, I was just being cheeky because for our game and

580
00:31:59,981 --> 00:32:04,165
the accuracy which I think our fans expect of us, this thing presents a lot of problems.

581
00:32:05,546 --> 00:32:08,268
So our story of the Perino is nearly as tragic.

582
00:32:08,869 --> 00:32:12,872
The higher ups really wanted a different gun, but I was really sure I couldn't make that

583
00:32:12,932 --> 00:32:16,595
gun look good on our base animation sets, the underlying third person movements.

584
00:32:17,676 --> 00:32:20,758
And this is considering that we have dudes running around with 100 pound machine guns.

585
00:32:21,965 --> 00:32:24,446
One of our animators did a bunch of test poses with that gun.

586
00:32:24,466 --> 00:32:26,186
It just didn't work.

587
00:32:26,206 --> 00:32:26,867
It didn't look right.

588
00:32:26,947 --> 00:32:30,047
So our designer had a compromise in mind with this gun.

589
00:32:30,928 --> 00:32:33,148
When I saw the Perino, I saw that it had a way to hold it

590
00:32:33,388 --> 00:32:34,848
that would work with our animation set.

591
00:32:35,729 --> 00:32:37,789
And I was just kind of tired of fighting about it.

592
00:32:37,829 --> 00:32:38,969
So I was like, okay, yeah, fine.

593
00:32:39,410 --> 00:32:40,030
We can make that work.

594
00:32:40,610 --> 00:32:41,870
And I probably should have looked closer

595
00:32:42,130 --> 00:32:43,070
before I agreed to this.

596
00:32:44,971 --> 00:32:46,631
So as you can probably guess from the previous slide,

597
00:32:46,751 --> 00:32:47,952
we're using phase control again,

598
00:32:48,052 --> 00:32:50,072
but it wasn't, even now, it wasn't straightforward.

599
00:32:51,794 --> 00:32:54,917
The Perino holds 120 rounds in six trays of 20.

600
00:32:55,057 --> 00:32:57,459
Every 20 rounds, one of those trays is ejected.

601
00:32:58,359 --> 00:32:59,540
If we're using a phase animation,

602
00:32:59,580 --> 00:33:02,203
we can't interrupt it every 20 frames

603
00:33:02,223 --> 00:33:03,284
to play a regular animation.

604
00:33:04,144 --> 00:33:06,646
Even if it was additive, you'd see all the bullets pause

605
00:33:06,706 --> 00:33:08,248
and wait for the eject before resuming.

606
00:33:08,928 --> 00:33:10,269
So I split one phase into two,

607
00:33:10,810 --> 00:33:12,911
the individual clip and the overall magazine.

608
00:33:15,743 --> 00:33:19,307
The best way to demonstrate what this really means is to isolate the two by deleting the

609
00:33:19,347 --> 00:33:20,868
geometry of the other.

610
00:33:21,509 --> 00:33:26,074
This is the Perino with the clip geometry deleted so you can see the effect of just

611
00:33:26,114 --> 00:33:26,914
the phase animation.

612
00:33:29,297 --> 00:33:33,661
This is the easy part, 120 frames corresponding to 120 rounds regardless of anything else.

613
00:33:33,842 --> 00:33:34,322
No big deal.

614
00:33:36,404 --> 00:33:37,365
This is the trickier part.

615
00:33:39,512 --> 00:33:44,774
The clip without the rest of the magazine notice the ammo counter here. This is not one gif looping

616
00:33:44,815 --> 00:33:48,376
This is or one video looping. This is this is actually looping six times

617
00:33:49,977 --> 00:33:51,078
Playing six times before it loops

618
00:33:52,598 --> 00:33:59,782
This is also why you can sometimes see a little visibility hitch with this gun. I can't overlap the clip with myself with itself I

619
00:33:59,822 --> 00:34:04,485
Hided it as soon as it's off screen and fly it back over, but I can't do that faster than the machine gun can fire

620
00:34:05,848 --> 00:34:09,812
This little bit could have been fixed with more complexity and more polygons, but I haven't

621
00:34:09,833 --> 00:34:13,276
even gotten into the cup game of the reloads and our weapon modelers were already about

622
00:34:13,317 --> 00:34:14,198
to kill me over this thing.

623
00:34:15,739 --> 00:34:19,764
So this slide is fun because it makes the artists cringe at my Photoshop and the engineers

624
00:34:19,824 --> 00:34:20,865
cringe at my math.

625
00:34:21,792 --> 00:34:26,736
But in terms of layers, it looks like one big phase animation and it drives the entire 120 rounds.

626
00:34:27,637 --> 00:34:30,739
Another layer under it is driving the sub-phase value.

627
00:34:31,540 --> 00:34:38,225
The phase is multiplied by 6 and then normalized so it hits 1 every 20 rounds instead of every 120 rounds.

628
00:34:38,846 --> 00:34:41,848
When the sub-phase hits 1, it triggers the clip eject animation.

629
00:34:42,729 --> 00:34:47,032
The last frame of the clip eject animation is off screen and hidden, so if you stop firing

630
00:34:47,112 --> 00:34:50,915
at an even number like 180, 60, it will stay hidden.

631
00:34:51,936 --> 00:34:53,617
The clip is invisible until you start firing again.

632
00:34:55,578 --> 00:34:57,580
As soon as you fire, it starts counting again and everything's fine.

633
00:34:58,440 --> 00:35:01,663
Now my head hurts thinking about this gun, but I haven't even gotten into the reload

634
00:35:01,683 --> 00:35:02,083
of this yet.

635
00:35:02,523 --> 00:35:06,646
How do you reload a 120 round weapon that's a hybrid of a coffee grinder and a typewriter?

636
00:35:07,887 --> 00:35:10,449
You use the separation of reload logic by ammo count.

637
00:35:12,451 --> 00:35:12,791
Sort of.

638
00:35:13,531 --> 00:35:15,372
So, we'll start with the easy one.

639
00:35:15,452 --> 00:35:20,894
We need to reload to respond to user input for the first 19 rounds, but there's no room

640
00:35:20,914 --> 00:35:21,434
in the magazine.

641
00:35:22,135 --> 00:35:27,517
So, we set up a straight-ahead animation for reloading 100 to 119 rounds, where you would

642
00:35:27,537 --> 00:35:29,117
pull a clip out that's being fed through.

643
00:35:29,317 --> 00:35:30,378
That makes room for one more.

644
00:35:31,338 --> 00:35:36,500
During the actual pull-out animation, we don't actually reset the sub-phase, but we turn

645
00:35:36,680 --> 00:35:38,101
off the additive layer entirely.

646
00:35:39,673 --> 00:35:43,756
It's not perfect because the clip animation is additive to the rest of the gun, but we

647
00:35:43,796 --> 00:35:47,259
need to disable it exactly then so we never see it slide out on its own.

648
00:35:47,680 --> 00:35:49,241
We ensure the right hand keeps a grip on it.

649
00:35:49,381 --> 00:35:51,323
Basically, it gets turned off right here.

650
00:35:52,704 --> 00:35:54,746
Once you fire 21 rounds, shit gets real.

651
00:35:56,788 --> 00:35:59,850
The whole point of the Perino is to be able to top it up as you fire.

652
00:36:00,671 --> 00:36:02,453
That ability, which would...

653
00:36:03,767 --> 00:36:06,730
That's what the gun was actually meant for, but it only works when deployed on a tripod

654
00:36:06,750 --> 00:36:07,971
because it requires two hands.

655
00:36:08,372 --> 00:36:10,894
That was unfortunately beyond the scope of what we could do.

656
00:36:11,515 --> 00:36:15,599
What we could do though is stack new clips on top of the current magazine once there

657
00:36:15,639 --> 00:36:16,960
was room for at least one.

658
00:36:18,962 --> 00:36:23,106
So to make that work as efficiently as possible, as efficiently as the gun is meant to,

659
00:36:24,523 --> 00:36:29,927
We, meaning Randy, added a parameter to only allow us to load clips and no single bullets.

660
00:36:30,687 --> 00:36:35,170
So what that means is that if you hit reload with 90 rounds left in the magazine, you will

661
00:36:35,190 --> 00:36:37,692
do a quick one clip in reload.

662
00:36:38,412 --> 00:36:42,835
But now you've only got 110 of your full 120 rounds, but you reload much faster.

663
00:36:43,295 --> 00:36:46,677
If you want the whole 120 rounds, you can just hit reload again and you'll play the

664
00:36:46,717 --> 00:36:47,338
last animation.

665
00:36:53,154 --> 00:36:58,200
But really, what we've done is create an optimal strategy for the Perino that matches its real-life design.

666
00:36:59,582 --> 00:37:00,022
When you fired...

667
00:37:01,264 --> 00:37:05,148
The optimal way to reload this gun is when you fired 20 rounds, over 20 rounds, but less than 40.

668
00:37:06,210 --> 00:37:09,634
So this is systemically a start-group-end animation, but that's...

669
00:37:10,254 --> 00:37:13,478
And that's what the game engine thinks is happening here, but that's not really the whole story.

670
00:37:16,563 --> 00:37:22,265
We see the whole story when we reload the gun from 20 rounds, less than 20 rounds.

671
00:37:23,226 --> 00:37:27,367
Because you can't loop the accumulation of bullets, I had to create a sequential or straight

672
00:37:27,387 --> 00:37:29,568
ahead animation and disguise it as a loop.

673
00:37:30,489 --> 00:37:36,151
So even though this is one reload animation, it's broken down in time kind of like loop

674
00:37:36,171 --> 00:37:37,652
variants except in order.

675
00:37:38,752 --> 00:37:43,394
Each clip is equal length and the more clips we load, the earlier in the animation we start

676
00:37:43,434 --> 00:37:43,815
playing it.

677
00:37:45,189 --> 00:37:49,511
Because we're faking the loop to the engine, you can see the ammo count is updating correctly.

678
00:37:51,131 --> 00:37:55,473
So with another bad Photoshop mockup, we see what the animation assets actually look like.

679
00:37:55,733 --> 00:37:57,494
This is just two different animation clips.

680
00:37:59,395 --> 00:38:01,335
Each gold arrow is a start point.

681
00:38:02,256 --> 00:38:06,217
We start at the same entry animation all the time, and then we just enter based on how

682
00:38:06,257 --> 00:38:07,978
many rounds that you need to reload.

683
00:38:08,378 --> 00:38:11,619
The deeper into the magazine you get, the earlier in the reload animation that you start

684
00:38:11,659 --> 00:38:12,000
playing it.

685
00:38:16,037 --> 00:38:20,158
Since each segment of 20 is evenly timed and we set it up with our existing clip logic,

686
00:38:20,658 --> 00:38:22,698
the game sees a straight-ahead animation like this.

687
00:38:25,619 --> 00:38:27,099
We're playing a straight-ahead animation like this.

688
00:38:27,160 --> 00:38:28,100
The game is seeing the loops.

689
00:38:28,940 --> 00:38:33,701
What's especially cool about this is by faking looping group animations, we're actually loading

690
00:38:33,981 --> 00:38:38,202
20 rounds with each clip drop, making this animation interruptible without losing all

691
00:38:38,222 --> 00:38:41,943
your progress, which is especially important for long, light machine gun reloads.

692
00:38:43,523 --> 00:38:48,126
So we see this reload animation play straight through the magazine top up in the ammo count

693
00:38:48,506 --> 00:38:49,427
update as appropriate.

694
00:38:49,987 --> 00:38:54,910
This is the reload from 60 to 80 round reload, or should I say, part of the reload, just

695
00:38:54,930 --> 00:38:56,371
to make it totally clear what's happening.

696
00:38:58,812 --> 00:39:02,955
When you empty the magazine entirely, we use a different reload start animation for that

697
00:39:03,015 --> 00:39:05,877
last clip, the last clip that ejects out.

698
00:39:08,096 --> 00:39:12,259
The new reload start animation gets it back to one clip loaded and racked in the chamber

699
00:39:12,439 --> 00:39:17,943
and then we can use the same long reload animation as before for the next five clips.

700
00:39:19,304 --> 00:39:23,127
We get tricky again this time by hiding the first loop in the longer start animation.

701
00:39:23,587 --> 00:39:27,169
The first loop is actually after, in the engine the first loop is actually playing after the

702
00:39:27,209 --> 00:39:29,971
first clip is loaded and happens during the charging of the bolt.

703
00:39:30,938 --> 00:39:37,896
That allows us to load the first clip and rack the bolt in the start animation with the same time as a single clip loop.

704
00:39:40,935 --> 00:39:43,776
Since I assume there's a lot of animators here, you're probably feeling pretty smart

705
00:39:43,816 --> 00:39:46,736
about noticing that one of these fake loops has a really shitty elbow animation.

706
00:39:47,477 --> 00:39:48,117
And you're totally right.

707
00:39:48,557 --> 00:39:51,618
I'd like to say I put it in there to make sure that you know it's not actually looping,

708
00:39:51,658 --> 00:39:52,238
but I didn't.

709
00:39:52,298 --> 00:39:53,198
It just slipped through.

710
00:39:53,999 --> 00:39:58,040
Were this any other game, I'd just say, that sucks, but I've got the animation database

711
00:39:58,100 --> 00:40:01,021
right there when I'm putting these slides together, so I fixed it.

712
00:40:01,341 --> 00:40:05,362
You can't find this in-game anymore, but I wasn't going to re-render my videos, so sorry.

713
00:40:06,362 --> 00:40:08,823
This is the joy and the agony of live service games.

714
00:40:10,083 --> 00:40:10,323
Anyway.

715
00:40:11,580 --> 00:40:14,041
This is the straight through, here we go,

716
00:40:15,121 --> 00:40:17,182
six clip reload as demonstrated in Maya

717
00:40:18,043 --> 00:40:19,103
with very bad playback.

718
00:40:22,064 --> 00:40:23,865
All kinds of weird stuff happening here.

719
00:40:25,515 --> 00:40:29,116
We hide in the engine, so that's why you're seeing the clips fly all around.

720
00:40:29,196 --> 00:40:34,798
So, similar to the Mosin-Nagant, we have the engine and the player seeing multiple reload animations for different conditions.

721
00:40:35,298 --> 00:40:39,520
In this case, seven different reloads, six ammo counts, and one out of ammo state.

722
00:40:40,100 --> 00:40:42,240
But really, we have one quick reload for the first 20,

723
00:40:43,121 --> 00:40:46,482
and one straight through 100-round reload with five different start points,

724
00:40:46,922 --> 00:40:49,043
and then we have two different start reload animations.

725
00:40:50,237 --> 00:40:54,420
Now that explains the animations, but it still doesn't solve for the re-accumulation of bullets.

726
00:40:55,241 --> 00:40:56,882
Obviously there's got to be some fakery here.

727
00:41:01,325 --> 00:41:05,988
Basically we're keeping the phase set until the first new clip is dropped in, the moment

728
00:41:06,008 --> 00:41:06,488
of impact.

729
00:41:07,149 --> 00:41:09,931
After that, the animation is dictating how full the hopper magazine is.

730
00:41:12,772 --> 00:41:16,753
Because the phase is driven by in-engine ammo count, we need to turn off the phase layer

731
00:41:16,893 --> 00:41:20,455
and drive it with animation to make sure we keep total control of it until we're done.

732
00:41:20,675 --> 00:41:24,057
Otherwise it's going to start updating whenever you see the ammo counter update.

733
00:41:25,557 --> 00:41:29,979
Once the gun has registered the updated ammo count, it's safe to turn the phase, the additive

734
00:41:29,999 --> 00:41:31,000
phase animation back on.

735
00:41:33,101 --> 00:41:35,842
I'm sure there are elements I'm not explaining well enough here, so let me just show you

736
00:41:35,862 --> 00:41:40,264
the whole thing, what it looks like with the box deleted, the ammo box, so you can see

737
00:41:40,304 --> 00:41:41,845
all the great details.

738
00:41:43,525 --> 00:41:45,606
You can see the polygon savings that we were doing there.

739
00:41:46,446 --> 00:41:48,247
This bounced back and forth quite a few times.

740
00:41:51,287 --> 00:41:53,448
Keep in mind that the box is shaped like a V,

741
00:41:53,588 --> 00:41:56,329
so those middle rows that have the outer pieces hidden,

742
00:41:56,369 --> 00:41:57,849
that was just smart modeling.

743
00:42:00,050 --> 00:42:01,910
Let's move into the second, shorter part of the talk,

744
00:42:02,250 --> 00:42:02,571
horses.

745
00:42:03,631 --> 00:42:05,471
One of the most interesting things about World War I

746
00:42:05,531 --> 00:42:08,272
is the clash between the past and the present, future.

747
00:42:09,707 --> 00:42:14,210
One of the most iconic symbols of that is the presence of mounted cavalry in the battlefield.

748
00:42:14,810 --> 00:42:19,653
Stockholm has some incredibly smart and talented animators and engineers, and they got this

749
00:42:19,713 --> 00:42:20,934
working and looking fantastic.

750
00:42:21,454 --> 00:42:25,357
How they did that is beyond the scope of this talk and not really my story to tell, but

751
00:42:25,377 --> 00:42:28,439
I'll be getting into a little bit of it for the purposes of explaining our changes.

752
00:42:29,880 --> 00:42:33,722
So the main game horse is great, but it's built for just two weapons, a lever action

753
00:42:33,762 --> 00:42:35,143
rifle and a cavalry saber.

754
00:42:36,901 --> 00:42:40,384
I wasn't part of this process for making the horse, and I can't really talk about why it's

755
00:42:40,404 --> 00:42:46,189
just two weapons, why it's just those two, except that making others work and look good

756
00:42:46,409 --> 00:42:49,831
in our third-person camera would have been a whole lot more work on an already complicated

757
00:42:49,872 --> 00:42:50,232
system.

758
00:42:50,512 --> 00:42:52,474
And besides, this is essentially a vehicle in the game.

759
00:42:53,174 --> 00:42:55,736
More weapons would be cool, but it certainly wasn't necessary at launch.

760
00:42:57,237 --> 00:43:01,881
But the reason that I'm going to talk about horses is because of an all-new cavalry class

761
00:43:01,901 --> 00:43:03,803
that we decided to add in In the Name of the Tsar.

762
00:43:04,748 --> 00:43:08,511
the Russian Hussar, and with that, a complete new type of weapon, the Lance.

763
00:43:09,312 --> 00:43:13,956
I have shown some of this work in my talk at Consul last year, so I'm going to focus

764
00:43:13,976 --> 00:43:16,238
on the part of the actual under-the-hood details.

765
00:43:17,640 --> 00:43:21,683
For a system that had to be built around two weapons switching between each other, this

766
00:43:21,723 --> 00:43:25,207
was going to require a serious bit of work, even with the least ambitious of designs.

767
00:43:26,098 --> 00:43:29,139
First I'm going to identify the trouble spots and then present the solutions.

768
00:43:30,059 --> 00:43:33,980
A saber and a lance are both things that you hold in one hand, and sometimes for people

769
00:43:34,040 --> 00:43:36,421
outside of animation, that seems like that's good enough.

770
00:43:37,641 --> 00:43:40,322
The thing that non-animators tend to miss is that it doesn't really mean much.

771
00:43:40,522 --> 00:43:43,703
There are a lot of things that you can hold in one hand and not really share the animations.

772
00:43:45,003 --> 00:43:48,344
For the sake of efficiency, we had to share as much as we could.

773
00:43:49,024 --> 00:43:52,265
We dug around and we found four main areas that we needed to address.

774
00:43:56,169 --> 00:44:02,215
running a marathon here. Horse locomotion, this was easy. Don't touch it. I didn't touch

775
00:44:02,255 --> 00:44:07,180
it anyway. Randy, our engineer, did a bunch of physics and code improvements, but they're

776
00:44:07,200 --> 00:44:11,964
all outside of the scope of this talk as well. This is a new weapon, not a new horse, and

777
00:44:12,084 --> 00:44:15,107
that requires advocating to the rest of the team that that is going to be the truth of

778
00:44:15,127 --> 00:44:15,688
the situation.

779
00:44:17,817 --> 00:44:22,660
The old horse is the framework that we needed to work within, which in itself is one of

780
00:44:22,700 --> 00:44:24,361
the challenges of post-launch content.

781
00:44:24,381 --> 00:44:29,104
There's always the temptation to redesign something that's already in and kind of working.

782
00:44:29,304 --> 00:44:33,627
So there are four different gates, or there are different gates for a horse, thanks to

783
00:44:33,667 --> 00:44:39,530
the analog input, and there's also a fifth sprint or all-out gallop that is binary, at

784
00:44:39,570 --> 00:44:41,211
least as far as the player input is concerned.

785
00:44:42,029 --> 00:44:46,732
There's a big range of speed between the canter, the fast walk, and the gallop, the sprint,

786
00:44:47,473 --> 00:44:49,234
but the player couldn't deliberately stay there.

787
00:44:49,354 --> 00:44:51,736
It was just accelerating and decelerating at those speeds.

788
00:44:52,356 --> 00:44:53,477
This will be important later.

789
00:44:55,178 --> 00:44:56,039
Rider locomotion.

790
00:44:56,139 --> 00:44:59,901
This is going to be trickier, because when you think of somebody riding a horse with

791
00:44:59,961 --> 00:45:04,845
a lance, you think of this, or this, but probably both.

792
00:45:06,403 --> 00:45:09,586
So the Saber, on the other hand, could get away with some variation of this pose.

793
00:45:10,086 --> 00:45:13,990
From standing to galloping, so a simple speed-dependent blend space was totally fine.

794
00:45:14,490 --> 00:45:16,332
This isn't a video, it's just an image.

795
00:45:17,933 --> 00:45:20,976
When the whole system is blend-driven, this is going to look really bad for lance poses.

796
00:45:21,256 --> 00:45:25,400
It's going to go up and down like a speedometer as you transition in and out of the gallop.

797
00:45:26,161 --> 00:45:28,223
We could leave the lance always down, but that'd be lame.

798
00:45:29,816 --> 00:45:33,439
The third point was attacks. As anyone who's played Dungeons and Dragons can tell you,

799
00:45:33,860 --> 00:45:36,742
a slashing weapon and a piercing weapon are very different and you're not going to be

800
00:45:36,782 --> 00:45:42,208
able to share that much. The saber has different attacks, it's speed, and they're not dramatically

801
00:45:42,248 --> 00:45:46,612
different. The lance is not only pointy, but it has two different base poses, so it's going

802
00:45:46,632 --> 00:45:47,633
to need some different attacks.

803
00:45:48,854 --> 00:45:52,037
And lastly, it only makes sense that if you have a lance, you need to be able to charge

804
00:45:52,077 --> 00:45:53,078
and impale someone with it.

805
00:45:53,578 --> 00:45:57,201
We already had bayonet charges and synchronized melee attacks, but the horse is, under the

806
00:45:57,242 --> 00:46:00,985
hood, more of a vehicle than a character, so that actually doesn't help us very much

807
00:46:01,025 --> 00:46:01,285
at all.

808
00:46:02,606 --> 00:46:04,988
So let's go back through that list and cover the solutions.

809
00:46:05,809 --> 00:46:06,530
Horse locomotion?

810
00:46:06,970 --> 00:46:07,471
Don't mess with it.

811
00:46:08,692 --> 00:46:09,492
Rider locomotion?

812
00:46:10,233 --> 00:46:11,154
Well, we had to mess with that.

813
00:46:12,212 --> 00:46:16,577
We needed two stances, the lance upright from standing to canter, and then a lance down

814
00:46:16,617 --> 00:46:17,258
at full gallop.

815
00:46:17,779 --> 00:46:21,483
That lets us base the rider locomotion sets on the saber instead of capturing a whole

816
00:46:21,523 --> 00:46:21,923
new set.

817
00:46:22,664 --> 00:46:25,707
We did a mocap shoot for the Hussar, but it was mainly focused on the attacks.

818
00:46:26,208 --> 00:46:29,752
The sword locomotion sets would be fine, as long as we modified the poses.

819
00:46:31,723 --> 00:46:35,406
The second part was to add an override layer on top of everything else that the cavalry

820
00:46:35,446 --> 00:46:36,227
character is running.

821
00:46:36,828 --> 00:46:40,711
It's a layer that's going to usually be off and dormant, but can kick on to play a bespoke

822
00:46:40,752 --> 00:46:45,376
transition animation that's long enough to completely cover the ugly blend of the lance

823
00:46:45,496 --> 00:46:45,556
up...

824
00:46:45,796 --> 00:46:46,197
Oops, sorry.

825
00:46:46,817 --> 00:46:47,458
Sorry, microphone.

826
00:46:48,179 --> 00:46:50,020
Uh, the lance up to the lance down.

827
00:46:51,502 --> 00:46:54,945
with branch out windows that allow it to be interrupted as needed.

828
00:46:55,685 --> 00:46:58,508
This is not an additive layer. Additives were too unpredictable.

829
00:46:58,968 --> 00:47:01,910
Here I'm not trying to plus something, I'm trying to hide it.

830
00:47:02,931 --> 00:47:06,954
This was mostly upper body animation, with partial hip influence that blends out sooner.

831
00:47:08,855 --> 00:47:12,478
Third aspect was the attacks. Based on the solution to the second problem,

832
00:47:13,419 --> 00:47:17,201
we could start the attacks based on your current stance, upright or lowered lance.

833
00:47:19,925 --> 00:47:21,387
I'm sorry for the image quality on these,

834
00:47:21,728 --> 00:47:23,050
I wasn't able to get higher quality ones.

835
00:47:24,472 --> 00:47:26,554
Standing through canter would swing the spear around,

836
00:47:27,195 --> 00:47:28,998
which we learned was actually a valid technique,

837
00:47:29,098 --> 00:47:30,880
thank you Polish ceremonial cavalry.

838
00:47:31,902 --> 00:47:33,504
This lets us use existing framework

839
00:47:33,544 --> 00:47:35,787
for the saber attacks basic combo animations.

840
00:47:37,657 --> 00:47:40,038
Galloping on the other hand would give a quick stab of the lance.

841
00:47:40,659 --> 00:47:45,723
The lance override layer is disabled during all attacks so we don't see the lower or

842
00:47:45,783 --> 00:47:49,145
raise animation and the attack will blend out at the end of whichever stance is running

843
00:47:49,185 --> 00:47:49,626
underneath it.

844
00:47:50,386 --> 00:47:52,428
So a change in speed beneath won't affect these.

845
00:47:53,389 --> 00:47:56,211
The animations will finish and do whatever the correct underlying pose is.

846
00:47:58,272 --> 00:48:00,234
The Impale was the newest and craziest thing.

847
00:48:01,455 --> 00:48:04,977
Charging is triggered like our bayonet charge by hitting the melee attack while already

848
00:48:05,017 --> 00:48:05,358
at speed.

849
00:48:06,213 --> 00:48:09,756
We're using the same input for consistency, but this is a very different system under

850
00:48:09,776 --> 00:48:10,057
the hood.

851
00:48:10,557 --> 00:48:12,138
The horse is, again, a vehicle.

852
00:48:13,279 --> 00:48:17,022
I would and often did argue that it's a dubious gameplay value because you could already run

853
00:48:17,082 --> 00:48:21,986
people over with your horse and it definitely, well, this definitely looks cooler and more

854
00:48:22,006 --> 00:48:23,688
badass for the trailers and the YouTube videos.

855
00:48:24,348 --> 00:48:25,589
This is not trailer fakery.

856
00:48:25,629 --> 00:48:28,732
This is several weeks of mine, Randy, and Colin's life that we're never going to get

857
00:48:28,772 --> 00:48:29,012
back.

858
00:48:30,353 --> 00:48:34,377
But I have to admit it turned out pretty awesome, and including a lance really does beg for

859
00:48:34,397 --> 00:48:34,857
this feature.

860
00:48:36,338 --> 00:48:39,060
To enter this whole new charge state of the horse,

861
00:48:39,340 --> 00:48:41,042
we go back to that same override layer

862
00:48:41,322 --> 00:48:42,603
with a charge entry animation,

863
00:48:43,103 --> 00:48:45,084
but this time we're gonna stay in the override layer,

864
00:48:45,544 --> 00:48:48,126
and we'll stay in this state as long as you're charging.

865
00:48:49,067 --> 00:48:51,428
The rest of the charge states,

866
00:48:51,508 --> 00:48:52,929
including the transitions in and out,

867
00:48:53,310 --> 00:48:56,211
as well as the contact success condition of charging,

868
00:48:56,332 --> 00:48:57,072
also happens here.

869
00:48:58,907 --> 00:49:01,390
Aiming the lance proved to be a fun challenge.

870
00:49:01,891 --> 00:49:05,455
Aiming was really important because we knew we had to interpolate the lance and the victim

871
00:49:05,515 --> 00:49:06,737
upon a successful attack.

872
00:49:07,157 --> 00:49:11,042
The better our lance anticipates that contact, the less we have to move the victim.

873
00:49:12,164 --> 00:49:15,869
We added a new camera state for the charge, which is our weapon designer Chad doing some

874
00:49:15,889 --> 00:49:16,429
of his magic.

875
00:49:18,630 --> 00:49:20,931
Again, apologies for the video quality here.

876
00:49:22,011 --> 00:49:26,913
Aiming the lance for a long time was an additive upper body blend within the override layer,

877
00:49:27,713 --> 00:49:29,534
which is not an override layer.

878
00:49:29,874 --> 00:49:35,435
So there was so much going on in the different states and the different layers that we were

879
00:49:35,455 --> 00:49:37,576
seeing some glitches during the state transitions there.

880
00:49:39,460 --> 00:49:43,643
At the 11th hour, Andy Kanischke, one of our animators on another project using a newer

881
00:49:43,703 --> 00:49:48,927
code base, found a way to aim the bones themselves in engine, an in-engine look at constraint

882
00:49:48,947 --> 00:49:49,287
of sorts.

883
00:49:50,087 --> 00:49:54,490
Steve Chow, one of our animation engineers, integrated this change into our older code

884
00:49:54,510 --> 00:49:58,973
base and they saved our asses from what had been a not great looking aim system.

885
00:50:01,294 --> 00:50:05,597
Now lance aiming can be completely procedural, aiming both the lance and camera towards any

886
00:50:05,637 --> 00:50:06,818
valid target for impaling.

887
00:50:07,218 --> 00:50:11,321
This is deprecating influence down from the spear at one, down the arm, the spine.

888
00:50:13,803 --> 00:50:15,204
Now it can be totally procedural.

889
00:50:15,324 --> 00:50:20,388
So when no one was in range, it's just staying in the neutral aim as dictated by the animation.

890
00:50:20,408 --> 00:50:23,911
And now let's talk about the poor bastard on the receiving end.

891
00:50:25,392 --> 00:50:29,776
As far as the defender goes, this is our regular melee system, but only for the defender.

892
00:50:31,800 --> 00:50:38,522
From a spectator view, without the defender playing animation, this is what's happening

893
00:50:38,562 --> 00:50:39,322
on the engine side.

894
00:50:39,382 --> 00:50:41,683
The horse is scooping up the victim.

895
00:50:42,563 --> 00:50:47,304
The player on the receiving end is getting attached to the end of the lance collision,

896
00:50:47,544 --> 00:50:50,124
minus a little bit because they've just been impaled.

897
00:50:50,144 --> 00:50:55,886
Then it plays a melee defender, except now the player collision and animation is in,

898
00:50:56,006 --> 00:50:58,186
for lack of a better term, horse space.

899
00:50:59,727 --> 00:51:03,928
The exact distance of what constitutes a success or failure here was an exposed value that

900
00:51:03,948 --> 00:51:08,129
took a lot of tuning to look and feel good for the attacker and not feel completely cheap

901
00:51:08,149 --> 00:51:08,709
for the defender.

902
00:51:11,610 --> 00:51:14,311
The end result for a defending player looks something like this.

903
00:51:22,854 --> 00:51:27,415
Of course any game dev knows that the road to success is far from straightforward.

904
00:51:29,217 --> 00:51:30,418
I don't know if this one's going to play.

905
00:51:30,438 --> 00:51:36,404
I should have trimmed that one.

906
00:51:38,747 --> 00:51:40,268
Don't you hate it when people give GDC talks

907
00:51:40,328 --> 00:51:40,989
and make it look easy?

908
00:51:43,672 --> 00:51:44,012
It wasn't.

909
00:51:47,336 --> 00:51:49,038
So that was a lot of information,

910
00:51:49,078 --> 00:51:51,300
and hopefully the images and videos made it digestible.

911
00:51:52,202 --> 00:51:57,047
To recap and wrap this up, we've covered how we added a full new weapons system on top

912
00:51:57,067 --> 00:52:00,931
of an established one, building on a foundation to create something that is new and cool,

913
00:52:01,172 --> 00:52:02,733
but not reinvent the wheel completely.

914
00:52:04,135 --> 00:52:05,456
We've also covered how we took a

915
00:52:07,569 --> 00:52:12,052
system and made it even more capable and we've done justice to hopefully a whole lot of the

916
00:52:12,092 --> 00:52:16,494
fascinating real life weapons that have never been seen before in a video game and may never

917
00:52:16,574 --> 00:52:17,454
be seen in one again.

918
00:52:18,295 --> 00:52:22,917
So that was a bunch of technical gameplay animation stuff and hopefully nobody's feeling

919
00:52:22,937 --> 00:52:26,639
like I deceived them into an animation talk just because my job title is in the word.

920
00:52:28,240 --> 00:52:29,301
This is gameplay animation.

921
00:52:30,822 --> 00:52:34,023
I know I've pretty much just talked about guns and horses here but I don't think that

922
00:52:34,063 --> 00:52:34,964
should be the only takeaway.

923
00:52:37,023 --> 00:52:41,765
I'd like to think these specific examples make a broader argument.

924
00:52:42,365 --> 00:52:46,707
Removing obstacles from your content creators is removing the excuse they have not to go

925
00:52:46,767 --> 00:52:49,267
nuts with their creativity and their attention to detail.

926
00:52:50,108 --> 00:52:53,789
As much as I'd like to claim that this is all because of my incredible attention to

927
00:52:53,829 --> 00:53:00,291
detail or my technical savvy, a lot of this is possible because I either already had the

928
00:53:00,331 --> 00:53:04,192
tools or almost had the tools to do what I needed without convincing anyone else of my

929
00:53:04,232 --> 00:53:04,432
vision.

930
00:53:06,524 --> 00:53:11,387
This was going to say pick your battles, but we've already heard that to the point of meaninglessness.

931
00:53:11,907 --> 00:53:13,028
I prefer think forward.

932
00:53:13,048 --> 00:53:16,050
Are you going to look back and see that all the effort was worth it?

933
00:53:16,690 --> 00:53:19,091
I wasn't asking for code support to fix this gun or that.

934
00:53:19,291 --> 00:53:21,713
I was asking for systems that I could use in the future.

935
00:53:22,273 --> 00:53:27,016
These were specific guns that drove the features and paved the way, but every feature I asked

936
00:53:27,036 --> 00:53:30,017
for and got had at least two potential use cases.

937
00:53:30,578 --> 00:53:31,498
I didn't cover them all here.

938
00:53:32,879 --> 00:53:36,001
And that means that there could potentially be more in the future, and there often were.

939
00:53:37,847 --> 00:53:41,011
Honestly, I'd love to spend the next year just making perfectly accurate recreations

940
00:53:41,052 --> 00:53:44,376
of impossibly complicated weapons because I'm pretty confident with the tools that we've

941
00:53:44,396 --> 00:53:45,858
built that my team could handle it.

942
00:53:47,560 --> 00:53:51,465
It's also possible because I had a lot of freedom and a lot of the experience in the

943
00:53:51,485 --> 00:53:51,926
tool set.

944
00:53:52,787 --> 00:53:55,531
I showed you the first animation I ever did for a Battlefield game and it sucks.

945
00:53:56,456 --> 00:53:59,938
Since then I've shipped four of these things and as of May I'll have been working on the

946
00:53:59,978 --> 00:54:03,899
Battlefield franchise through the gun experience for seven years.

947
00:54:04,940 --> 00:54:08,441
And the things that I can do with the tools at my disposal now are not only a credit to

948
00:54:08,481 --> 00:54:12,783
our tools people, but also a credit to DICE for being the kind of place that I wanted

949
00:54:12,803 --> 00:54:13,403
to keep working at.

950
00:54:14,874 --> 00:54:18,915
So through these examples, I've demonstrated not only the value of data-driven systems,

951
00:54:19,095 --> 00:54:23,257
but also that you can keep building the game, springboarding off of what's already in there

952
00:54:23,377 --> 00:54:24,697
in new and interesting ways.

953
00:54:25,558 --> 00:54:29,899
Adds value for the players, it breaks the monotony of long-tail games, and it's a lot

954
00:54:29,919 --> 00:54:32,440
more satisfying as a developer to still be creative with what you add.

955
00:54:34,280 --> 00:54:38,262
We are hiring, of course, the obligatory plug, dice.se slash jobs.

956
00:54:38,662 --> 00:54:41,183
We have a whole bunch of positions in Stockholm and Los Angeles.

957
00:54:44,051 --> 00:54:45,192
Again, my name is Ryan Duffin.

958
00:54:45,692 --> 00:54:47,393
I'm an animation lead at Dice LA,

959
00:54:47,493 --> 00:54:48,694
and this has been my talk.

960
00:54:50,255 --> 00:54:50,435
Thank you.

961
00:54:50,455 --> 00:54:50,635
Thank you.

962
00:54:50,675 --> 00:54:50,855
Thank you.

963
00:54:50,915 --> 00:54:51,255
Thank you.

964
00:54:51,276 --> 00:54:51,616
Thank you.

965
00:54:51,916 --> 00:54:52,376
Thank you.

966
00:54:52,396 --> 00:54:52,636
Thank you.

967
00:54:52,656 --> 00:54:53,097
Thank you.

968
00:54:53,217 --> 00:54:53,497
Thank you.

969
00:54:53,517 --> 00:54:54,077
Thank you.

970
00:54:54,197 --> 00:54:54,578
Thank you.

971
00:54:54,818 --> 00:54:54,998
Thank you.

972
00:54:55,018 --> 00:54:57,760
Thank you.

973
00:55:01,082 --> 00:55:04,484
I guess we have five minutes for Q&A.

974
00:55:04,924 --> 00:55:05,564
If you have a question,

975
00:55:05,604 --> 00:55:06,765
please come up to one of the microphones.

976
00:55:09,782 --> 00:55:12,883
Oh, and sorry, before, and, that's, microphone's here.

977
00:55:13,003 --> 00:55:15,324
And also, please remember to fill out your surveys.

978
00:55:15,344 --> 00:55:17,605
I know this was also a very competitive time slot,

979
00:55:17,625 --> 00:55:18,965
so hopefully you all liked it.

980
00:55:19,345 --> 00:55:21,006
Sorry, thank you for the talk.

981
00:55:21,266 --> 00:55:23,107
I was just curious, with all those weapons

982
00:55:23,407 --> 00:55:25,087
you keep constantly adding to the game,

983
00:55:25,147 --> 00:55:28,228
do you guys, or each weapon have separate anim sets,

984
00:55:28,288 --> 00:55:30,089
or do you have any sharing animation

985
00:55:30,209 --> 00:55:32,890
to kind of save room, I guess, in the game?

986
00:55:33,530 --> 00:55:35,491
There are a lot of the,

987
00:55:36,796 --> 00:55:37,997
What you're seeing here in first person,

988
00:55:38,057 --> 00:55:39,879
most of that is bespoke animations,

989
00:55:39,959 --> 00:55:42,201
but there's a lot that gets shared by weapon type.

990
00:55:42,461 --> 00:55:43,903
I actually had a whole bit in my talk

991
00:55:43,923 --> 00:55:45,444
that broke down our system for that,

992
00:55:45,965 --> 00:55:46,745
but it was an hour and a half,

993
00:55:46,766 --> 00:55:48,027
so I had to cut it all out.

994
00:55:48,107 --> 00:55:49,568
But basically, like all of the...

995
00:55:50,956 --> 00:55:54,777
most of the weapons are using like the same sprint animation additively and things like

996
00:55:54,817 --> 00:56:00,318
that. We don't do locomotion per weapon, we don't do interaction per weapon, melees are

997
00:56:00,418 --> 00:56:07,380
all, it's a different deploy altogether. So first person is mostly bespoke, deploy and

998
00:56:07,440 --> 00:56:11,901
reload and all that stuff. Third person, most of our, like a normal third person weapon

999
00:56:12,101 --> 00:56:16,643
is seven animations. It's not even seven animations, it's three reload animations and four additive

1000
00:56:16,663 --> 00:56:18,503
poses. So yeah, we share like crazy.

1001
00:56:22,342 --> 00:56:26,024
We share where no one will notice, I should say. Or where it doesn't matter.

1002
00:56:26,044 --> 00:56:33,228
Do you ever use motion capture for the hand animations, or is it just pure skill to do it?

1003
00:56:33,249 --> 00:56:34,049
I'm sorry?

1004
00:56:34,069 --> 00:56:36,471
Do you ever use motion capture to do the hand animations?

1005
00:56:37,071 --> 00:56:47,638
No, no, we've never... Motion capture we use for, um, for the melee attacks. Basically the complex interactions are done with two actors in mocap.

1006
00:56:47,798 --> 00:56:51,660
But for the weapon stuff, we talked about this a little bit on Twitch yesterday, but...

1007
00:56:53,297 --> 00:56:55,198
What I've found is that even if you get,

1008
00:56:56,259 --> 00:56:59,861
we've had access to Navy SEALs in the suit,

1009
00:56:59,881 --> 00:57:00,942
but it doesn't necessarily look right

1010
00:57:00,962 --> 00:57:02,123
from the first person perspective.

1011
00:57:02,663 --> 00:57:03,704
We can put an actor in there,

1012
00:57:03,844 --> 00:57:05,545
and they don't necessarily know how to use the gun.

1013
00:57:06,486 --> 00:57:09,228
So it winds up, there are probably some ways

1014
00:57:09,248 --> 00:57:11,269
that we could start with motion capture and clean it up,

1015
00:57:11,369 --> 00:57:14,071
but it's just more efficient,

1016
00:57:14,191 --> 00:57:15,932
and it gets us the results that we want better

1017
00:57:16,012 --> 00:57:18,234
by using, by just key framing everything.

1018
00:57:20,456 --> 00:57:20,816
Anyone else?

1019
00:57:22,728 --> 00:57:23,179
All right, cool.

