1
00:00:05,174 --> 00:00:08,738
information to cover so let's just hop right into it. My name is Kurt Laude and

2
00:00:08,758 --> 00:00:12,162
I lead the charge for AI and the design side at id Software while Jake Campbell,

3
00:00:12,602 --> 00:00:16,066
you may recall from last year's talk on AI and full-body animation in Doom,

4
00:00:16,406 --> 00:00:19,489
heads up the AI department on the programming side. We're here to talk to

5
00:00:19,509 --> 00:00:22,613
you about push forward combat, the principle that guided the design of Doom.

6
00:00:24,287 --> 00:00:26,809
Now, Push Forward Combat was a guide for all aspects of Doom,

7
00:00:26,949 --> 00:00:29,611
including narrative, level design, player progression.

8
00:00:30,131 --> 00:00:30,932
But in the interest of time,

9
00:00:30,952 --> 00:00:32,733
we're just gonna cover its impact on combat.

10
00:00:33,173 --> 00:00:35,494
To that end, we've broken it down into three key components.

11
00:00:36,155 --> 00:00:38,496
The gameplay loop, the tools available,

12
00:00:38,957 --> 00:00:40,438
and how to create interesting scenarios.

13
00:00:41,158 --> 00:00:42,399
You may have noticed that each section

14
00:00:42,419 --> 00:00:43,480
has a short phrase behind it.

15
00:00:44,048 --> 00:00:46,229
Throughout the project, we constantly checked ourselves

16
00:00:46,269 --> 00:00:47,729
and made course corrections as needed

17
00:00:47,769 --> 00:00:49,630
to ensure that we stayed focused on our design goals.

18
00:00:50,270 --> 00:00:52,591
Associating a phrase or key word with the design

19
00:00:52,611 --> 00:00:54,532
was crucial in reminding us of the original intent

20
00:00:54,592 --> 00:00:55,172
as we iterated.

21
00:00:55,792 --> 00:00:57,433
So without further ado, let's jump right in.

22
00:00:57,453 --> 00:01:01,195
One of the first things done after the final reboot

23
00:01:01,215 --> 00:01:03,135
of Doom 4 was the creation of a mission statement

24
00:01:03,155 --> 00:01:04,076
to set the tone for Doom.

25
00:01:04,816 --> 00:01:06,757
You are the Doom Marine, hell's worst nightmare,

26
00:01:07,037 --> 00:01:09,478
beating back the relentless onslaught of unimaginable evil.

27
00:01:10,278 --> 00:01:12,500
To make sure this mindset was always heated during development,

28
00:01:12,700 --> 00:01:16,443
it was clear a mechanism was needed to check the incoming flow of ideas against.

29
00:01:17,765 --> 00:01:19,506
Thus, Push Forward Combat was born.

30
00:01:20,407 --> 00:01:24,110
This was a response to the previous iterations of Doom 4 that, while awesome in their own way,

31
00:01:24,631 --> 00:01:26,312
didn't capture the feel of the original titles.

32
00:01:27,013 --> 00:01:29,035
To make something truly unique and worthy of the name,

33
00:01:29,155 --> 00:01:31,697
it was clear the game was going to have to step back from modern conventions

34
00:01:32,037 --> 00:01:33,398
and get back to the franchise's roots.

35
00:01:33,939 --> 00:01:36,721
But when we say something isn't Doom enough, what does that actually mean?

36
00:01:38,369 --> 00:01:42,192
We went through a process of asking, what are the best moments and mechanics of Doom as a whole?

37
00:01:42,772 --> 00:01:47,297
Whether it was Doom 1, 2, 3, or the previous versions of 4.

38
00:01:48,037 --> 00:01:52,962
What are the things that resonate with people that constantly come up in discussions of past titles, and why were they special?

39
00:01:54,243 --> 00:01:55,264
And what struck a chord with us?

40
00:01:56,325 --> 00:01:58,407
Moving comically fast, yet still in control.

41
00:01:59,568 --> 00:02:03,211
Opening an unassuming door, only to reveal a horde of teeming monsters hiding behind it.

42
00:02:04,261 --> 00:02:06,383
over-the-top gameplay, and a memorable arsenal

43
00:02:06,443 --> 00:02:08,386
that gleefully allowed one to punish Hell's minions.

44
00:02:09,987 --> 00:02:11,389
Our key takeaway from the classics

45
00:02:11,509 --> 00:02:12,770
is that if you're not moving, you're dead.

46
00:02:13,631 --> 00:02:15,273
To that end, the player restores health

47
00:02:15,313 --> 00:02:17,456
by engaging in combat, not abstaining from it.

48
00:02:18,277 --> 00:02:21,020
Secondly, weaving between projectiles is a lost art,

49
00:02:21,340 --> 00:02:23,222
and it's actually fun enough to power an entire genre.

50
00:02:25,500 --> 00:02:27,842
Now gore, that's actually rewarding player feedback,

51
00:02:27,882 --> 00:02:28,343
not horror.

52
00:02:28,963 --> 00:02:30,845
While Doom was originally labeled a violent game,

53
00:02:31,185 --> 00:02:33,067
it was never in a sadistic or realistic sense.

54
00:02:33,707 --> 00:02:36,169
Doom 1 or 2 fell in the realm of what we call popcorn horror

55
00:02:36,590 --> 00:02:38,351
and channeled B-movie gems like Evil Dead 2

56
00:02:38,551 --> 00:02:39,312
or Army of Darkness.

57
00:02:39,892 --> 00:02:41,314
This was a guiding principle for us

58
00:02:41,374 --> 00:02:43,255
as we took blood and guts to AAA quality.

59
00:02:43,876 --> 00:02:45,797
Never approach saw or hostile type gore

60
00:02:45,817 --> 00:02:46,958
that makes your recoiler wince,

61
00:02:47,339 --> 00:02:49,060
but rather aim for something that really channels

62
00:02:49,080 --> 00:02:50,801
that adolescent glee or gets a snicker out of you.

63
00:02:51,923 --> 00:02:53,684
Now one thing that was contentious is reload.

64
00:02:54,224 --> 00:02:56,986
The argument for it boiled down to two things.

65
00:02:57,426 --> 00:02:58,986
One, we're building a realistic world,

66
00:02:59,427 --> 00:03:01,267
and unless a gun is an energy weapon of some sort,

67
00:03:01,287 --> 00:03:02,048
you expect clips.

68
00:03:02,608 --> 00:03:04,209
And two, the perception that reload

69
00:03:04,289 --> 00:03:05,549
adds to the strategy of combat,

70
00:03:05,929 --> 00:03:07,670
however that is really mired in the entire package

71
00:03:07,690 --> 00:03:10,011
of cover shooters, and yanking out a single mechanic

72
00:03:10,031 --> 00:03:12,152
without its supporting systems

73
00:03:12,612 --> 00:03:13,933
significantly curtails its value.

74
00:03:15,574 --> 00:03:17,294
What finally killed reload was the introduction

75
00:03:17,314 --> 00:03:17,875
of the weapon wheel.

76
00:03:18,505 --> 00:03:20,306
Now, because combat is so fast and frenetic,

77
00:03:20,407 --> 00:03:22,128
a player would immediately switch to another weapon

78
00:03:22,168 --> 00:03:23,188
as soon as their clip emptied,

79
00:03:23,568 --> 00:03:25,389
and they'd eventually cycle through their entire arsenal.

80
00:03:25,950 --> 00:03:28,111
At this point, they would be in full retreat

81
00:03:28,231 --> 00:03:29,392
as they'd ran away from monsters

82
00:03:29,432 --> 00:03:31,173
trying to slowly restock their weapons.

83
00:03:31,753 --> 00:03:32,733
And this is one of those moments

84
00:03:32,754 --> 00:03:33,974
where the game tells you explicitly

85
00:03:34,014 --> 00:03:35,435
what it does and does not want.

86
00:03:36,356 --> 00:03:37,756
I thought this quote summed it up best.

87
00:03:38,137 --> 00:03:39,777
Kratos doesn't stop to reload his chain blades.

88
00:03:42,159 --> 00:03:43,440
How do we make an experience that's true

89
00:03:43,460 --> 00:03:44,220
to the original titles,

90
00:03:44,440 --> 00:03:46,241
but is appealing to a new generation of fans

91
00:03:46,261 --> 00:03:46,941
that never played them?

92
00:03:48,309 --> 00:03:49,389
Now when you think about a shotgun,

93
00:03:49,409 --> 00:03:51,690
the first things that come to mind are close range,

94
00:03:52,070 --> 00:03:53,291
high damage, inaccurate.

95
00:03:53,791 --> 00:03:55,372
For those reasons, it doesn't play well

96
00:03:55,412 --> 00:03:56,712
when you're extending fire from cover.

97
00:03:57,232 --> 00:03:58,853
There's really only one way to play a shotgun,

98
00:03:58,873 --> 00:04:00,173
and that's by charging straight ahead.

99
00:04:00,834 --> 00:04:03,214
Thus, the hero's weapon is basically mid-range melee.

100
00:04:04,035 --> 00:04:05,695
We found a lot of common ground with brawlers,

101
00:04:05,935 --> 00:04:07,356
such as exaggerated AI tells

102
00:04:07,396 --> 00:04:08,836
and encourage players to dodge or counter them.

103
00:04:10,017 --> 00:04:11,277
AI behavior that's predictable

104
00:04:11,357 --> 00:04:12,878
and easy to grasp on first glance.

105
00:04:13,798 --> 00:04:15,899
Crowd control systems, such as fight circles,

106
00:04:15,979 --> 00:04:17,540
pain locks, and active attacker count.

107
00:04:18,262 --> 00:04:20,664
And lastly, finishing moves to reward player ability.

108
00:04:22,085 --> 00:04:23,346
Ideas were starting to flow like crazy,

109
00:04:23,366 --> 00:04:24,527
and it was clear we needed to filter.

110
00:04:25,448 --> 00:04:26,729
This was dubbed Push Forward Combat.

111
00:04:26,749 --> 00:04:28,871
Its mission was to make sure anything added to the game

112
00:04:29,231 --> 00:04:30,873
adhered to the core pillars of the franchise.

113
00:04:31,753 --> 00:04:34,556
Speed of movement, individuality of the demons,

114
00:04:35,176 --> 00:04:36,357
distinctiveness of the weapons,

115
00:04:36,878 --> 00:04:38,078
and the sheer power of the player.

116
00:04:39,480 --> 00:04:41,701
This image illustrates Push Forward Combat in action.

117
00:04:42,322 --> 00:04:43,743
Double jump was a great addition to the game

118
00:04:43,783 --> 00:04:45,244
because it increased player mobility

119
00:04:45,605 --> 00:04:46,726
and allowed you to close the distance

120
00:04:46,746 --> 00:04:47,746
from an even farther range.

121
00:04:48,441 --> 00:04:51,304
Reload, on the other hand, briefly made the player unable to attack

122
00:04:51,364 --> 00:04:53,086
and forced us to disengage from combat.

123
00:04:53,806 --> 00:04:56,309
We trimmed a lot of features because we don't necessarily want the player

124
00:04:56,329 --> 00:04:58,351
to have multiple avenues to accomplish their goals.

125
00:04:59,072 --> 00:05:00,573
Doom is meant to be played a certain way

126
00:05:00,733 --> 00:05:03,216
because you're the Doom Marine and you're here to punish Hell's minions.

127
00:05:04,577 --> 00:05:06,439
So now that push-forward combat was firmly in place,

128
00:05:06,459 --> 00:05:08,181
we were able to produce a previs animatic

129
00:05:08,201 --> 00:05:10,583
to help everyone understand what the gameplay loop could be.

130
00:05:37,720 --> 00:05:39,081
Now it was time to make this a reality.

131
00:05:39,762 --> 00:05:41,323
This sentence summed up our goals perfectly.

132
00:05:41,623 --> 00:05:43,084
Make me think, make me move.

133
00:05:45,085 --> 00:05:46,946
Push forward combat gave us Combat Chess,

134
00:05:47,226 --> 00:05:48,547
our name for Doom's gameplay loop.

135
00:05:49,087 --> 00:05:51,409
The four building blocks of this are constant movement,

136
00:05:51,969 --> 00:05:54,090
sizing up foes, improvisation,

137
00:05:54,250 --> 00:05:56,112
both with your weapon and how you navigate,

138
00:05:56,612 --> 00:05:58,293
and lastly, putting the enemy on their heels.

139
00:05:59,334 --> 00:06:00,995
We viewed enemies as combat puzzles,

140
00:06:01,155 --> 00:06:03,756
and the solution was the arena, your arsenal,

141
00:06:03,856 --> 00:06:05,097
and how you chose to engage them.

142
00:06:06,384 --> 00:06:07,885
So what's unique about combat chess?

143
00:06:09,426 --> 00:06:11,108
Well, for one, we don't have a front.

144
00:06:11,148 --> 00:06:13,050
It's 360-degree combat, which is very different

145
00:06:13,070 --> 00:06:13,770
from modern shooters.

146
00:06:14,571 --> 00:06:16,293
What we did because of this was we actually

147
00:06:16,333 --> 00:06:18,254
saw we had more in common with MP map design

148
00:06:18,415 --> 00:06:19,255
than we did single player.

149
00:06:20,136 --> 00:06:21,838
Now, AI, they can attack from any direction,

150
00:06:21,918 --> 00:06:24,080
and they have the same accuracy parameters on and off screen.

151
00:06:24,560 --> 00:06:26,722
So it's important that the arena can actually protect the player.

152
00:06:27,203 --> 00:06:28,524
There's very few props in our world

153
00:06:28,604 --> 00:06:29,765
as the feeling of skilled movement

154
00:06:29,805 --> 00:06:31,466
trumps any sort of environmental storytelling.

155
00:06:32,564 --> 00:06:34,326
Since combat is designed for medium range,

156
00:06:34,547 --> 00:06:36,109
creative line of sight blockers are crucial.

157
00:06:36,729 --> 00:06:38,431
Half walls were actually our secret weapon

158
00:06:38,812 --> 00:06:40,254
since they're impossible to miss a jump

159
00:06:40,314 --> 00:06:42,076
as single jump will hit it and mantle you over,

160
00:06:42,456 --> 00:06:44,379
while a well-timed double jump lets you clear it cleanly.

161
00:06:45,660 --> 00:06:47,663
Bruce Lee on a skateboard with a shotgun

162
00:06:47,823 --> 00:06:49,725
is a phrase that we use to describe arena combat.

163
00:06:50,430 --> 00:06:53,112
Its importance can't be understated because the right size arena,

164
00:06:53,573 --> 00:06:56,314
with just the right amount of space, actually makes the player feel faster.

165
00:06:56,875 --> 00:06:58,836
See, while the Doom arena is exceptionally fast,

166
00:06:59,236 --> 00:07:01,878
your acceleration and your agility actually exceed your top speed.

167
00:07:02,439 --> 00:07:03,860
So in order to feel fast in Doom,

168
00:07:04,340 --> 00:07:06,361
it actually comes from the speed at which you pass Geo,

169
00:07:06,842 --> 00:07:08,903
change direction, and weave between other monsters.

170
00:07:09,583 --> 00:07:12,425
There's a lot of oscillation on player speed until we nail the arena building,

171
00:07:12,485 --> 00:07:15,167
since right size spaces make you feel exceptionally fast,

172
00:07:15,588 --> 00:07:16,688
yet still in control of the player.

173
00:07:18,487 --> 00:07:20,189
To that end, players need to move with purpose.

174
00:07:20,589 --> 00:07:25,173
As stated above, MP map design hinges on repeated traversal of a space with clear navigation options.

175
00:07:26,354 --> 00:07:28,735
Humans are excellent at making split-second binary decisions,

176
00:07:29,096 --> 00:07:31,237
but when you add four or five options, it starts to get dicey.

177
00:07:31,738 --> 00:07:34,360
Players start evaluating the pros and cons of each route on the fly,

178
00:07:34,760 --> 00:07:39,324
and that simply won't happen in an F-22 Ferrari, which was our internal name for the Doom Marine in combat.

179
00:07:40,492 --> 00:07:41,994
Lastly, we tried all sorts of layouts,

180
00:07:42,034 --> 00:07:43,956
but circles were one that just never panned out for us.

181
00:07:44,696 --> 00:07:46,938
It's a symmetrical shape, which makes options unclear,

182
00:07:47,519 --> 00:07:49,841
has limited lateral movement, and AI often

183
00:07:49,881 --> 00:07:51,943
take the same route, resulting in the player and the AI just

184
00:07:51,983 --> 00:07:52,884
chasing after each other.

185
00:07:53,805 --> 00:07:56,027
Racing games have to solve landmarking at 200 miles

186
00:07:56,067 --> 00:07:58,089
an hour, and they realize the power of asymmetry.

187
00:07:59,831 --> 00:08:01,072
Here's our movement map in action,

188
00:08:01,132 --> 00:08:03,154
which is our testing bed for player mechanics and arena

189
00:08:03,174 --> 00:08:03,434
design.

190
00:08:18,097 --> 00:08:19,819
These right here are the half walls I'm talking about,

191
00:08:19,859 --> 00:08:21,580
and this is actually a full double jump gap.

192
00:08:24,162 --> 00:08:26,244
Now, since attacks aren't limited to a pie slice,

193
00:08:26,364 --> 00:08:28,406
players must be able to dodge out in the open.

194
00:08:29,247 --> 00:08:30,528
So what we do is enemy accuracy

195
00:08:30,628 --> 00:08:32,069
actually adjusts to player movement speed.

196
00:08:32,550 --> 00:08:34,311
If you're doing what we ask and going full tilt,

197
00:08:34,391 --> 00:08:35,552
then the AI purposely miss.

198
00:08:35,933 --> 00:08:37,014
Well, if you stop or doddle,

199
00:08:37,054 --> 00:08:38,215
you need to be smacked on the wrist.

200
00:08:39,123 --> 00:08:41,344
Projectiles allow us to prompt more player responses

201
00:08:41,364 --> 00:08:42,204
than hitscan attacks.

202
00:08:42,845 --> 00:08:44,845
Aside from simply sidestepping or using Geo,

203
00:08:44,905 --> 00:08:47,886
you can also jump, duck, weave, shoot them,

204
00:08:48,327 --> 00:08:50,167
or generate friendly fire with an errant toss.

205
00:08:50,707 --> 00:08:52,108
The latter is particularly important to us

206
00:08:52,168 --> 00:08:54,469
because enemy infighting is core to Demon characterization.

207
00:08:55,729 --> 00:08:57,630
Now, third-person action was treating us really well,

208
00:08:57,770 --> 00:08:58,870
and so a take on backstab

209
00:08:58,890 --> 00:09:00,190
was briefly part of the combat loop.

210
00:09:00,911 --> 00:09:02,611
Light Z targeting was active by default,

211
00:09:02,671 --> 00:09:04,652
and as you attacked, a meter on the HUD would change color.

212
00:09:05,232 --> 00:09:07,493
Once it turned orange, you could instantly swing behind foes

213
00:09:07,973 --> 00:09:08,953
to do some bonus damage.

214
00:09:09,383 --> 00:09:11,205
While if it turned red, you were allowed to dash into them

215
00:09:11,245 --> 00:09:12,026
and do an insta-jib.

216
00:09:27,138 --> 00:09:28,980
Now there are a number of issues with this, such as

217
00:09:29,400 --> 00:09:32,583
sacrifice and smooth movement, sudden view shifts, and now

218
00:09:32,603 --> 00:09:33,964
you're having to do HUD meter management.

219
00:09:34,504 --> 00:09:36,586
But it did teach us what's too brawler and

220
00:09:36,626 --> 00:09:37,266
not enough shooter.

221
00:09:38,542 --> 00:09:42,425
Most importantly, that taught us shooting foes behind was not particularly empowering,

222
00:09:42,866 --> 00:09:46,268
and it's far more satisfying to put your hands on enemies and demonstrate your brute force.

223
00:09:59,798 --> 00:10:03,599
A flashy AoE attack in a box map is truly a sight to behold,

224
00:10:04,019 --> 00:10:05,940
but once they were transferred to a combat space

225
00:10:05,960 --> 00:10:08,180
with real art, props, and other AI,

226
00:10:08,280 --> 00:10:09,980
it would either light up the allies

227
00:10:10,061 --> 00:10:11,761
or more effectively than foes,

228
00:10:12,241 --> 00:10:13,721
or worse, the player would just zip right by them

229
00:10:13,741 --> 00:10:14,421
and not even notice.

230
00:10:15,242 --> 00:10:18,542
Our litmus test for AI attacks during reviews was,

231
00:10:19,062 --> 00:10:20,243
would the player actually notice this

232
00:10:20,283 --> 00:10:22,103
flying around the arena in the F-22 Ferrari?

233
00:10:22,683 --> 00:10:24,583
See, projectiles, they're basically incoming traffic

234
00:10:24,623 --> 00:10:26,424
in a racing game and capture that feeling

235
00:10:26,444 --> 00:10:27,304
of a blur wishing by.

236
00:10:28,300 --> 00:10:30,702
Now imagine certain cars randomly blow up on the highway.

237
00:10:31,082 --> 00:10:33,223
Worse, the AI can target those cars too.

238
00:10:33,863 --> 00:10:36,125
Suddenly weaving between blurs is no longer so smooth

239
00:10:36,165 --> 00:10:37,465
since you need to check their model first.

240
00:10:39,607 --> 00:10:41,247
Now Doom, it's designed to make you feel

241
00:10:41,267 --> 00:10:42,708
like you're up against overwhelming odds.

242
00:10:43,169 --> 00:10:44,849
But in reality, the enemies are balanced such

243
00:10:44,869 --> 00:10:46,650
that the Doom ring can easily handle them one-on-one.

244
00:10:47,211 --> 00:10:48,652
The secret to selling this fantasy is

245
00:10:49,472 --> 00:10:50,773
having enemies hold their positions

246
00:10:51,053 --> 00:10:52,854
so it's on the player to rush forward and engage them,

247
00:10:53,774 --> 00:10:55,175
limit the amount of active attackers

248
00:10:55,315 --> 00:10:56,496
so the player isn't overwhelmed.

249
00:10:57,511 --> 00:10:59,292
grant the arsenal the ability to interrupt

250
00:10:59,392 --> 00:11:01,093
and lock down enemies if properly used.

251
00:11:01,793 --> 00:11:03,774
The result is players now prioritize engagement

252
00:11:03,814 --> 00:11:05,975
on the battlefield, hone in on who they perceive

253
00:11:05,995 --> 00:11:07,095
to be the most imminent threat,

254
00:11:07,476 --> 00:11:08,396
and then move down the line.

255
00:11:09,897 --> 00:11:12,578
We tried out player AOE via various shockwave attacks,

256
00:11:12,978 --> 00:11:14,679
but these don't come off well in first person.

257
00:11:15,359 --> 00:11:17,480
Worse, a magic ring that shoves the AI back

258
00:11:17,680 --> 00:11:19,181
pales in comparison to the physicality

259
00:11:19,201 --> 00:11:20,501
of actually putting your hands on enemies.

260
00:11:22,513 --> 00:11:25,575
The Interrupt or Parry Strike is rarely a finishing blow in a martial arts film.

261
00:11:26,095 --> 00:11:30,437
Thus, we needed a simple hierarchy of enemy control states before you actually deliver the coup de grace.

262
00:11:31,258 --> 00:11:34,559
The first one is Twitch, where the enemy plays a reaction but it doesn't impede combat.

263
00:11:35,460 --> 00:11:38,701
Second is Falter, which stops the current anim and makes them restart combat.

264
00:11:39,402 --> 00:11:42,123
And last is Stagger, which briefly takes an AI out of the fight.

265
00:11:42,583 --> 00:11:44,464
This also allows a glory kill to be performed.

266
00:11:45,649 --> 00:11:47,651
These three states are sufficient for most cases,

267
00:11:48,051 --> 00:11:50,633
but we did find a need for intermediary items for AI

268
00:11:50,653 --> 00:11:53,355
that have a lot of hit points or are susceptible to pain lock,

269
00:11:53,415 --> 00:11:53,976
like the revenant.

270
00:11:54,656 --> 00:11:56,898
They still serve the same function as the associated class,

271
00:11:57,319 --> 00:11:59,741
but they make the AI appear more responsive to player actions.

272
00:12:00,781 --> 00:12:02,523
Lastly, we give AI a second wind

273
00:12:02,543 --> 00:12:03,584
if you let them out of stagger.

274
00:12:04,244 --> 00:12:05,645
Monsters always need to be dangerous,

275
00:12:05,725 --> 00:12:07,407
and this was a fun risk-reward mechanic

276
00:12:07,447 --> 00:12:09,629
since the glory kills have such a high payout for the player.

277
00:12:11,030 --> 00:12:12,611
Here's a short clip of those states in action

278
00:12:12,651 --> 00:12:13,171
on the Mancubus.

279
00:12:25,829 --> 00:12:28,911
Now in the original title, the shotgun was multipurpose and you could play the whole

280
00:12:28,951 --> 00:12:29,311
game with it.

281
00:12:29,912 --> 00:12:32,634
So we wanted to dial in the player's arsenal and start thinking of them as tools.

282
00:12:33,655 --> 00:12:38,059
For example, the combat shotgun in our version of Doom is short to medium range, decent spread,

283
00:12:38,099 --> 00:12:39,420
and has a high chance of stagger.

284
00:12:39,920 --> 00:12:45,585
While the super shotgun is only close range, has massive spread, and often overkills foes.

285
00:12:46,723 --> 00:12:49,125
Weapon mods allow the player to tweak a tool's behavior,

286
00:12:49,345 --> 00:12:50,766
such as triple burst tightening spread

287
00:12:50,906 --> 00:12:51,747
and lowering falloff,

288
00:12:52,107 --> 00:12:53,989
which now gives you a strong medium range shotgun,

289
00:12:54,429 --> 00:12:56,271
while pop rockets turned into grenade launchers

290
00:12:56,291 --> 00:12:57,752
so you can give players a long range version.

291
00:12:59,414 --> 00:13:01,215
Through play testing, we found certain weapons

292
00:13:01,255 --> 00:13:02,877
felt natural against AI archetypes,

293
00:13:02,897 --> 00:13:04,358
and we actually hard-coded responses.

294
00:13:05,359 --> 00:13:07,160
The imp's greatest asset is its agility,

295
00:13:07,180 --> 00:13:08,521
so the HAR was a guaranteed way to say,

296
00:13:08,561 --> 00:13:09,382
hey, stop moving.

297
00:13:10,415 --> 00:13:11,716
Glory kills, they're new to Doom,

298
00:13:11,776 --> 00:13:12,837
and the best way to teach them

299
00:13:12,877 --> 00:13:15,139
was to make your default weapon, the combat shotgun,

300
00:13:15,599 --> 00:13:17,841
very stagger-friendly on fodder.

301
00:13:18,541 --> 00:13:21,023
Thus, falloff is severe to prevent overkill on weak ones,

302
00:13:21,083 --> 00:13:22,144
like the imp and the zombies,

303
00:13:22,584 --> 00:13:24,486
and we also circumvent the standard hit point check

304
00:13:24,526 --> 00:13:25,266
remaining on the soldiers

305
00:13:25,286 --> 00:13:27,008
to make it very likely you'll trigger it.

306
00:13:28,169 --> 00:13:29,490
Now, we did try having the chaingun

307
00:13:29,550 --> 00:13:31,051
instantly pain lock the cacodemon

308
00:13:31,091 --> 00:13:32,672
as a fun Easter egg for fans of the originals,

309
00:13:33,112 --> 00:13:34,133
but that was one of those moments

310
00:13:34,153 --> 00:13:35,694
where it feels like the wrong kind of retro,

311
00:13:35,754 --> 00:13:37,195
and the modern AI just feels broken.

312
00:13:39,005 --> 00:13:40,966
It was clear from the beginning that resource replenishment

313
00:13:41,006 --> 00:13:42,067
needed to be part of the core loop.

314
00:13:42,627 --> 00:13:44,448
We took inspiration from action RPGs

315
00:13:44,468 --> 00:13:45,689
where you kill, search, continue,

316
00:13:46,249 --> 00:13:47,570
as well as the original soldier class,

317
00:13:47,590 --> 00:13:50,231
which were walking health packs in Doom 1 and 2.

318
00:13:51,512 --> 00:13:53,793
Secondly, we found hit point drops,

319
00:13:53,813 --> 00:13:54,694
they need to rubber band,

320
00:13:54,874 --> 00:13:56,215
so that way the player's not discouraged

321
00:13:56,235 --> 00:13:57,396
from engaging at low hit points.

322
00:13:57,996 --> 00:14:00,377
To that end, heavy characters actually dole out more rewards

323
00:14:00,457 --> 00:14:02,338
to incentivize tackling the most challenging foe

324
00:14:02,378 --> 00:14:03,299
while you're in dire straits.

325
00:14:04,500 --> 00:14:06,401
Ammo, on the other hand, cannot rubber band.

326
00:14:07,301 --> 00:14:09,742
See, tools are useless if you can use the same one the entire game.

327
00:14:10,482 --> 00:14:14,083
To add an additional layer of strategy, we actually had ammo shared amongst tool categories.

328
00:14:15,803 --> 00:14:20,364
Now, while enemies, they can drop any ammo type, we actually introduced a slight bias towards dropping shells

329
00:14:20,884 --> 00:14:24,045
and against rockets, since combat is designed for close to medium range.

330
00:14:25,125 --> 00:14:28,386
It's important to reward aggressive play, so glory kills increase drop amount.

331
00:14:29,006 --> 00:14:32,207
Most importantly, though, they always drop something, even if you're topped off.

332
00:14:33,047 --> 00:14:35,328
And lastly, we had to find a role for the chainsaw.

333
00:14:38,655 --> 00:14:42,018
Now, the chainsaw is prominently featured in many fans' recollections of Doom 1 and 2,

334
00:14:42,478 --> 00:14:45,440
but we had the hardest time figuring out how we're actually going to integrate this into combat chest.

335
00:14:46,601 --> 00:14:52,006
Now, the pistol was a late addition to the game, so the chainsaw for the longest time was actually your original infinite ammo fallback weapon.

336
00:14:52,546 --> 00:14:55,488
Much like the original game, you would touch AI with it to do continuous damage.

337
00:14:56,429 --> 00:15:00,673
Problem is, that felt like the wrong kind of retro, and once the pistol came on board, its role was redundant.

338
00:15:01,861 --> 00:15:05,863
Next, we tried a non-fatal sync where you'd actually pain lock the AI and inflict big damage.

339
00:15:06,583 --> 00:15:12,906
Should that prove successful, it blends to a cool finishing move, otherwise you disengage and the fight continues anew.

340
00:15:13,646 --> 00:15:16,908
We then added a mini-game to circumvent however many hit points the monster had

341
00:15:17,348 --> 00:15:19,969
and allow an instant kill if the player was sufficient at controlling the blade.

342
00:15:20,909 --> 00:15:25,431
Like Backstab before, focusing on a HUD prompt in combat was very distracting and often fatal.

343
00:15:27,272 --> 00:15:30,233
The aha moment actually came for us thanks to the Mancubus chest glory kill.

344
00:15:31,588 --> 00:15:34,870
Now see, this animation is quite long, and many times a player at low health would get

345
00:15:34,910 --> 00:15:37,330
killed waiting for them to finally explode and dole out the drops.

346
00:15:38,011 --> 00:15:42,012
We added an anim event to force the drops early, but this had the unintended consequence

347
00:15:42,052 --> 00:15:44,493
of doing double drops, creating a piñata-like visual.

348
00:15:45,693 --> 00:15:48,934
That ignited the spark of purpose, though, and gave us the thought that Chainsaw could

349
00:15:48,974 --> 00:15:51,995
create an ammo piñata on any enemy, replenishing your resources.

350
00:15:53,013 --> 00:15:57,939
We then lowered drop rates, started removing ammo crates from the game, and gave it a currency to prevent abuse.

351
00:15:58,479 --> 00:16:00,561
But we also wanted to make players think about who they use it on.

352
00:16:01,182 --> 00:16:03,344
See, targeting fodder is the most fuel-efficient approach.

353
00:16:03,885 --> 00:16:07,729
However, it's very tempting to use a chainsaw on a challenging adversary because it's a guaranteed glory kill.

354
00:16:08,790 --> 00:16:14,076
By making fuel a rare currency, it was now something that was an enticing reward for level designers to place around the maps.

355
00:16:15,281 --> 00:16:18,182
Lastly, since the chainsaw was now part of natural replenishment,

356
00:16:18,543 --> 00:16:20,284
the player needed to be able to access it immediately.

357
00:16:20,924 --> 00:16:22,164
Thus, we took it out of the weapon wheel

358
00:16:22,204 --> 00:16:23,965
and we mapped it to a face button on the controller.

359
00:16:26,106 --> 00:16:28,448
When it comes to AI design, our motto is kind of,

360
00:16:28,568 --> 00:16:30,229
get you a monster that can do, oh, actually,

361
00:16:30,269 --> 00:16:31,749
we just want you to do one thing really, really well.

362
00:16:33,210 --> 00:16:34,731
We called them Swiss Army Knives at first,

363
00:16:34,831 --> 00:16:36,912
because AI, they're originally designed to handle anything,

364
00:16:37,012 --> 00:16:38,733
so that way they could fight solo and look good doing it.

365
00:16:39,633 --> 00:16:41,294
The AI also had lots of cinematic flair,

366
00:16:41,314 --> 00:16:43,775
such as injured movesets, elaborate death animations,

367
00:16:43,875 --> 00:16:44,836
and coordinated attacks.

368
00:16:45,984 --> 00:16:48,065
The problem is monster count is the pillar of the franchise,

369
00:16:48,385 --> 00:16:50,246
and we've already identified battlefield management

370
00:16:50,286 --> 00:16:51,286
as core to combat chess.

371
00:16:52,087 --> 00:16:54,248
Thus, Doom needs to be about celebrating the player,

372
00:16:54,648 --> 00:16:56,609
and the AI are there to support the power of fantasy.

373
00:16:58,049 --> 00:16:59,930
See, players don't have time to appreciate the view in Doom

374
00:16:59,950 --> 00:17:01,411
because all the systems have been designed

375
00:17:01,431 --> 00:17:02,091
to keep you moving.

376
00:17:02,771 --> 00:17:05,192
By the time an AI has executed an intricate behavior,

377
00:17:05,592 --> 00:17:06,833
the players either shot them to death

378
00:17:06,873 --> 00:17:07,933
or moved on to the next foe.

379
00:17:08,874 --> 00:17:10,714
Thus, the AI, they need to be straightforward enough

380
00:17:10,734 --> 00:17:12,455
that players can describe them in a single sentence.

381
00:17:13,523 --> 00:17:15,925
AI also need to be thought of as ingredients, not an entree.

382
00:17:16,145 --> 00:17:18,127
It's how you put them together that makes a tasty dish.

383
00:17:19,528 --> 00:17:22,031
Lastly, since crowd control is crucial to combat chess,

384
00:17:22,511 --> 00:17:24,113
players need to be confident their tools will work.

385
00:17:24,633 --> 00:17:26,835
The Doom Marine always has the advantage in solo combat,

386
00:17:27,155 --> 00:17:29,558
but it's how they approach the crowd that determines success or failure.

387
00:17:30,498 --> 00:17:32,620
We had 16 different AI archetypes in the game,

388
00:17:32,640 --> 00:17:33,581
so I'm not going to go over all of them,

389
00:17:33,922 --> 00:17:35,143
but I did want to touch on two of them.

390
00:17:35,603 --> 00:17:38,606
Both of these are legacy characters that deviate from the original implementation.

391
00:17:39,518 --> 00:17:43,582
But I feel they capture the spirit of the AI and show our approach to both ranged units and melee units.

392
00:17:44,863 --> 00:17:45,564
First one is the Imp.

393
00:17:46,225 --> 00:17:49,088
We call them our Archer class, and while their ability suite is rather limited,

394
00:17:49,488 --> 00:17:51,911
they form the core of Doom simply because of what they taught the player.

395
00:17:54,013 --> 00:17:56,575
Push forward combat really clicked for us when this AI was introduced

396
00:17:56,956 --> 00:17:59,759
because counterattacking felt natural for a slow arcing projectile.

397
00:18:00,319 --> 00:18:03,142
Their small size and jumpy nature also made players chase after them.

398
00:18:04,183 --> 00:18:06,245
The addition of a fastball was a game changer for us.

399
00:18:07,025 --> 00:18:08,947
Just like a good pitcher needs some off-speed stuff,

400
00:18:09,047 --> 00:18:11,169
the imp's behavior immediately went from repetitive to robust.

401
00:18:12,030 --> 00:18:14,072
They now taught the player how to dodge both the slowest

402
00:18:14,272 --> 00:18:15,733
and fastest projectiles in the game.

403
00:18:16,614 --> 00:18:18,575
Most importantly, they stood still and cooked their power

404
00:18:18,596 --> 00:18:21,278
attack, which now told players, hey, you should interrupt him

405
00:18:21,318 --> 00:18:22,799
rather than actually waiting for them to strike,

406
00:18:23,400 --> 00:18:24,701
waiting for them to go and then counter them.

407
00:18:26,022 --> 00:18:27,784
Hangouts further reinforced threat management.

408
00:18:28,304 --> 00:18:30,446
Should imps be left alone in an advantageous area,

409
00:18:30,807 --> 00:18:32,468
they'd climb the space and enter a heightened state

410
00:18:32,849 --> 00:18:34,650
where they had a stronger bias towards fastballs,

411
00:18:35,371 --> 00:18:36,412
shorter attack cooldown,

412
00:18:36,893 --> 00:18:38,654
and now they could no longer be faltered or staggered.

413
00:18:40,296 --> 00:18:41,197
Next up is a Pinky.

414
00:18:41,797 --> 00:18:42,818
They brought what the player learned

415
00:18:42,838 --> 00:18:45,261
about dodging projectiles to the melee class,

416
00:18:45,681 --> 00:18:47,963
but added a new wrinkle as they were not another heavy

417
00:18:48,003 --> 00:18:49,224
that you simply pointed your weapon at

418
00:18:49,264 --> 00:18:50,085
and shot till they died.

419
00:18:52,165 --> 00:18:53,726
See, when Doom was released, a number of outlets,

420
00:18:53,746 --> 00:18:55,047
they paid us a tremendous compliment

421
00:18:55,067 --> 00:18:56,388
of saying we felt like a Nintendo game,

422
00:18:56,448 --> 00:18:57,169
despite the violence.

423
00:18:57,729 --> 00:19:00,151
We took that as being intuitive, easy to pick up,

424
00:19:00,632 --> 00:19:02,153
and always putting fun first,

425
00:19:02,253 --> 00:19:04,655
as they're not afraid to embrace being a game.

426
00:19:05,636 --> 00:19:07,677
To that end, we made the entire back the weak spot,

427
00:19:07,737 --> 00:19:08,438
not just the tail.

428
00:19:09,018 --> 00:19:10,640
This avoided looking down in first person

429
00:19:10,700 --> 00:19:13,042
and requiring precision shots in an F-22 Ferrari.

430
00:19:14,122 --> 00:19:15,303
We started out with Couch Pinky,

431
00:19:15,383 --> 00:19:16,504
which was a charging loveseat

432
00:19:16,524 --> 00:19:17,645
with a big red button on the back.

433
00:19:18,347 --> 00:19:21,010
Players got it immediately, but one of our pillars is cutting-edge graphics,

434
00:19:21,510 --> 00:19:24,634
and so it took us nearly nine months of iteration to make a visually acceptable,

435
00:19:25,054 --> 00:19:27,817
big red button that works in a PBR, high-fidelity world.

436
00:19:28,798 --> 00:19:30,900
We tried several unarmored versions during the stretch,

437
00:19:31,320 --> 00:19:34,103
but there's no longer any game to the charge and the Pinky just lost its purpose.

438
00:19:34,784 --> 00:19:36,385
While some may find the armor frustrating,

439
00:19:36,766 --> 00:19:38,808
it taught us that compromise to make everyone happy

440
00:19:38,968 --> 00:19:41,250
doesn't jive with a game that's designed to be played a certain way.

441
00:19:42,417 --> 00:19:47,063
Lastly, the ideal charger scenario, corridors and long hallways, they rarely occur in our game.

442
00:19:47,543 --> 00:19:51,608
Thus, Pinky is one of the few AI that can attack while traversing gaps in the nab mesh

443
00:19:52,169 --> 00:19:58,196
or pathing through smaller AI. I'm surrounded by 10 enemies and I size them up based on how

444
00:19:58,216 --> 00:20:02,000
they look and what I do, what I know they do. This is basically our approach to encounter design.

445
00:20:03,394 --> 00:20:05,576
Initially, all our lockdowns were traditional wave fights.

446
00:20:06,096 --> 00:20:07,697
The problem is, since the AI teleported in,

447
00:20:07,757 --> 00:20:09,818
it felt odd without some sort of environmental context,

448
00:20:10,199 --> 00:20:12,280
like having a portal being open, alarm going off.

449
00:20:12,700 --> 00:20:13,561
There was also the tedium

450
00:20:13,601 --> 00:20:15,222
of chasing down the stragglers in each wave.

451
00:20:16,203 --> 00:20:18,284
It was clear we needed new encounter types to mix it up

452
00:20:18,404 --> 00:20:19,865
and provide additional pacing options.

453
00:20:20,406 --> 00:20:22,167
The first one we added was incidental combat,

454
00:20:22,487 --> 00:20:23,688
which allowed us to place enemies

455
00:20:23,728 --> 00:20:25,489
in traditional and transitional spaces.

456
00:20:26,009 --> 00:20:27,731
These served as pace breakers and were one note.

457
00:20:28,538 --> 00:20:31,781
The second, though, would come to be the backbone of our game.

458
00:20:32,601 --> 00:20:34,403
Dubbed Arena Fights, it consisted

459
00:20:34,423 --> 00:20:36,004
of a steady stream of AI reinforcements

460
00:20:36,024 --> 00:20:37,465
so the encounter never lost momentum.

461
00:20:38,006 --> 00:20:40,408
We targeted five minutes and three waves for big encounters,

462
00:20:40,748 --> 00:20:42,810
and the graph below illustrates the difference between the two.

463
00:20:44,191 --> 00:20:46,353
To further separate this new encounter from wave fights,

464
00:20:46,433 --> 00:20:48,514
we institute a policy called Last Heavy Standing.

465
00:20:49,466 --> 00:20:52,927
Now, encounters, they hinge around heavies, so instead of checking if all the AI are dead,

466
00:20:53,347 --> 00:20:55,388
we simply check if a heavy AI is still in play.

467
00:20:56,108 --> 00:20:58,909
Now, without some drizzle of minions, pacing had severe oscillation.

468
00:20:59,449 --> 00:21:02,791
This also curtailed players from disengaging to scour the arena for pickups.

469
00:21:03,771 --> 00:21:07,512
10 max minions felt good, with 20 being our cap for a big encounter, which is about 5 minutes.

470
00:21:08,513 --> 00:21:11,454
To incentivize aggression, players that went straight for the fiercest combatants

471
00:21:11,474 --> 00:21:12,794
could actually end a scenario sooner.

472
00:21:14,478 --> 00:21:18,783
Next, we switched to checking the hit points remaining percentage instead of the traditional

473
00:21:18,863 --> 00:21:19,624
on-death callback.

474
00:21:20,365 --> 00:21:24,170
See, reinforcements, they felt a lot less contrived when new IAs didn't appear as soon

475
00:21:24,190 --> 00:21:24,951
as the old ones died.

476
00:21:25,391 --> 00:21:28,235
Plus, it limited all the pot shots you'd get when they were playing those cool spawning

477
00:21:28,275 --> 00:21:28,755
animations.

478
00:21:29,436 --> 00:21:32,760
Since players tend to finish off a heavy once they have him on the ropes, this value could

479
00:21:32,780 --> 00:21:33,581
be as high as 50% health left.

480
00:21:35,745 --> 00:21:39,367
We noticed that players felt that fights were over once the last Heavy was killed,

481
00:21:39,787 --> 00:21:42,929
so we actually Zerg-rushed all the remaining fodder to clean up the encounter ASAP.

482
00:21:43,569 --> 00:21:47,131
Enemy highlight is added for time-sensitive cases, like Rune Trials in Arcade mode.

483
00:21:48,092 --> 00:21:49,532
This did surface a real problem though.

484
00:21:50,333 --> 00:21:53,555
See, we were over-relying on the Imp because the rest of our fodder are former humans,

485
00:21:53,995 --> 00:21:56,256
and thus unathletic and slow compared to Demons.

486
00:21:56,816 --> 00:21:59,618
In retrospect, we really should have had another minion that was agile

487
00:21:59,638 --> 00:22:01,419
and had access to the entire Traversal Suite.

488
00:22:02,430 --> 00:22:03,991
Now, to limit their occurrence post-fight,

489
00:22:04,532 --> 00:22:06,193
soldiers and zombies were never introduced

490
00:22:06,253 --> 00:22:08,915
later than mid-fight, and we gave them a robust suite

491
00:22:08,935 --> 00:22:10,556
of pre-combat behaviors and options,

492
00:22:10,936 --> 00:22:12,557
so that way we really wanted to encourage the LDs

493
00:22:12,577 --> 00:22:13,718
to use them to kick off fights.

494
00:22:15,840 --> 00:22:17,641
Now, we really wanted to sell that there was a hierarchy

495
00:22:17,661 --> 00:22:19,122
to the demons, so we tried themed fights,

496
00:22:19,282 --> 00:22:20,843
which was our name for encounters composed

497
00:22:20,863 --> 00:22:22,004
solely of a single AI type.

498
00:22:22,644 --> 00:22:24,946
We also tried implementing rules like former humans,

499
00:22:25,166 --> 00:22:26,707
such as a revenant, would never fight

500
00:22:26,727 --> 00:22:28,248
alongside true demons like the Hell Knight.

501
00:22:29,542 --> 00:22:31,944
This made sense for lore, but was actually terrible for gameplay.

502
00:22:32,764 --> 00:22:34,645
See, the AI were designed to perform a single role,

503
00:22:35,286 --> 00:22:37,307
combat's designed to juggle a mixed battlefield,

504
00:22:37,707 --> 00:22:39,468
and so it's basically like starting a basketball team

505
00:22:39,488 --> 00:22:41,189
that's composed solely of centers or point guards.

506
00:22:43,150 --> 00:22:45,091
The chess pieces, we designed these to play well

507
00:22:45,131 --> 00:22:46,772
in nearly every space with any combo,

508
00:22:46,792 --> 00:22:48,893
so level designers can freely experiment to find the fun.

509
00:22:49,774 --> 00:22:51,575
One of the few restrictions we had was you were never allowed

510
00:22:51,595 --> 00:22:53,236
to pair a charger, such as the pinky,

511
00:22:53,636 --> 00:22:55,037
with a chaser, like the Hell Knight,

512
00:22:55,397 --> 00:22:57,698
and we always had to have a cool down between melee unit spawns.

513
00:22:58,739 --> 00:23:00,640
The Summoner was the most troublesome AI for us

514
00:23:00,700 --> 00:23:02,602
because it was never clear whether they create Encounter

515
00:23:03,102 --> 00:23:05,044
or they take an existing one and amp it up to 11.

516
00:23:07,505 --> 00:23:09,707
They were also so evasive and potentially destructive

517
00:23:09,947 --> 00:23:11,308
that you couldn't focus on anything else

518
00:23:11,328 --> 00:23:12,008
when they were in play.

519
00:23:12,889 --> 00:23:14,130
This led us to realize Encounter

520
00:23:14,150 --> 00:23:15,671
should only have one Captain per wave,

521
00:23:16,031 --> 00:23:17,272
and this Captain is then the AI

522
00:23:17,292 --> 00:23:18,853
that we're gonna check in last heavy standing.

523
00:23:19,816 --> 00:23:22,577
Finally, clever AI placement could create the illusion

524
00:23:22,597 --> 00:23:24,998
that an AI has behavior built in to maximize the environment,

525
00:23:25,199 --> 00:23:26,099
like the imp in the hangouts,

526
00:23:26,539 --> 00:23:27,880
but in reality it's all smoke and mirrors.

527
00:23:28,560 --> 00:23:30,081
My favorite was fat guy in a little coat,

528
00:23:30,421 --> 00:23:31,882
our name for a mancubus in a hallway.

529
00:23:32,622 --> 00:23:34,703
The AI appears more forbiddable with a snug fit,

530
00:23:35,243 --> 00:23:36,344
but really the only thing that's changed

531
00:23:36,364 --> 00:23:37,965
is the player doesn't have the same movement options

532
00:23:37,985 --> 00:23:38,985
available to counter them with.

533
00:23:41,034 --> 00:23:42,735
AI pressure was our biggest hurdle to fund.

534
00:23:43,316 --> 00:23:45,057
This manifested itself in ranged AI

535
00:23:45,097 --> 00:23:46,198
having aggressive melee moves,

536
00:23:46,899 --> 00:23:48,560
engagement distances that were too close,

537
00:23:49,020 --> 00:23:50,782
and a misconception that epic fights

538
00:23:50,922 --> 00:23:52,383
required epically sized arenas.

539
00:23:53,324 --> 00:23:55,145
It really took some effort to get everybody on board

540
00:23:55,165 --> 00:23:57,167
with the idea that enemies should hold their position,

541
00:23:57,627 --> 00:23:59,448
and that we can't have multiple melee units charging

542
00:23:59,508 --> 00:24:01,210
because if you could move two or three pieces

543
00:24:01,250 --> 00:24:02,951
at the same time in chess, it would ruin the game.

544
00:24:04,032 --> 00:24:05,993
Ultimately, we identified a number of fail conditions

545
00:24:06,033 --> 00:24:07,274
for combat chess that we could test

546
00:24:07,294 --> 00:24:08,435
whether encounter was working or not.

547
00:24:09,442 --> 00:24:12,684
Players retreat from enemies, players post up in a doorway,

548
00:24:13,484 --> 00:24:15,565
players snipe from a distance, and worse,

549
00:24:15,765 --> 00:24:17,186
players kite enemies around the space.

550
00:24:18,747 --> 00:24:20,047
We eventually hit a point where the AI

551
00:24:20,107 --> 00:24:21,108
properly played their part,

552
00:24:21,648 --> 00:24:23,129
the arenas had the right scale and flow,

553
00:24:23,489 --> 00:24:24,910
and the player was fast but under control.

554
00:24:47,353 --> 00:24:50,275
A new nickname for the combat loop emerged, the dance.

555
00:24:51,555 --> 00:24:53,276
We called it this because you're always moving,

556
00:24:53,977 --> 00:24:55,618
there's a lot of lateral and circular motion,

557
00:24:55,818 --> 00:24:57,039
and there's a natural back and forth

558
00:24:57,079 --> 00:24:58,500
between you and your partners, the demons.

559
00:24:59,940 --> 00:25:01,962
Now before Drake shows us how all this actually works,

560
00:25:02,302 --> 00:25:04,323
I want to quickly recap the key components and terms.

561
00:25:04,963 --> 00:25:05,964
There's push forward combat,

562
00:25:05,984 --> 00:25:07,605
which is our filter for putting ideas through

563
00:25:07,665 --> 00:25:08,986
to judge whether they're doing enough.

564
00:25:09,712 --> 00:25:11,933
This governs all aspects of the game, not just combat.

565
00:25:12,574 --> 00:25:15,175
We have combat chess, which is our core loop

566
00:25:15,495 --> 00:25:16,835
that rewards movement and strategy.

567
00:25:17,416 --> 00:25:19,837
The pillars of this are speed, enemy archetypes,

568
00:25:20,197 --> 00:25:21,598
unique weapons, and power.

569
00:25:22,298 --> 00:25:23,979
We have chess pieces, which are AI roles

570
00:25:24,019 --> 00:25:26,340
designed to facilitate very specific player responses.

571
00:25:26,940 --> 00:25:28,521
We have skate parks, which are the arenas

572
00:25:28,541 --> 00:25:30,301
that the player improvises and dances in.

573
00:25:30,962 --> 00:25:31,922
And we have combat puzzles,

574
00:25:32,162 --> 00:25:33,363
which are couplings of chess pieces

575
00:25:33,403 --> 00:25:34,643
to provoke creative problem solving.

576
00:25:35,889 --> 00:25:39,592
Lastly, I just want to thank every dev that contributed to DOOM, past and present, in

577
00:25:39,632 --> 00:25:43,436
and outside, because everything in this presentation resulted from them and I'm honored to present

578
00:25:43,616 --> 00:25:45,658
their work and their learnings with all of you.

579
00:25:46,158 --> 00:25:48,360
Thank you for your time and please remember to fill out the speaker surveys.

580
00:26:01,181 --> 00:26:02,383
Welcome to part two of our talk.

581
00:26:03,744 --> 00:26:06,248
Before we dive into some implementation details,

582
00:26:07,209 --> 00:26:08,611
I want to give a little bit of context.

583
00:26:09,412 --> 00:26:10,353
And there's a little,

584
00:26:10,974 --> 00:26:12,335
there's a considerable amount of overlap

585
00:26:12,355 --> 00:26:13,136
between our two talks,

586
00:26:13,217 --> 00:26:15,199
but all the points are super important, we feel.

587
00:26:15,560 --> 00:26:19,845
So, it's good to hit them, you know, multiple times.

588
00:26:21,073 --> 00:26:22,935
So push forward combat is all about the player.

589
00:26:22,955 --> 00:26:24,936
Now what do I mean by that?

590
00:26:25,276 --> 00:26:28,359
Well, we really want the player to feel like this, right?

591
00:26:28,499 --> 00:26:30,560
Now this is our latest box art.

592
00:26:30,680 --> 00:26:32,962
This is not just some, you know, random image.

593
00:26:34,042 --> 00:26:35,764
And specifically, we want the player to feel

594
00:26:35,804 --> 00:26:37,225
like this person right here, right?

595
00:26:37,745 --> 00:26:39,906
The Doom Marine, the Demon Slayer,

596
00:26:40,587 --> 00:26:41,688
he's hell's worst nightmare.

597
00:26:44,142 --> 00:26:46,664
So our AI aren't just trying to kill you.

598
00:26:46,984 --> 00:26:48,826
They also need to encourage the player

599
00:26:48,926 --> 00:26:50,067
to be the demon slayer.

600
00:26:50,788 --> 00:26:54,471
And that means reinforcing the player's confidence

601
00:26:54,831 --> 00:26:57,874
that their actions matter more than anything else.

602
00:26:59,615 --> 00:27:01,457
Now this theme is hugely important to us.

603
00:27:02,078 --> 00:27:04,340
So we aren't content to just hope that it happens.

604
00:27:05,000 --> 00:27:06,942
Our systems are engineered to support it.

605
00:27:07,382 --> 00:27:09,724
And in this talk, I'm gonna touch on some examples.

606
00:27:11,388 --> 00:27:14,291
And Kurt has mentioned most of these, so this might be a little bit of a recap.

607
00:27:14,971 --> 00:27:19,995
As the Demon Slayer, you should always have the confidence to blast into the middle of

608
00:27:20,015 --> 00:27:22,697
the fray and take the demons out with your bare hands.

609
00:27:23,317 --> 00:27:28,001
So to encourage this, we shifted our view of pain animations and hit reactions to be

610
00:27:28,041 --> 00:27:29,042
a tool for the player.

611
00:27:29,842 --> 00:27:33,765
Now you should always feel like movement is a safer option than standing still.

612
00:27:34,146 --> 00:27:37,288
So to encourage this, we forced enemies to miss moving players.

613
00:27:38,283 --> 00:27:42,106
You should be the one bringing the fight to the ranged enemies and not the other way around.

614
00:27:42,607 --> 00:27:47,131
So to encourage this, we try to keep such units from ever positioning too close to the player.

615
00:27:48,952 --> 00:27:53,777
You shouldn't ever feel cheated or overwhelmed by an unlucky barrage of too many enemy attacks.

616
00:27:54,377 --> 00:27:58,941
So to ensure this, we make sure that only a finite number of enemies ever attack at once.

617
00:28:00,042 --> 00:28:03,505
And finally, you should feel like the center of attention when you want it.

618
00:28:04,338 --> 00:28:06,599
So we take steps to make sure infighting

619
00:28:06,819 --> 00:28:08,840
doesn't ever lead to the player feeling ignored.

620
00:28:11,362 --> 00:28:12,482
So let's talk about hit reactions.

621
00:28:13,283 --> 00:28:16,144
The most fundamental behavior of an enemy in a shooter

622
00:28:16,425 --> 00:28:17,605
is to react to being shot.

623
00:28:18,326 --> 00:28:22,448
Now, the AI in Rage had critically acclaimed pain animations

624
00:28:22,648 --> 00:28:25,350
and this is often cited as one of the reasons

625
00:28:25,410 --> 00:28:26,510
the AI are so lifelike.

626
00:28:26,890 --> 00:28:29,172
So we wanted to continue with this tradition.

627
00:28:29,812 --> 00:28:31,933
But there was one minor critique that most of us had.

628
00:28:33,117 --> 00:28:35,659
The pain animations played by a charging enemy

629
00:28:36,139 --> 00:28:39,061
often took them even closer to the player,

630
00:28:39,221 --> 00:28:40,561
carrying their forward momentum.

631
00:28:40,982 --> 00:28:43,223
And we kind of wanted it to feel like the player

632
00:28:43,283 --> 00:28:44,644
was stopping enemies in their tracks.

633
00:28:46,445 --> 00:28:49,166
And so this spawned a larger discussion and a previs,

634
00:28:49,226 --> 00:28:50,307
which Kurt's already shown you,

635
00:28:50,347 --> 00:28:52,068
but I'm gonna play it again while I speak.

636
00:28:52,688 --> 00:28:54,669
It was made to showcase some of the new ideas

637
00:28:54,729 --> 00:28:55,470
about hit reactions.

638
00:28:57,209 --> 00:29:02,012
The essence of this new approach was to consider hit reactions as a way the player could manage

639
00:29:02,112 --> 00:29:05,033
threats on the battlefield by interrupting and slowing enemies.

640
00:29:05,593 --> 00:29:09,575
Hence, we renamed our hit reaction system the Threat Management System.

641
00:29:10,436 --> 00:29:14,798
No matter how overwhelming an encounter might seem from the outside, a player can dive in

642
00:29:14,878 --> 00:29:16,139
and straighten it out with firepower.

643
00:29:16,699 --> 00:29:21,661
And you might also notice that because the enemies are slow and interrupted, the player

644
00:29:21,701 --> 00:29:24,343
is encouraged to just stroll up to them and finish them off with style.

645
00:29:26,318 --> 00:29:30,399
Now this shift in how we viewed hit reactions emerged as one of the most essential ingredients

646
00:29:30,439 --> 00:29:33,279
in push-forward combat because we're encouraging this.

647
00:29:34,520 --> 00:29:38,221
Now we started by just slowly working towards what we saw in that previous video.

648
00:29:38,621 --> 00:29:43,902
And the first step was to organize and use our pain animations according to their impact

649
00:29:43,962 --> 00:29:45,702
on gameplay instead of some visual thing.

650
00:29:46,242 --> 00:29:49,163
Now there's a spectrum of hit reactions in the threat management system.

651
00:29:49,583 --> 00:29:54,484
At one end are the reactions that happen frequently but do not impact gameplay behavior that much,

652
00:29:54,784 --> 00:29:55,545
while at the other end...

653
00:29:56,236 --> 00:29:57,696
are reactions that happen rarely,

654
00:29:57,836 --> 00:30:00,217
but they critically interrupt the AI's combat ability.

655
00:30:00,737 --> 00:30:02,858
Now, once we had our spectrum of animations,

656
00:30:03,498 --> 00:30:04,598
everything just falls into place.

657
00:30:05,059 --> 00:30:06,879
We just have to tune the damage thresholds

658
00:30:06,939 --> 00:30:08,820
that trigger these reactions and iterate.

659
00:30:09,660 --> 00:30:11,541
Now, let me go into a little more detail

660
00:30:11,581 --> 00:30:13,141
about what these reactions look like.

661
00:30:13,781 --> 00:30:14,781
Kurt's already touched on this,

662
00:30:14,841 --> 00:30:16,462
but I got some different videos, so.

663
00:30:17,062 --> 00:30:18,763
Twitches are just additive animations,

664
00:30:19,403 --> 00:30:20,883
so they don't slow or interrupt behavior,

665
00:30:21,083 --> 00:30:23,164
but as you can see, they can interrupt enemy aim.

666
00:30:24,287 --> 00:30:26,448
Falters are the full body animations

667
00:30:26,468 --> 00:30:27,909
that the AI has to play.

668
00:30:28,670 --> 00:30:31,271
So the player can expect these to interrupt AI behavior.

669
00:30:31,892 --> 00:30:34,193
And you can keep an AI from being a threat

670
00:30:34,453 --> 00:30:36,635
by continually doing it, which we call pain lock.

671
00:30:37,596 --> 00:30:39,757
And this even holds true for characters

672
00:30:39,777 --> 00:30:40,638
that are in the middle of leaps.

673
00:30:48,654 --> 00:30:52,497
Pushbacks and knockdowns are the strongest non-cycling hit reactions.

674
00:30:53,037 --> 00:30:56,539
Because of their severity, it takes some time for the enemies to recover from this.

675
00:30:57,059 --> 00:31:01,782
And if the player has the right weapon, they can even put every AI in a looping stun state.

676
00:31:02,383 --> 00:31:05,825
Now these kind of reactions allow you to really rain damage down on the enemy.

677
00:31:06,465 --> 00:31:12,810
And finally, the last hit reaction most enemies play, often near the end of their life cycle, is the stagger.

678
00:31:13,410 --> 00:31:14,711
Now this is a dazed state, right?

679
00:31:14,811 --> 00:31:15,431
In a cartoon...

680
00:31:16,312 --> 00:31:18,957
they would have like stars or little birdies, you know,

681
00:31:18,977 --> 00:31:19,559
above their heads.

682
00:31:19,999 --> 00:31:22,003
And they're just basically asking the player to run up

683
00:31:22,043 --> 00:31:23,106
and finish them off at this point.

684
00:31:24,432 --> 00:31:26,673
So our second step was figuring out the finishing move system.

685
00:31:27,253 --> 00:31:30,033
And it felt natural to say that if you can daze an enemy

686
00:31:30,073 --> 00:31:31,714
with a staggered pain reaction, you

687
00:31:31,734 --> 00:31:33,814
should be able to just go up and finish them off.

688
00:31:34,334 --> 00:31:36,335
Now it turns out, because the AI is not

689
00:31:36,435 --> 00:31:39,355
moving much when staggered, the base implementation

690
00:31:39,415 --> 00:31:40,315
is pretty straightforward.

691
00:31:40,715 --> 00:31:43,036
It's just pretty much synchronized animations

692
00:31:43,076 --> 00:31:43,956
between the participants.

693
00:31:44,376 --> 00:31:45,996
But through lots of iteration, of course,

694
00:31:46,216 --> 00:31:47,737
we learned that getting the details right

695
00:31:48,077 --> 00:31:49,977
is critical to how the system feels for the player.

696
00:31:51,979 --> 00:31:55,084
So staggered and vulnerable enemies are highlighted with special shaders

697
00:31:55,484 --> 00:31:59,751
because in the chaos, players weren't getting as much information as we wanted them to.

698
00:31:59,891 --> 00:32:03,517
You know, blue means the guy is vulnerable, yellow means you can do a glory kill on him.

699
00:32:04,124 --> 00:32:06,585
In this next video, I've turned off the highlights.

700
00:32:07,006 --> 00:32:08,386
And although it may look more realistic,

701
00:32:08,866 --> 00:32:12,128
the player has little clue which AIs are ready to be glory killed.

702
00:32:12,428 --> 00:32:16,050
And furthermore, it's not clear to the player which AI they would glory kill

703
00:32:16,070 --> 00:32:17,911
when they press the button if they choose to do so.

704
00:32:18,491 --> 00:32:21,072
I guess you could reasonably expect the system to pick the AI

705
00:32:21,092 --> 00:32:23,653
that's kind of like right in front of you, but there's always edge cases, right?

706
00:32:24,334 --> 00:32:25,314
And so with the highlight,

707
00:32:26,215 --> 00:32:29,996
even if the player doesn't understand or agree with the system's choice,

708
00:32:30,497 --> 00:32:32,918
at least they know what it is ahead of time, so you can adjust.

709
00:32:35,833 --> 00:32:39,975
Now we don't have the same level of glory kill variation applied equally to all the AI.

710
00:32:41,115 --> 00:32:44,256
The fodder tend to have the most animations because you see them the most in the game.

711
00:32:44,916 --> 00:32:49,657
And it's no coincidence that the interactions with the fodder feel smoother in many cases because

712
00:32:50,377 --> 00:32:57,599
in order to minimize view popping, when possible the system will pick an animation that targets the limb or body area that the player is looking at.

713
00:32:58,140 --> 00:33:03,201
Now there are other good reasons for limb-based glory kills. In particular they're fun and they add lots of variation.

714
00:33:03,901 --> 00:33:05,443
and their challenges involved with them.

715
00:33:05,843 --> 00:33:12,448
But from a polish standpoint, the big win is that it reduces the cases of jarring view popping at the start of the animations.

716
00:33:15,951 --> 00:33:20,674
Now the glory kill animations are kept short and sweet because we don't want the player to feel like they're being slowed down.

717
00:33:21,195 --> 00:33:26,879
So as a general rule, we tried to keep the whole sequence shorter than the time it would take to naturally finish off a given enemy.

718
00:33:27,079 --> 00:33:31,543
That meant for bigger enemies you have a little more time, but it should always be faster than if you just shoot them.

719
00:33:32,163 --> 00:33:32,864
And most importantly...

720
00:33:34,019 --> 00:33:36,541
We learned that in order for players to really embrace this system,

721
00:33:36,861 --> 00:33:39,103
they needed to feel relatively safe when doing it,

722
00:33:39,443 --> 00:33:40,985
even in the most dangerous situations.

723
00:33:41,285 --> 00:33:44,028
So, we made the player invincible up until the release point.

724
00:33:46,044 --> 00:33:50,988
But even that wasn't enough, because since we expect the player to use movement as their primary defense,

725
00:33:51,368 --> 00:33:54,070
standing still for even a few seconds can be catastrophic.

726
00:33:54,530 --> 00:34:00,335
We found that even with the invincibility, players would often incur huge amounts of damage immediately after a Glory Kill

727
00:34:00,935 --> 00:34:06,379
by virtue of all the incoming projectiles and attacks that are already in progress on their now stationary position.

728
00:34:06,640 --> 00:34:13,165
So, we added a combat pause. AI are prohibited from starting any new attacks while the player is in a Glory Kill.

729
00:34:14,968 --> 00:34:15,908
Let's talk about accuracy.

730
00:34:17,029 --> 00:34:19,431
We spent a lot of time making the AI capable fighters.

731
00:34:19,851 --> 00:34:22,312
For example, being able to nail moving players

732
00:34:22,353 --> 00:34:23,153
with accurate shots.

733
00:34:23,793 --> 00:34:25,535
But then we decided that giving the AI

734
00:34:26,075 --> 00:34:27,596
accurate prediction against moving players

735
00:34:27,996 --> 00:34:29,777
ran counter to the goals of push for combat,

736
00:34:29,817 --> 00:34:30,438
as you've already heard.

737
00:34:31,518 --> 00:34:33,780
Because we want the player to be empowered by movement

738
00:34:33,800 --> 00:34:35,081
and feel threatened by standing still.

739
00:34:36,642 --> 00:34:38,663
Our solution is to purposefully miss

740
00:34:38,683 --> 00:34:39,904
when the player is moving, right?

741
00:34:40,024 --> 00:34:40,304
Simple.

742
00:34:40,824 --> 00:34:43,326
And the AI will miss more often and with greater distance

743
00:34:43,366 --> 00:34:44,326
as the player moves faster.

744
00:34:46,520 --> 00:34:51,362
But naively reducing accuracy with a random offset

745
00:34:51,863 --> 00:34:53,644
leads to a purely random distribution.

746
00:34:53,884 --> 00:34:54,884
And for a number of reasons,

747
00:34:54,924 --> 00:34:56,925
that didn't give us a level of control that we wanted.

748
00:34:57,346 --> 00:34:59,787
What we wanted was a way to easily specify

749
00:34:59,947 --> 00:35:02,228
exactly what the missed distribution should look like.

750
00:35:03,469 --> 00:35:05,570
And we ended up using a curve to define that distribution.

751
00:35:06,544 --> 00:35:08,805
So it's easy to plot a distribution as a curve.

752
00:35:08,825 --> 00:35:10,945
You can just imagine that the height is the density.

753
00:35:11,706 --> 00:35:13,706
But how do you go from a curve back to a distribution?

754
00:35:14,066 --> 00:35:16,827
Well, if you imagine random samples being taken

755
00:35:16,867 --> 00:35:18,147
from anywhere under this curve,

756
00:35:19,308 --> 00:35:22,469
the X value of those samples, if you project it down,

757
00:35:22,749 --> 00:35:24,349
ends up being the very distribution

758
00:35:24,369 --> 00:35:25,769
that would have been plotted as the curve.

759
00:35:26,130 --> 00:35:27,310
Well, how do we use this concept?

760
00:35:28,130 --> 00:35:29,991
We discretize the curve into slices

761
00:35:30,491 --> 00:35:33,432
where the height of each slice is the Y value of the curve

762
00:35:33,492 --> 00:35:35,232
halfway between the X values of the slice.

763
00:35:36,545 --> 00:35:36,865
like this.

764
00:35:38,826 --> 00:35:41,927
Then, we normalize the areas of the slices.

765
00:35:42,127 --> 00:35:44,248
And conceptually, you can think of this as

766
00:35:45,189 --> 00:35:46,570
laying the slices on their sides,

767
00:35:48,210 --> 00:35:48,571
like that.

768
00:35:50,051 --> 00:35:52,172
And by normalize, I mean we take the value

769
00:35:52,192 --> 00:35:52,833
between zero and 1.0.

770
00:35:54,733 --> 00:35:55,854
Then we pick a random number.

771
00:35:56,414 --> 00:35:56,895
In this case,

772
00:35:58,843 --> 00:36:04,246
0.22. Now look, 0.22 lies on the number line in the normalized area of slice D.

773
00:36:04,826 --> 00:36:10,309
So then we look at the actual extents of slice D on the original curve and we see that it's 0.4 to 0.5.

774
00:36:10,769 --> 00:36:13,670
That's probably too small for you to see, but just take my word for it.

775
00:36:14,811 --> 00:36:20,294
Then we call a second RAND with those two values to give a little bit of localized variation.

776
00:36:20,714 --> 00:36:22,155
And if we did this like a million times,

777
00:36:22,455 --> 00:36:26,136
the samples would approximate the intended distribution that's under the curve.

778
00:36:27,811 --> 00:36:31,353
Now our curves are asymmetric because we mirror the distribution on both sides of the player.

779
00:36:32,214 --> 00:36:33,294
An example of how this looks.

780
00:36:33,975 --> 00:36:35,936
I force this imp to miss me even at a crawl.

781
00:36:36,316 --> 00:36:37,016
So there's a hit.

782
00:36:37,036 --> 00:36:37,957
You see the screen effects.

783
00:36:38,317 --> 00:36:39,238
Every other throw is a miss.

784
00:36:40,098 --> 00:36:44,360
This method allows us to easily alter the desired distribution for different difficulty

785
00:36:44,380 --> 00:36:44,641
levels.

786
00:36:45,121 --> 00:36:47,702
For example, this is the curve that we use on hard.

787
00:36:49,847 --> 00:36:53,488
Looks a little bit similar, but note that on this hard curve,

788
00:36:53,508 --> 00:36:55,449
there's a non-zero value in the first slice,

789
00:36:55,889 --> 00:36:57,630
which means that the AI are actually gonna attempt

790
00:36:57,670 --> 00:37:00,331
to hit the player more than on the easy.

791
00:37:03,352 --> 00:37:04,332
Let's talk about positioning.

792
00:37:05,453 --> 00:37:07,734
We want the AI to stand in the open as much as possible,

793
00:37:08,054 --> 00:37:09,394
because that's where the player can shoot them.

794
00:37:09,995 --> 00:37:12,836
And obviously, ranged AI need to stand where their attacks

795
00:37:12,876 --> 00:37:13,796
will be able to hit the player.

796
00:37:14,276 --> 00:37:16,797
But in its simplest form, the desire for visibility

797
00:37:16,838 --> 00:37:18,618
to the player was causing problems.

798
00:37:19,232 --> 00:37:19,692
What do I mean?

799
00:37:20,272 --> 00:37:22,473
Well, here this imp can't see the player, right?

800
00:37:23,093 --> 00:37:26,074
A common way to get such ranged AI into visibility

801
00:37:26,214 --> 00:37:28,094
is to simply have them move towards the player.

802
00:37:28,734 --> 00:37:31,595
Because we know that if the imp moves along the path

803
00:37:31,635 --> 00:37:34,356
to the player, at some point, he'll gain visibility

804
00:37:34,516 --> 00:37:35,676
when he comes around the last corner.

805
00:37:37,377 --> 00:37:38,977
But what if the player decides to move forward

806
00:37:38,997 --> 00:37:39,617
at the same time?

807
00:37:40,497 --> 00:37:41,958
The imp and you are gonna meet face to face.

808
00:37:42,759 --> 00:37:47,402
Now, it's not as if this is a horrible situation because the imp is not the strongest character.

809
00:37:47,802 --> 00:37:51,644
But, we want the player to be the one bringing the fight to the enemies,

810
00:37:52,044 --> 00:37:54,505
especially the smaller characters like imps and soldiers.

811
00:37:55,246 --> 00:37:57,927
So, range units need to maintain some distance if possible.

812
00:37:59,108 --> 00:38:00,729
Now, in cover shooters this is not a problem,

813
00:38:01,009 --> 00:38:04,871
because cover point systems are built around the idea of positions that can fire on the player.

814
00:38:05,711 --> 00:38:08,513
So, all the AI code has to do is pick a valid cover point and go there.

815
00:38:09,800 --> 00:38:11,943
Well, it turns out there's some cover shooter blood

816
00:38:12,203 --> 00:38:13,744
in the id family, Rage.

817
00:38:16,727 --> 00:38:17,969
Now, cover positions in Rage

818
00:38:18,609 --> 00:38:20,912
also measured occlusion from the player, right?

819
00:38:21,492 --> 00:38:22,373
That means they're good cover.

820
00:38:23,174 --> 00:38:24,515
So if you place one out in the open,

821
00:38:24,976 --> 00:38:27,018
cover-seeking AI would never actually use it

822
00:38:27,338 --> 00:38:29,701
for the obvious reason that it didn't offer actual cover.

823
00:38:30,563 --> 00:38:35,086
Now we tried the extremely simple test of flipping the desired occlusion values from

824
00:38:35,146 --> 00:38:39,590
positive to negative numbers, making the AI desire positions where they were completely

825
00:38:39,630 --> 00:38:41,391
exposed instead of completely protected.

826
00:38:41,731 --> 00:38:42,232
And it worked!

827
00:38:43,493 --> 00:38:48,856
And so henceforth, ranged fire positions in Doom have been known by the silly term exposed

828
00:38:48,917 --> 00:38:49,197
cover.

829
00:38:50,117 --> 00:38:51,318
I'm not joking, that's what we call them.

830
00:38:53,122 --> 00:38:55,403
Now, there's one big difference between cover

831
00:38:55,503 --> 00:38:57,204
and the opposite of cover and anti-cover.

832
00:38:57,444 --> 00:39:00,807
You know, cover typically converges on single points

833
00:39:00,927 --> 00:39:03,508
or small areas that the AI stick to,

834
00:39:03,949 --> 00:39:05,470
and it has a well-defined direction.

835
00:39:06,150 --> 00:39:09,933
Anti-cover can be a large portion of any map space,

836
00:39:10,373 --> 00:39:11,714
and it typically has no direction.

837
00:39:12,801 --> 00:39:15,202
So to make this larger area work with the same kind

838
00:39:15,242 --> 00:39:17,683
of discrete positioning choices a cover system uses,

839
00:39:18,083 --> 00:39:20,464
we treat exposed cover positions as a tether point.

840
00:39:21,084 --> 00:39:23,245
And while tethered, the AI are then free to make

841
00:39:23,345 --> 00:39:26,066
local direction and positioning choices as they see fit.

842
00:39:28,007 --> 00:39:30,328
Now how do the AI know to consider

843
00:39:30,368 --> 00:39:31,468
a tether point good or not?

844
00:39:32,148 --> 00:39:35,029
Well whereas many cover systems use pre-computed visibility,

845
00:39:35,470 --> 00:39:38,711
Doom uses a runtime algorithm I call Bunch of Traces.

846
00:39:40,191 --> 00:39:41,532
The basics of the algorithm are this.

847
00:39:42,544 --> 00:39:45,128
generate a grid of sample points within each tether area,

848
00:39:46,029 --> 00:39:48,632
and then just do traces from the sample points to the target.

849
00:39:49,013 --> 00:39:53,419
And you keep a running average of what fraction of those points can see the player.

850
00:39:53,539 --> 00:39:57,304
In this case, that tether point only has 30% visibility to the target.

851
00:39:58,411 --> 00:40:01,253
Now, why use traces instead of pre-computed visibility?

852
00:40:01,733 --> 00:40:04,755
Well, because a naive approach like this is super simple,

853
00:40:04,955 --> 00:40:06,876
it's super usable, and it's super debuggable.

854
00:40:07,436 --> 00:40:09,958
It just automatically works with anything in the game

855
00:40:09,998 --> 00:40:12,239
that has collision, even dynamic objects

856
00:40:12,319 --> 00:40:13,040
and other characters.

857
00:40:13,620 --> 00:40:16,141
And it operates on the same level of collision detail

858
00:40:16,582 --> 00:40:20,204
that weapons traces, sensory traces, and projectile traces,

859
00:40:20,264 --> 00:40:21,465
and everything else operate on.

860
00:40:23,831 --> 00:40:25,491
and you don't need that many traces, okay?

861
00:40:25,872 --> 00:40:28,012
This clip shows the overall visibility

862
00:40:28,032 --> 00:40:30,173
of each tether point coming from all the sample points

863
00:40:30,233 --> 00:40:31,273
it owns as they're updated.

864
00:40:31,413 --> 00:40:32,193
So did the previous clip.

865
00:40:32,814 --> 00:40:34,074
Now at 60 frames per second,

866
00:40:34,454 --> 00:40:37,915
only 24 traces per frame is 1400 traces per second.

867
00:40:38,155 --> 00:40:40,096
And if you cleverly manage which positions

868
00:40:40,136 --> 00:40:41,516
have their visibility updated,

869
00:40:41,876 --> 00:40:43,917
the entire combat space will be refreshed quickly.

870
00:40:44,357 --> 00:40:45,017
And just to prove it,

871
00:40:46,277 --> 00:40:47,998
I made this video with the limit decreased

872
00:40:48,038 --> 00:40:49,478
to 12 traces per frame.

873
00:40:50,662 --> 00:40:52,964
And then this one at only six traces per frame.

874
00:40:53,244 --> 00:40:55,125
And you see at even only six traces per frame,

875
00:40:55,505 --> 00:40:58,507
the tether points are updating at just over once a second

876
00:40:58,627 --> 00:40:59,848
in a pretty big combat space.

877
00:41:00,208 --> 00:41:03,530
And that's not great, but it still gives the AI usable info.

878
00:41:04,671 --> 00:41:05,892
Now this is one trace per frame,

879
00:41:05,912 --> 00:41:07,253
and I admit that is much too slow,

880
00:41:07,433 --> 00:41:09,514
but at least it proves that the system's working, right?

881
00:41:09,534 --> 00:41:14,237
Let's talk about attack cooldowns.

882
00:41:15,620 --> 00:41:23,002
We design attacks with the goal that the player will be able to focus on an enemy and understand their intent by reading visual effects and animation cues.

883
00:41:23,602 --> 00:41:27,923
This goal starts to break down when too many enemies independently decide to attack.

884
00:41:28,763 --> 00:41:30,023
At best, it looks silly.

885
00:41:30,624 --> 00:41:35,845
At worst, the player is overwhelmed by volleys of attacks that have no rhythm or predictability.

886
00:41:36,765 --> 00:41:41,466
Now, an obvious solution is to simply limit how many AI can attack simultaneously.

887
00:41:44,757 --> 00:41:46,718
Our specific implementation is a token system.

888
00:41:47,278 --> 00:41:48,558
The concept is extremely simple.

889
00:41:49,038 --> 00:41:50,759
If an AI wants to do certain attacks,

890
00:41:50,979 --> 00:41:51,959
they need a token for it.

891
00:41:53,100 --> 00:41:55,280
Now here are the same setups with tokens turned on.

892
00:41:56,801 --> 00:41:58,621
If there are only X tokens of a certain type,

893
00:41:59,041 --> 00:42:00,582
then those behaviors can only be done

894
00:42:01,282 --> 00:42:02,762
by X AI at a time in the game.

895
00:42:03,383 --> 00:42:05,423
Every other AI must find something else to do,

896
00:42:05,703 --> 00:42:07,604
such as executing a lesser attack

897
00:42:07,644 --> 00:42:08,644
of which there are more tokens,

898
00:42:09,764 --> 00:42:11,845
repositioning, or just playing a taunt

899
00:42:11,885 --> 00:42:13,085
so they don't look like they're idle.

900
00:42:16,063 --> 00:42:17,784
So if an AI wants to execute an attack,

901
00:42:17,824 --> 00:42:19,185
they first request a token.

902
00:42:20,965 --> 00:42:22,786
If one is not available, they have to do something else.

903
00:42:23,086 --> 00:42:24,606
If one is available, they then acquire it.

904
00:42:25,667 --> 00:42:26,947
And then they're gonna hold on to,

905
00:42:27,187 --> 00:42:29,748
or use that token for the duration of the attack.

906
00:42:30,248 --> 00:42:32,129
And once they release it back to the token pool,

907
00:42:32,609 --> 00:42:34,090
they can have a cool down on that token

908
00:42:34,130 --> 00:42:35,830
before it can be acquired again by anybody,

909
00:42:35,890 --> 00:42:36,450
even themselves.

910
00:42:36,811 --> 00:42:39,432
This is an easy way to enforce global attack cool downs.

911
00:42:41,555 --> 00:42:44,458
The different difficulty levels have different token counts.

912
00:42:44,858 --> 00:42:46,980
This is a crowd of imps on easy difficulty.

913
00:42:47,641 --> 00:42:50,464
And the goal is to allow for more simultaneous attacks

914
00:42:50,544 --> 00:42:51,725
at higher difficulty levels.

915
00:42:52,385 --> 00:42:54,688
So here's the same group of imps on ultra hard.

916
00:42:55,288 --> 00:42:57,791
As you see on ultra hard, there are more tokens available.

917
00:42:58,491 --> 00:43:00,093
Instead of one and one, you've got two and three.

918
00:43:01,034 --> 00:43:02,175
Thus, there are more AI attacking.

919
00:43:04,545 --> 00:43:07,107
A token usage is also not completely set in stone.

920
00:43:07,727 --> 00:43:10,569
In this video, AI marked with a cyan sphere

921
00:43:10,709 --> 00:43:11,789
are allowed to steal a token.

922
00:43:12,169 --> 00:43:12,369
Why?

923
00:43:12,810 --> 00:43:14,170
Well, suppose in this image,

924
00:43:14,491 --> 00:43:15,871
there are only two attack tokens

925
00:43:16,232 --> 00:43:18,773
and the imps in green already have them.

926
00:43:19,453 --> 00:43:21,814
The AI immediately in front of the player, marked in blue,

927
00:43:22,195 --> 00:43:23,735
are gonna look silly if they can't attack.

928
00:43:24,296 --> 00:43:27,157
So we allow AI to steal a token in such cases

929
00:43:27,257 --> 00:43:27,998
and attack anyway.

930
00:43:32,430 --> 00:43:33,991
Now let's jump to the other side of the fence

931
00:43:34,532 --> 00:43:36,112
and talk about the problem of AI

932
00:43:36,433 --> 00:43:38,574
not actively engaging the player when they should.

933
00:43:39,574 --> 00:43:41,996
We wanted to support lots of infighting between the demons.

934
00:43:42,776 --> 00:43:44,377
It's a loved and well-remembered feature

935
00:43:44,417 --> 00:43:45,658
from the original Doom games,

936
00:43:46,078 --> 00:43:48,039
and it adds a ton of personality to the enemies.

937
00:43:48,720 --> 00:43:50,761
But remember that push forward combat

938
00:43:50,841 --> 00:43:52,001
is a celebration of the player.

939
00:43:53,022 --> 00:43:55,403
So when a player is playing a part of the aggressor,

940
00:43:55,664 --> 00:43:56,984
the AI need to be smart enough

941
00:43:57,024 --> 00:43:59,366
to focus on their true enemy, the demon slayer.

942
00:44:00,283 --> 00:44:02,824
And to manage this easily, we needed more

943
00:44:02,884 --> 00:44:04,425
than a traditional faction system.

944
00:44:06,506 --> 00:44:08,286
Take a drink of water real quick, I apologize.

945
00:44:12,908 --> 00:44:14,369
So what is a traditional faction system?

946
00:44:15,689 --> 00:44:18,850
The typical implementation is to have a goodwill value

947
00:44:19,530 --> 00:44:21,651
that's basically like how they feel about someone, right?

948
00:44:22,191 --> 00:44:23,832
And it's as increased or decreased

949
00:44:23,892 --> 00:44:25,753
in response to agent actions in the world.

950
00:44:26,737 --> 00:44:29,099
For example, each time an AI is hit

951
00:44:29,159 --> 00:44:32,242
with like accidental friendly fire, suppose,

952
00:44:32,963 --> 00:44:34,324
the goodwill value might be reduced.

953
00:44:35,065 --> 00:44:37,387
After two such events, the goodwill value

954
00:44:37,527 --> 00:44:40,230
might cross a threshold into annoyed, right?

955
00:44:40,530 --> 00:44:43,473
And then maybe with another hit, it reduces to angry.

956
00:44:44,854 --> 00:44:47,857
Or, if the AI is hit intentionally,

957
00:44:48,417 --> 00:44:50,519
the goodwill value is reduced by a larger amount

958
00:44:51,140 --> 00:44:53,141
and it immediately dips below the angry threshold.

959
00:44:55,307 --> 00:44:57,487
Now this works out well until we wanna know

960
00:44:57,647 --> 00:44:58,968
why the AI is angry.

961
00:44:59,448 --> 00:45:01,448
Was it from three accidental hits,

962
00:45:02,008 --> 00:45:03,709
or was it from a single intentional hit,

963
00:45:04,229 --> 00:45:05,990
or was it some combination thereof,

964
00:45:07,010 --> 00:45:09,230
or was it from an entirely different series of events?

965
00:45:09,771 --> 00:45:11,131
You know, there's no way to know

966
00:45:11,371 --> 00:45:13,872
without adding more code to track all that extra stuff.

967
00:45:14,952 --> 00:45:16,673
And now we actually went through this process

968
00:45:16,933 --> 00:45:19,653
starting with one or a few goodwill values

969
00:45:20,274 --> 00:45:21,974
and adding more and more custom code

970
00:45:22,014 --> 00:45:24,095
and bolt-on functionality as we needed more control.

971
00:45:25,197 --> 00:45:27,959
Eventually, all that custom code became the most complex part

972
00:45:27,979 --> 00:45:28,820
of the faction system.

973
00:45:29,160 --> 00:45:30,781
And so we decided to just rethink

974
00:45:31,122 --> 00:45:32,883
the underlying approach.

975
00:45:34,564 --> 00:45:36,245
And we turned it into something built

976
00:45:36,265 --> 00:45:39,528
to be extensible from the start, a rule-based system that

977
00:45:39,608 --> 00:45:41,569
operates on records of everything of interest

978
00:45:41,589 --> 00:45:43,110
that has happened to the AI in the past.

979
00:45:44,751 --> 00:45:46,332
Now here, I've highlighted records

980
00:45:46,452 --> 00:45:49,435
representing accidental and intentional damage

981
00:45:49,475 --> 00:45:50,455
to one AI by another.

982
00:45:52,182 --> 00:45:53,962
And one example of a rule might be,

983
00:45:54,802 --> 00:45:56,163
if members of the Imp faction

984
00:45:56,643 --> 00:45:58,343
have damaged anyone on my faction,

985
00:45:58,883 --> 00:45:59,724
even accidentally,

986
00:46:00,884 --> 00:46:03,225
three or more times in the last eight seconds,

987
00:46:03,645 --> 00:46:06,326
then I should feel angry towards the Imp faction.

988
00:46:07,106 --> 00:46:07,686
And in this case,

989
00:46:08,726 --> 00:46:09,867
the rule evaluates to true.

990
00:46:10,127 --> 00:46:11,587
Go back eight seconds in the past,

991
00:46:12,007 --> 00:46:13,888
there's your three accidental damages.

992
00:46:15,567 --> 00:46:17,789
And so, the AI will feel angry against imps.

993
00:46:18,429 --> 00:46:20,190
And if multiple rules evaluate to true,

994
00:46:20,510 --> 00:46:22,672
we just take the one that produces the strongest response.

995
00:46:24,853 --> 00:46:26,614
Now to make it easy to manipulate the data,

996
00:46:27,134 --> 00:46:29,176
we specify everything with a single graph

997
00:46:29,216 --> 00:46:31,257
that defines both the inheritance of rules

998
00:46:31,317 --> 00:46:32,518
among a family of factions,

999
00:46:33,118 --> 00:46:36,760
as well as the rules themselves between the factions.

1000
00:46:37,141 --> 00:46:37,541
What do I mean?

1001
00:46:39,283 --> 00:46:42,325
At runtime, to evaluate the relationships between two factions,

1002
00:46:42,685 --> 00:46:46,487
for example, how a Hellknight should feel about a Plasma Soldier, we do this.

1003
00:46:46,507 --> 00:46:47,568
Alright?

1004
00:46:48,448 --> 00:46:50,790
First we follow each faction's inheritance chain

1005
00:46:51,110 --> 00:46:53,291
up to where they diverge from the first shared parent.

1006
00:46:53,592 --> 00:46:54,072
I will show you.

1007
00:46:54,572 --> 00:46:55,253
Where is the Hellknight?

1008
00:46:55,593 --> 00:46:56,513
There's the Hellknight faction.

1009
00:46:57,234 --> 00:46:59,455
The Hellknight faction is a child of the Heavy faction,

1010
00:46:59,955 --> 00:47:01,957
and the Heavy faction is a child of the Demon faction.

1011
00:47:03,558 --> 00:47:04,518
Plasma guy is over here.

1012
00:47:05,517 --> 00:47:07,178
He's a child of the Hellified faction,

1013
00:47:07,678 --> 00:47:09,519
who is a child of the UAC faction.

1014
00:47:10,700 --> 00:47:12,301
And then, once we have these two chains,

1015
00:47:12,761 --> 00:47:15,643
we gather all the rules specified in the edges

1016
00:47:15,703 --> 00:47:18,364
between any of the factions in either of those chains,

1017
00:47:18,785 --> 00:47:19,145
like this.

1018
00:47:20,666 --> 00:47:22,527
We can catenate all those rules into a single list,

1019
00:47:22,967 --> 00:47:24,948
and then we just evaluate that entire set

1020
00:47:25,608 --> 00:47:28,730
against the entire set of event records that we have.

1021
00:47:31,392 --> 00:47:32,392
And the results are pretty good.

1022
00:47:33,286 --> 00:47:34,086
Infighting is everywhere.

1023
00:47:34,707 --> 00:47:38,869
You can get the AI fighting each other in almost every single encounter in the game

1024
00:47:38,969 --> 00:47:42,371
by just encouraging friendly fire incidents while running from pursuing enemies.

1025
00:47:43,032 --> 00:47:45,753
And they will very quickly return to going after you instead

1026
00:47:45,933 --> 00:47:47,434
if you do something that warrants their attention,

1027
00:47:47,914 --> 00:47:49,255
including just getting too close to them.

1028
00:47:49,936 --> 00:47:53,057
And what you do to them will influence how long they go after you

1029
00:47:53,177 --> 00:47:56,019
before possibly returning to fighting their other fri-

1030
00:47:56,059 --> 00:47:58,240
well, they're not their friends anymore, but the other demons.

1031
00:47:58,885 --> 00:48:05,527
So we're basically ensuring that infighting really only influences a battle if the player is actively trying to let it happen.

1032
00:48:09,949 --> 00:48:13,970
In conclusion, we put a lot of thought and effort into bringing the player closer to this image.

1033
00:48:15,070 --> 00:48:19,192
And this is the second time I've concluded a talk with a video of me beating up on the AI.

1034
00:48:20,152 --> 00:48:24,393
In this case, because it showcases just how dominating the Doom Marine is intended to be.

1035
00:48:25,019 --> 00:48:27,762
Now, as an AI developer, it's tempting to get caught up

1036
00:48:27,982 --> 00:48:30,926
in the idea that my creation should do whatever they can

1037
00:48:30,966 --> 00:48:31,607
to kill the player.

1038
00:48:32,227 --> 00:48:34,150
But for most games, and Doom especially,

1039
00:48:34,530 --> 00:48:37,133
that just doesn't lead to a great player experience.

1040
00:48:37,454 --> 00:48:39,196
Delivering a great player experience

1041
00:48:39,276 --> 00:48:40,918
is really the true point of our job.

1042
00:48:41,358 --> 00:48:43,421
And that goes for everybody in the industry, I think.

1043
00:48:45,387 --> 00:48:47,227
I want to thank everyone at ID and ZeniMax.

1044
00:48:47,707 --> 00:48:49,888
Like Kurt said, without their talents and support,

1045
00:48:49,968 --> 00:48:50,848
none of this would be possible.

1046
00:48:51,248 --> 00:48:54,269
I want to thank everybody at GDC for putting on a great

1047
00:48:54,289 --> 00:48:54,969
conference this year.

1048
00:48:55,369 --> 00:48:57,370
And finally, I want to thank everybody in the room for

1049
00:48:57,450 --> 00:48:58,170
coming out to listen.

1050
00:48:58,190 --> 00:48:59,090
We really appreciate it.

1051
00:48:59,591 --> 00:49:02,031
If anybody has questions, we'll stick around afterwards.

1052
00:49:02,571 --> 00:49:05,572
And we'll even be in the question rooms after that.

1053
00:49:06,673 --> 00:49:08,813
Please do not forget to fill out your session feedback

1054
00:49:08,913 --> 00:49:09,633
email from GDC.

